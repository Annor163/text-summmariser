@&#MAIN-TITLE@&#
Impact of aberrations on speckle suppression efficiency on moving a DOE inside the optical system

@&#HIGHLIGHTS@&#
Model to evaluate the influence of aberrations on speckle suppression efficiency (SS) is worked out.SS is practically insensitive to aberrations in paraxial area of screen.SS at periphery changes stepwise when the aberrations change the number of diffraction orders.

@&#KEYPHRASES@&#
Speckle suppression,Laser projector,Aberrations,Diffractive optical element,Barker code,

@&#ABSTRACT@&#
The impact of aberration on the speckle suppression efficiency is investigated in a laser projector system containing a moving diffractive optical element (DOE). The results of a qualitative analysis based on the number of diffraction orders passed through the optical system are presented, along with a quantitative analysis built upon the Fresnel approximation and the thin lens model. It is shown that the speckle contrast in the paraxial area of the screen is practically insensitive to aberrations — limited to a few percent at most, due to the change in angle between diffraction orders. However, the speckle contrast in peripheral areas changes stepwise if aberrations change the number of diffraction orders that illuminate the area.

@&#INTRODUCTION@&#
Lasers have high optical efficiency and emit high-quality beams, and enable the production of low-cost, compact optical projectors and illumination systems [1]. However, an image created by a coherent source is modulated by the coherent noise (subjective speckle) [2]. Therefore speckle reduction is a pressing issue in the design of laser projectors [2–5] and coherent light systems [6,7]. The speckle contrast (SC) is used to characterize the intensity of the speckle noise and it is calculated as follows:(1)SC=σ/I¯,whereI¯is the mean light intensity andσis the standard deviation of the light intensity. Hardware noise reduction methods are based on the noise averaging [2]. In turn, speckle noise averaging is based upon the reduction of the coherence of the laser beam. There exist three possibilities to reduce the coherence of the laser source: lowering the polarization coherence (polarization averaging) [8,9], decreasing the temporal coherence (averaging over wavelengths) [2,10,11], and reducing the spatial coherence (averaging over incidence angles) [2,12–25].One of the simplest ways to reduce the spatial coherence is by using decorrelated beams, coming from different angles (decorrelation angles). This can be achieved by dividing a single laser beam with the help of a diffractive optical element and then applying different beam delays [14]. It is also possible to use sufficiently long multimode optical fibers [15,16] or light tubes [12] in this decorrelation regime.One of the most promising methods of speckle reduction is based on the use of a moving diffuser [17] or DOE [18–26], placed inside the optical system. Application of a DOE allows accurate control over the parameters of the optical system, which facilitates the development of optical systems with the required characteristics.One method is to use a 2D DOE based on pseudorandom binary sequences (Barker or M-sequences code), allowing manipulation of the angular diversity in two planes simultaneously by a simple rectilinear DOE shift [22–26]. A shift of N DOE periods is sufficient to obtain the maximum achievable speckle suppression efficiency of this method, where N is the code length. Using such an approach, large speckle suppression efficiencies have been experimentally demonstrated [26].It is well known that fully developed speckle is not sensitive to aberrations in the imaging system [2,27–29] (human eye). The topic of this research is the dependence of speckle suppression efficiency on aberrations in the optical system of a projector (not aberrations of the imaging system, and not for fully developed speckle). It is shown that the problem of speckle can be reduced to the width of the module autocorrelation function of the laser beam passed through the DOE. Therefore the problem can be reduced to the distortion of the autocorrelation function of the laser beam that is incident on screen by the aberrations in the projector. In order to obtain a large speckle suppression efficiency the autocorrelation function of light passed through the moving DOE should be narrow relative to the resolution of image system (both measured at the screen plane). The objective lens of the projector should collect the majority of the light diffracted by DOE to have large optical efficiency. Therefore, the DOE element width should be within the resolution of the projector. It is well known that the autocorrelation function width of scattered-by-screen light should be significantly smaller than the resolution of the objective lens of the imaging system (human eye) to obtain a fully developed speckle pattern (contrary to conditions to get large speckle suppression efficiency with high optical efficiency in the projector). This condition is directly used to prove the independence of fully developed speckle statistics on aberrations in the imaging system (human eye) [2]. Consequently, the dependence of speckle suppression efficiency on aberrations in the projector cannot be derived from the fully developed, aberration-independent, speckle in the imaging system.The influence of aberrations on speckle suppression for the case of a 1D scanning laser projector was analyzed in [19]. The lens in this projector was placed in the far zone of the optical modulator because of small pixel widths. In this case, aberrations only distort the phase of the light spatial frequencies. However, the situation is different for a laser projector with a 2D optical modulator, the length and width of which can be comparable to the diameter of the lens diameter. Note that in [19] it was assumed that the objective had an infinite aperture, an assumption which is not valid in our case.The influence of aberrations and defocusing of the optical system on the efficiency of speckle reduction is analyzed below for two different locations of the DOE inside the optical system. A model based on the thin lens and Fresnel approximations is applied, in which the quadratic phase factor in the object plane [30] — an important parameter in the study of coherent optical systems — is taken into account.Fig. 1shows two possible optical schemes with different DOE locations. In the optical scheme shown in Fig.1a, the optical modulator (2) is positioned in the image plane of the moving Barker code type DOE (4) of the first lens (3). DOE movement changes the phase of the diffraction orders and decreases the spatial coherence of the laser beam, which results in the speckle suppression effect. The wave front of the collimated laser beam is modulated by the DOE and then projected onto the optical modulator. The image created by the optical modulator (free of speckle) is projected on the screen (6) by the second lens (5). The lens of the optical image system (7) (human eye or camera) collects the light scattered by the rough screen and creates an image modulated by the speckle (which arises due to the scattering of light by the screen). In order to implement this scheme it is important to know how sensitive the speckle suppression efficiency is to aberrations in the projector optical system and to a shift of the optical modulator relative to the image plane of the DOE. This analysis was performed only for the aberrations of the first lens (3), but it can easily be generalized to the entire optical system of the laser projector.In the second scheme (Fig.1b), the moving DOE (4) is placed just before the optical modulator (2). In this case, the distance between the DOE and optical modulator can vary within a large range. The image created by the optical modulator is projected on the screen (6) by the lens (3). Then, the lens of the optical image system (7) collects the scattered light and creates an image modulated by the speckle. Prior to implementation of this scheme, more research is necessary to determine how the distance between the DOE and an optical modulator influences the efficiency of speckle suppression.Since we are only interested in the SC, we can assume that all pixels of the optical modulator are switched on and do not modulate the beam intensity. We also assumed that without moving the DOE, the viewer would see a fully developed speckle pattern on the screen (this assumption is made to extract information on the independent effect of DOE movement on speckle suppression).The dependence of SC on the aberrations of the illumination part of the projector (with the DOE placed inside the illumination part) is investigated below. Similar results can be obtained for the objective lens of the projector; therefore, the results obtained below are valid for the whole optical system of the projector. The results obtained are also valid when the DOE is situated in any plane conjugated to the screen.The SC in the image of the screen was calculated by [20] (for 2D geometry):(2)SC=2∫-∞∞|A0(Du)/A0(0)|2Q(u)duwhereQ(u)=∫-∞∞sinc2(2πv)sinc2(2π(v+u))dv=[1-sinc2(4πu)]/8π2u2;Dis the spatial resolution of the eye at the screen,D=λ/NA2in;NA2inis the input numerical aperture of the human eye; A(x) is the autocorrelation function of the light field on the screen which was obtained by taking an average over the time resolution of the human eye t0(3)A(x-xs)=〈E(x,t)E∗(xs,t)〉=∫t=0t0E(x,t)E∗(xs,t)dt,u=(x-xs)/D, andx,xsare two points on plane of the screen. From Eq. (2), it follows that the analysis of the effect of aberrations on the SC can be reduced to the analysis of their influence on the module of the autocorrelation function (MAF) on the screen. A similar equation can be derived for a 3D geometry [22]. For simplicity, we assumed that lens 9 was aberration free and that only lens 3 (see Fig.1(b)) in front of the optical modulator had aberrations. In this case, the problem was reduced to the MAF distortion by aberrations of lens 3 at the optical modulator plane.The DOE, based on the Barker code or M-sequence [12,19–26], were used in our analysis (let N=15, see Fig. 2). It was shown [22,23] that under certain conditions, the autocorrelation function of a collimated laser beam that passes through the DOE with a 2D Barker code can be approximated by the product of two narrow 1D autocorrelation functions, where each depends on single coordinate. These two conditions are: (1) During the eye resolution time, the DOE shifts on one period T0 (see Fig. 2) and on several periods,S=MNT0in the orthogonal direction (where N is the code length, M is any positive integer). (2) The numerical aperture of the lens is large enough to collect practically all the light diffracted by the DOE (the divergence angle of the diffracted beam should be less than the input numerical aperture of the illumination system λ/T<NA).These two 1D autocorrelation functions are the 1D Barker code DOE autocorrelation functions [23] (see Fig. 3). The 2D point spread function of a lens with a rectangular aperture is the product of two 1D point spread functions, and for a lens with an aperture that is large enough to catch practically all the spatial frequencies of light diffracted by the DOE, circular and rectangular lenses have the same properties. Under this condition and with high accuracy, we can reduce the 3D problem to a 2D problem; therefore, we can simplify the analysis of a 3D structure to the analysis of a 2D structure with a 1D Barker code DOE. This approach is applied below to avoid the cumbersome calculations needed for 3D analysis.An optical scheme in which the moving DOE is placed at a distance h in front of the optical modulator is shown in Fig.1(b). Light diffracted by the DOE illuminates the optical modulator. It is assumed that the DOE aperture is larger than the modulator aperture and therefore it is illuminated by all the spatial frequencies of the diffracted laser beam. It is also assumed that the DOE shifts for one DOE period T0 (see Fig. 2) during the resolution time of the human eye, t0. From Eq. (2), it follows that SC suppression depends only on the module of the autocorrelation function of the laser beam. Therefore, the problem is simplified to the problem of the MAF dependence on the distance between the DOE and optical modulator.Let the DOE be illuminated by a homogeneous collimated laser beam. The spatial spectrum of the field at the back side of the DOE can then be written as:(4)FE(α,t,z=0)=∫-∞∞E0H(x-Vt)exp(iαx)dx=E0exp(iαVt)∫-∞∞H(u)exp(-iαu)du.whereE0is the amplitude of the beam before DOE, H(x) is the DOE modulation function, V is the DOE velocity, andαis the spatial frequency. Then, using the free space propagator, the spatial spectrum of the field in the plane of the optical modulator can be written as(5)FE(α,h,t)=FE(α,z=0,t)exp(-iγh)=E0exp(-iγh)exp(iαVt)∫-∞∞H(u)exp(-iαu)du,whereγ=k2-α2, andk=2π/λ. By using an inverse Fourier transformation, the field in the plane of the optical modulator can be written as(6)E(x,z,t)=E0∫-∞∞exp(-iγz)exp(iαvt)exp(iαx)dα∫-∞∞H(u)exp(-iαu)du.Because the DOE is illuminated uniformly, and its size is larger than that of the optical modulator, it is correct to consider the DOE a periodic structure (see Fig. 1(b)). Therefore, we can use the Fourier series (with argumentx-Vt):(7)E(x,0,t)=∑n=-∞∞FH(2πn/T0)exp(-i2πn(x-vt)/T0),whereFH(2πn/T0)is the Fourier coefficient ofH(x). The autocorrelation function in the plane of the DOE (after the passage of light through the DOE) can be written as(8)A(0,x,x1)=∫0t0E(x,0,t)E∗(x1,0,t)dt=|E0|2∫0t0H(x-vt)∗H(x1-vt)dvt=|E0|2∑n=-∞∞∑m=-∞∞T0sinc(π(n-m))FH(2πn/T0)exp(-i2πnx/T0)FH∗(2πm/T0)exp(i2πmx1/T0)=|E0|2∑n=-∞∞∑m=-∞∞T0δnmFH(2πn/T0)exp(-i2πnx/T0)FH∗(2πm/T0)exp(i2πmx1/T0)=|E0|2∑n=-∞∞T0|FH(2πn/T0)|2exp(i2πn(x1-x)/T0)=A(x-x1)where the formulasinc(π(n-m))=δnmis taken into account. Similarly, the autocorrelation function at the plane of the DOE can be written as:(9)A(z=h,x,x1)=∫0TE(x,h,t)E∗(x1,h,t)dt=|E0|2∑n=-∞∞∑m=-∞∞T0sinc(π(n-m))exp(i(γm-γn)h)FH(2πn/T0)exp(-i2πnx/T0)FH∗(2πm/T0)exp(i2πmx1/T0)=|E0|2∑n=-∞∞T|FH(2πn/T0)|2exp(i2πn(x1-x)/T0)=A(0,x-x1),whereγn=(k2-(2π/T0)2)0.5. Hence, for correct DOE movement (full averaging over the DOE period), the autocorrelation function of the transmitted beam does not depend on the distance between the DOE and optical modulator. However, it is not clear how sensitive this scheme is to inaccuracies in DOE movement.For inaccurate DOE movement, the autocorrelation function would clearly depend on the distance between the DOE and optical modulator due to the Talbot effect. However, we speculate that when the image of the DOE period on the screen is smaller than the resolution of the eye, the Talbot effect in the eye disappears because of averaging over one DOE period. Therefore, the SC should not depend on the distance between the DOE and optical modulator.In Eq. (9) the autocorrelation function is presented as a Fourier series with real positive coefficients and hence its peak width, w, is inversely proportional to the width of the spatial spectrumΔk⊥of laser illuminationw∼2π/Δk⊥. For a Fourier series, the angular spectrum is determined by the smallestnminand largestnmaxcoefficient in the Fourier series and can be calculated as follows:Δk⊥≈2π(nmax-nmin)/T0≈2π/T.Fig.1(a) shows an optical scheme in which the DOE image is projected onto the optical modulator. It is assumed that the image plane of the DOE does not exactly coincide with the plane of the optical modulator; i.e., the image plane is located at a distance Z2 from the lens (3) while the optical modulator (4) is additionally shifted a distance h (defocusing).Fig. 4shows the location of the diffraction orders in the optical system. We assume that during the time resolution of the human eye the DOE shifts on one period, which leads to decorrelation of all diffracted orders. A grey area in Fig. 4 indicates a zone illuminated by all diffraction orders transmitted through the optical system. The width of the spatial spectrum of the light in the grey zone can be estimated as follows:(10)kN1·Δ/(Z2+h-F)=kN1·Δ·F/((Z2+h-F)F)=kN1·ΔZ1/(F·(Z2+h))The width of the autocorrelation function of the light is inversely proportional to the angular spectrum of the light, and the width depends only on the distance to the screen and not on the distance h to the image plane.Outside of the grey area at the beam periphery and in the region of z<Zc, the screen is illuminated by some but not all of the diffraction orders. For the region of small magnification (z<Zc) the number of illuminated diffraction orders quickly decreases with a decrease in the distance to the lens. Due to the decrease in the number of diffraction orders, the SC will increase as the light intensity decreases.Small aberrations only change the phase of the wave-front of different diffraction orders and, therefore, do not change the number and angles of diffraction orders that illuminate a screen and hence the SC. However large aberrations rotate the direction of beam propagation as beams pass through the lens (rotation is shown in Fig. 4 by double arrows on diffraction order rays). The rotation angle is larger for peripheral rays (for rays of higher diffraction orders). Depending on the sign of the aberration coefficient, the direction of rotation can be towards or away from the optical axis. The rotation of the diffraction orders results in an inhomogeneous change of angles between them (only defocusing results in a homogeneous change of angles between neighboring diffraction orders). This effect has a noticeable effect on the speckle suppression efficiency only when the distances between the diffractive orders decrease below the decorrelation angle. Therefore in the paraxial area of the screen, only the large aberrations will have some effect on the speckle suppression efficiency. However, at the periphery of the optical beam, the number of illuminated diffraction orders can be changed by aberrations due to their rotation relative to the optical axis. Therefore, large aberrations in that area should cause stepwise increases in SC with a simultaneous decrease in light intensity. The stepwise change would be more noticeable for small values of N.It is assumed that the Barker code DOE is moving along the X axis with a constant velocity V and modulates the beam wavefront by a periodic 1D Barker code sequence (see Fig. 1(a)). In the Fresnel approximation the field distribution at the plane shifted a distance of h from the image plane (optical modulator plane) can be written as:(11)E(x,t)=∫-∞∞∫-∞∞E0(x″)H(x″-Vt)exp[iΦ(x′)]·expik2x′2F-(x″-x′)2Z1-(x′-x)2Z2+hdx″dx′The sum in the second exponent may be represented as follows:(12)x′2/F-(x″-x′)2/Z1-(x′-x)2/(Z2+h)=2x′x″-x″2Z1-(x2-2xx′)/Z2+h(x′-x)2/Z2(Z2+h);If we take into account the well-known relationship for an optically conjugated projection system:(1/Z1)+(1/Z2)=1/F, Eq. (11) can be written as:(13)E(x,t)=E0K1∫∫H(x″-Vt)exp[i{Φ(x′)}]expik2-x″2-2x′x″Z1-x2-2xx′Z2+h(x′-x)2Z2(Z2+h)dx″dx′,where K1 is a constant,H(xs″-Vt)is a periodic Barker code modulation function (or M sequence), V – the DOE speed, andΦ(x′)is the wavefront phase distortion by aberrations, x″, x′ and x are coordinates of the object, pupil and optical modulator planes, respectively (see Fig.1a). Since the SC depends only on the modulus of the normalized autocorrelation function, we did not calculate exactly the constant complex coefficients K1, K2, … at the autocorrelation function.The last term in Eq. (12) represents the defocusing effect. The second exponent in Eq. (11) corresponds to lens 3 with defocusing. The autocorrelation function of the field at the optical modulator plane can be written as:(14)A(x,xS)=K1E0E0⨌exp[i{Φ(x′)-Φ(xS′)}]A0(x″-xS″)×expi0.5kΦ1(xS″,x″,xS′,x′)+Φ2xS,x,xS′,x′+Φ3(xS,x,xS′,x′)dx″dx′dxS″dxS′.wherexandxsare two points at the optical modulator plane and the functionsΦ1andΦ2are given by:(15)Φ1(xs″,x″,xs′,x′)=(xs″2-x″2-2xs′xs″+2x″x′)/Z1,Φ2(x,xs,x′,xs′)=xs2-x2Z2+h-2xs′xs-2xx′Z2+h+h(x′2-xs′2)Z2(Z2+h)It can be strictly proved that aberrations have not any influence on SC when the decrease in the spatial resolution of the lens (Daber) due to aberrations is small and allows linear approximation for quadrature phase term (Daber≪λZ1,where Daber) to be used. The expression forΦ1(x′,xs′,x″,xs″)can be transformed to:(16)Φ1(x′,xs′,x″,xs″)=-u″v″/2Z1+v″(x′-xs′)/2Z1+(x′+xs′)(x′-xs′)/2Z1whereu″=x″-xs″;v″=x″+xs″-x′-xs′. By using Eq. (16), Eq. (14) can be rewritten as:(17)A(x,xs)=K2∫-∞∞∫-∞∞∫-∞∞∫-∞∞A0(u″)exp[iΦ(x′)]exp[-iΦ(xs′)]exp[-iku″v″/2Z1]exp[ikv″(x′-xs′)/2Z1]×expik((x′+xs′)(x′-xs′)/2Z1)exp[ik0.5Φ2(x,xs,x′,xs′)]dx′dxs′dv″du″The integrations over u and v in Eq. (17) are direct and inverse Fourier-transform respectively. After integrating,A(x,xs)can be transformed into:(18)A(x,xs)=K2expik2xs2-x2Z2+h∫-∞∞∫-∞∞A0(x′-xs′)exp[i(Φ(x′)-Φ(xs′))]expik2(x′+xs′)(x′-xs′)1Z1+hZ2(Z2+h)expikxx′-xs′xsZ2+hdx′dxs′Changing the variables,u′=x′-xs′,v′=x′+xs′, Eq. (18) is simplified to:(19)A(x,xs)=K3expik2xs2-x2Z2+h∫-∞∞expik2v′(x-xs)Z2+hdv′∫-∞∞A0(u′)expiΦu′+v′2-Φv′-u′2expik2u′v′1Z1+hZ2(Z2+h)+(x+xs)Z2+hdu′where the relation2xx′-2xsxs′=u′(x+xs)+v′(x-xs)is used. For optical systems without aberrations the MAF can be written as follows:(20)|A(x,xs)|=K4∫-∞∞∫-∞∞A0(u′)expik2u′v′-Z11+1MhZ2+hx+xsZ2+hZ11+1MhZ2+hexpik(x-xs)2(Z2+h)v′-Z11+1MhZ2+hx+xsZ2+hdu′dv′=K4A0Z1Z21+1MhZ2+h(x-xs),whereM=Z2/Z1is the magnification of the optical system.Simulation of a lens with aberration is possible only when its aperture is finite. In this case, Eq. (20) transforms to (see Fig. 5):(21)A(x,xs)=K4∫-2a0dv′exp-ik2Z2v′(x-xs)∫-v1-2a2a+v1As(u′,x+xs)expi(Φ((v′+u′)/2)-Φ((v′-u1)′/2))expik2u′v′Z1+x+xsZ2du′+∫02adv′exp-ik2Z2v′(x-xs)∫v1-2a2a-v1As(u′,x+xs)expi(Φ((v′+u′)/2)-Φ((v′-u′)/2))expik2u′v′Z1+x+xsZ2du′,where2ais the aperture width.Fig. 6shows the dependence of SC on the spherical aberration (Φ1=B402π(x/a)4) for different ratios of eye resolution (D) to DOE period (T0) for the paraxial area of screen (x+xs=1.2mm;(x+xs)/2a≪1). The simulation results show that even large aberrations, with wavefront distortions more than 100λ, do not significantly change the speckle suppression efficiency.Fig. 7shows the dependence of SC on spherical and coma aberrations (Φ1=B312π(x/a)3) for different D/T0 at the peripheral area of the optical system. The speckle dependence on aberration is similar for the DOE with different code length N (see Figs. 7, 8 and 9). The increase of positive spherical aberration results in small increases in speckle suppression. For small negative spherical aberrations, the SC decreases with increasing aberration values. Subsequent increases in negative spherical aberration result in fast stepwise increases in SC followed by oscillation. However the height of the stepwise change decreases with an increase of N as one can see from comparison of Figs. 7, 8 and 9. The dependence of SC on coma aberration is similar to that of spherical aberration, however since coma aberration is even aberration, the effect depends on the sign of the shift from the optical axis, as one can see from a comparison of the curves in Figs. 7 and 8. Changing the number of illuminated diffraction orders should result in a stepwise change in light intensity and intensity oscillation at that area. Fig. 10shows the light intensity distribution on the screen (averaging over one DOE period) for the same optical parameters as in Fig. 7. The intensity distribution are shown for aberration free lens (a), for the case B31=−25 (b) and B31=25 (c). One can see that the light intensity at point x=−2.1 (x+xs=−4.2mm) is different for the various values of coma aberration. This change is stepwise due to changes in the number of illumination diffraction orders with fringes at an area close to the intensity step. One can also see in Fig. 7 that there is an abrupt change in SC at 0<B31<10. This change is also well explained by changing the number of illumination diffraction orders (see Fig. 7).

@&#CONCLUSIONS@&#
It was shown that speckle suppression based on a moving DOE placed in conjugation to the optical modulator plane has a small sensitivity to aberrations (speckle contrast changes at most several percent due to changes in the angles between diffraction orders) until the aberrations do not change the number of diffraction orders that illuminate the screen. The speckle contrast at the periphery of the light spot has stepwise behavior if the aberration changes the number of diffraction orders that illuminate the area. Simultaneously, the illumination intensity changes abruptly with small fringes around the intensity step due to changes in the number of illuminated diffraction orders.In the optical scheme with the DOE located in front of the optical modulator, the speckle contrast is not sensitive to the distance between the optical modulator and the DOE if the optical modulator is illuminated by the all diffraction orders.