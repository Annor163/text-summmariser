@&#MAIN-TITLE@&#
A novel approach for quantification of time–intensity curves in a DCE-MRI image series with an application to prostate cancer

@&#HIGHLIGHTS@&#
The method for quantification of DCE time–intensity curve shape patterns is proposed.To the best of author's knowledge this is the first method to the considered problem which uses the supervised classification.The proposed method can be used to improve specificity of MRI in characterizing cancerous lesions.

@&#KEYPHRASES@&#
DCE-MRI,Time–intensity curve,Curve shape pattern,Prostate cancer,Bayes classifier,Heuristic rules,

@&#ABSTRACT@&#
This paper considers the problem of an automatic quantification of DCE-MRI curve shape patterns. In particular, the semi-quantitative approach which classifies DCE time–intensity curves into clusters representing the tree main shape patterns is proposed. The approach combines heuristic rules with the naive Bayes classifier. In particular, the descriptive parameters are firstly derived from pixel-by-pixel analysis of the DCE time intensity curves and then used to recognise the curves which without a doubt represent the three main shape patterns. These curves are next used to train the naive Bayes classifier intended to classify the remaining curves within the dataset. Results of applying the proposed approach to the DCE-MRI scans of patients with prostate cancer are presented and discussed. Additionally, the overall performance of the approach is estimated through the comparison with the ground truth results provided by the expert.

@&#INTRODUCTION@&#
Dynamic contrast-enhanced magnetic resonance imaging (DCE-MRI) is an extension of magnetic resonance technique, intended to measure changes of contrast agent concentration within tissues over the time. In particular, it consists of a sequence of MRI acquisitions performed before, during and after the injection of the contrast bolus. The change in image intensity in each time sequence represents the change in contrast concentration. Since the concentration changes exhibit different patterns depending on physiological tissue characteristic, recently DCE-MRI have been more and more frequently considered by the oncologists and radiologists as a promising method for cancer detection, diagnosis and staging. By the analysis of DCE curve shape patterns it is possible to non-invasively distinguish healthy tissue from the cancerous one, as well as to discriminate between malignant and benign cancerous changes [1,2].So far, DCE-MRI has been widely used for diagnosis of breast lesions [1–3]. However, recently this technique has also been applied to improve specificity of MRI in characterizing cancerous lesions of different organs, e.g. liver [4], knee joints [5], prostate [6] or rectum [7]. Therefore, the development of reliable methods for DCE time–intensity curves (TIC) assessment is one of the key issues in DCE image analysis.The reported methods of DCE curve analysis can be qualified into three general categories, namely: qualitative methods, semi-quantitative methods and quantitative methods [8].The qualitative methods are the most common and are simply based on visual inspection. In such a case, the analysis and quantification of the DCE curve pattern is performed visually, based the time–intensity curves (TIC) plotted using the dedicated computer aided diagnosis (CAD) software. This kind of the analysis is usually limited to the region of interest (ROI) indicated manually in a suspicious region. Additionally, the TICs may be obtained for single pixels or averaged over the ROI. The main drawback of this method of analysis is the lack of quantitative parameters describing the underlying tissue characteristics. As a result, the intra-observer variability in the assessment of curve pattern can be observed, especially in the case of patterns demonstrating atypical configurations. Secondly, averaging of the signal over the region of interest may ignore or diminish the influence of the small foci of the disease.The recent research on DCE-MRI signal curves include mainly the development of semi-quantitative and quantitative methods, which allow to overcome some drawbacks of the qualitative methods [9].The quantitative approaches to DCE-MRI curve analysis aim at extracting meaningful quantitative parameters that directly reflect blood flow and physiological characteristics of the underlying tissues. This is performed using pharmacokinetic modelling techniques, i.e. by fitting mathematical models describing the changes of the contrast agent into DCE curves [10,11]. Several pharmacokinetic models exist, however the most commonly used is the model proposed by Tofts [12,11], which considers the blood plasma and the extracellular extra-vascular space as two compartments. Models proposed by Brix [13] and Larsson [14] are also popular.Although the quantitative approaches to DCE signal analysis are the closest to the underlying tissue physiology, they exhibit a number of drawbacks. First of all, these methods are computationally demanding. Some efforts for reducing their computational complexity have already been made [15], however their usage in the case of high resolution volumetric images is still limited. Additionally, modelling is often a source of uncertainty, since different models can provide significantly different values of the same physiological parameters. What is more, these methods do not make use of model assumptions or non-linear fitting. As a result, for some cases the fitting algorithm may appear unstable. Additionally, to perform pharmacokinetic modelling, the knowledge about the arterial input function (AIF) is usually required but not always available or ambiguous. Since AIF varies depending on a region, assuming its uniformity is another source of errors. There are some models reported in the literature which do not require an AIF [16], these however are in minority.The last group i.e. the semi-quantitative approaches are an intermediate solution between the quantitative and qualitative methods. They do not take advantage from the pharmacokinetic analysis, but try to relate the curve shape pattern to physiological findings. These methods are based on descriptive parameters which reproduce main features of an expected curve directly derived from DCE TICs. Firstly, the pixel-by-pixel analysis of the curves is performed in order to extract parameters which include signal wash-in slope, signal wash-out slope, time to peak, maximal signal enhancement or initial area under the curve [17]. Then using the heuristic rules with respect to these parameters the TICs are qualified into the main shape patterns. Most of the existing approaches qualify the curves into the three groups representing shape patterns, however some authors have proposed to distinguish additional types [18]. Since semi-quantitative methods for curve analysis do not require curve fitting, they are usually more robust, than methods based on the pharmacokinetic modelling. However, since they require pixel-by-pixel curve processing, they may be sensitive to intensity variations (noise), hardware settings, contrast parameters, etc. Additionally, heuristic rules are not able to handle curves which demonstrate atypical shape patterns.A few approaches based on the unsupervised clustering have also been proposed [19]. These are used directly on DCE-MRI signal curves either by considering them as vectors of intensities or as vectors of features derived from TICs. Supervised clustering methods require the correct number of clusters to be given in advance. This is a serious limitation, since it is a priori unknown how many clusters should be distinguished.To the best of the author's knowledge, supervised clustering approaches to DCE-MRI curve pattern recognition have not been reported, since they require the expert knowledge in the classifier training phase. Especially, in the considered problem the expert should manually classify the DCE TICs within the training set into the three categories. This is however difficult and time consuming. Additionally, the results may differ depending on the expert.The approach introduced in this paper is a step towards introducing supervised clustering methods into the quantitative analysis and automatic recognition of DCE time–intensity curve shape patterns. It combines heuristic models incorporated into a training phase with a naive Bayes classifier used for TIC shape pattern recognition. The approach was developed with the aim of application in the prostate cancer assessment and thus its performance is presented and assessed using the DCE-MRI image series of patients with prostate cancer provided by the Initiative for Collaborative Computer Vision Benchmarking (I2CVB) [20]. However, the method is general and its application is not limited only to the prostate cancer.The remainder of this paper is organised as follows. First, in Section 2 the three main DCE time–intensity curve shape patterns are briefly characterised. This is followed in Section 3 by the description of the DCE-MRI dataset used in this study. The proposed approach is described in details in Section 4 and followed by the presentation, assessment and discussion of the results provided in Section 5. Finally, Section 6 concludes the paper.The shape of the DCE time intensity curve typically falls into one of the three general categories (types) [21].The first curve shape pattern (Type 1) presents slow progressive contrast enhancement (intensity increase) during the acquisition time. Usually, the signal does not reach intensity maximum during the image acquisition period which is a suggestive of a healthy tissue.Type 2 is assigned to curves which present stable initial contrast uptake (increase of image intensity) followed by a plateau i.e. the phase of a relatively constant signal intensity. This type of curve correspond with an intermediate probability for malignancy.Finally, Type 3 curves exhibit fast initial contrast (signal intensity) enhancement followed by a quick gradual wash out after the peak signal intensity is achieved during the initial phase. The third type of DCE curve shape pattern is indicative of malignancy.The representative curves for each of the three categories mentioned above are sketched in Fig. 4.The research described in this paper was performed using the benchmark multi-parametric MRI (mp-MRI) images of prostate provided by the Initiative for Collaborative Computer Vision Benchmarking (I2CVB) [20]. In particular, the dataset dijon acquired by a 3.0Tesla Siemens Magnetom Trio TIM scanner was considered. The dataset is composed of a total of 19 patients including 17 subjects with diagnosed prostate cancer (CaP) and two healthy ones. In all the considered patients the diagnosis was proven by a guided-biopsy performed aside of the MRI examinations. Each MRI scan included 5 different modalities (T2-weighted MRI, dynamic contrast enhanced MRI, diffusion weighted imaging MRI, magnetic resonance spectroscopic imaging and apparent diffusion coefficient maps) of which dynamic contrast enhanced (DCE) MRI time series were used. These were obtained after application of gadolinium contrast in the amount of 15ml. Each DCE-MRI time series consisted of 40 acquisitions (frames) of the resolution 200×256×16 voxels each (16 slices of spatial resolution 200×256 pixels), pixel spacing of 1.09×1.09mm2 and slice thickness equal 3.5mm. The duration of a resulting dilution curve ranged from 265 to 318s (with the average duration equal to 259s and median duration equal to 265s). Additionally, for each patient the ground truth segmentations of the cancerous region were provided for each modality, including the considered DCE-MRI sequences. According to the description of the dataset, the ground truths were prepared manually by an experienced radiologist (Fig. 1).A DCE-MRI time series is a 4D imageJ(I,t)⊂R4, where the three first dimensions correspond with a volumetric data composed fromN=X×Y×Zvoxels, while the fourth dimension is time. Each voxelx=[x,y,z]within a dataset is assigned the time intensity curveI(x,t)=[I(x,t1),I(x,t2),…,I(x,tn)]which demonstrates the signal enhancing pattern over the time for this voxel, measured in n subsequent instants of time (whereI(x,ti)is voxel intensity at ith instant of time). The number n of instants equals to the number of acquisitions within a DCE-MRI time series. This idea is sketched in Fig. 2.The main idea behind the introduced approach is to recognise among the DCE time–intensity curvesI(x,t)∈Jthe curves which without a doubt represent the three main TIC shape patterns, and then use these curves to train the nave Bayes classifier intended to classify the remaining curves within the dataset J.Therefore, the proposed approach comprises of five main stages: preprocessing, feature extraction, recognition of the representative DCE time–intensity curves, classifier training and classification of the curves within the dataset. These are described in details in the following subsections.Prior to feature extraction DCE time–intensity curvesI(x,t)are preprocessed in order to increase reliability and noise resistance of the proposed approach. In particular, each curve is filtered in a time domain by one dimensional median filter. However, since the median filter removes signal peaks it also deforms shape of curves of the third type, which after peak removal become similar to curves of the second type. Therefore, to avoid this negative effect for these curves which obtain signal peak in less than 60s the peak position and the corresponding signal value are retained in the enhanced signal. Results of preprocessing applied to sample curves of each type are shown in Fig. 3. In particular, original curves are shown in red while curves after preprocessing are shown in blue. The consecutive sub-figures from left to right present curves representing the first, the second and the third pattern of contrast enhancement.It was also considered to perform registration of volumetric data composing DCE time-series in order to align them spatially and remove some movement displacements prior to curves extraction and analysis. However, this step has not been applied, since the observed displacements were negligible but the corresponding computational workload required to perform their registration was incomparably large.In the features extraction phase curve heuristic parameters are derived from DCE time–intensity curves. In particular, signal magnitude ME, signal maximal enhancement ME, time to peak TTP, wash-in slope WiS, and wash-out slope WoS are utilised. These parameters are next included into the corresponding feature vectorFwhich is assigned to each curveI. A vectorF={fi}comprises of five features, wheref1=SM,f2=ME,f3=TTP,f4=WiS,f5=WoS. There are also three specific instants of time in each TIC namely: the time when signal wash-in begins t0, the time when signal intensity reaches maximum tmaxand the last observed moment in time tend. These are used to determine curve parameters. Both the parameters and the characteristic instants of time are sketched in Fig. 4.Signal maximum is defined as the maximal intensity value associated with a curveI(x,t)as given in the following equation:(1)SM=max(I(x,t))Signal maximum SM is considered LOW when it is lower than 20% of maximal enhancement observed within the input datasetJ(I,t).The maximal enhancement ME is the signal relative enhancement determined with respect to the signal baseline SB as in the following equation:(2)ME=SM−SBSBwhere the signal baseline SB is defined as the median of signal intensities before the time t0 at which the wash-in slope begins i.e. the signal intensity starts to increase (see Fig. 4 and Eq. (3)):(3)SB=mediant≤t0{I(x,t)}Maximal enhancement ME can be qualified into three categories namely: LOW, MEDIUM and HIGH. These are obtained by dividing the range of maximal enhancements obtained for the input datasetJ(x,t)into three equal sub-ranges. In particular, first the histogram of maximal enhancements is build. Since the number of unique values of maximal enhancement is not easy to determine, histogram considers 1000 bins of equally distributed signal intensity ranges. Next, in order to diminish the influence of noise, bins which represent less than 5 appearances are excluded from consideration. The remaining range of enhancements is divided into three equal ranges: LOW, MEDIUM and HIGH as shown in Fig. 5a.Time to peak TTP is defined as a difference between time tmaxat which signal intensity reaches maximum and the time t0 at which the signal begins to grow (see the following equation):(4)TTP=tmax−t0Time to peak is considered LOW when it is below 60s. MEDIUM value of TTP means that it is in the first halve of the interval between tmaxand tend. If TTP is in the second halve of this interval, it is considered LONG. This idea is sketched in Fig. 5d.The wash-in slope WiS is the angle between the increasing signal slope and the time axis. The angle is determined by fitting a linear functionI=at+binto these signal intensity values, for whicht∈[t0,tmax]. In particular, it is defined by the following equation:(5)WiS=arctan(a)The wash-out slope WoS is determined in a similar manner, except that the linear function is fitted into these signal intensity values, for whicht∈[tmax,tend].The wash-in slope is LOW whenWiS<30°, HIGH when it is higher than 60°. Values between 30° and 60° correspond with MEDIUM wash-in slope (see Fig. 5b). In the case of wash-out slope, the angle is not important. However, it is important to determine the slope direction. The slope is considered CONSTANT when WoS is between −5° and 5°. Angles below −5° correspond with DESCENDING slope, while angles above 5° denote that the slope is ASCENDING. This idea is sketched Fig. 5c.Having the parameters and their attributes described above, the representative curve shape patterns are extracted from the datasetJ(I,t), according to heuristic rules defined in Table 1. A class label T=i,i∈{1,2,3}is assigned to each recognised curve pattern. A label represents the type of the DCE contrast enhancement pattern.All the curves, which do not exhibit enhancement i.e. the corresponding maximal enhancement is LOW and signal maximum is LOW are automatically qualified to class 1 (T=1), which means that these curves represent the shape pattern corresponding with Type 1. Additionally, curves with signal maximum higher than LOW but characterised by MEDIUM maximal enhancement, LONG time to peak, LOW wash-in slope and ASCENDING wash-out slope are also recognised as Type 1.Curves qualified to class 2 (T=2, Type 2) exhibit MEDIUM or HIGH maximal enhancement, MEDIUM or SHORT time to peak, MEDIUM wash-in slope and CONSTANT wash-out slope which correspond with the plateau phase.The set of parameters which represent the third curve shape pattern (T=3, Type 3) is HIGH maximal enhancement and wash-in slope, SHORT time to peak and DESCENDING wash-out slope.Sample DCE time–intensity curves included into the training set using the procedure described above are presented in Fig. 6. In particular from each of the three classes (representing the three main curve shape patterns) 75 curves were selected randomly and plotted on a common graph. The type of the shape pattern is indicated above each graph.The distribution of curves representing the considered shape patterns within a training dataset obtained for a sample patient is shown in Fig. 7. Type 0 corresponds with curves which has not been classified to any type and need to be assigned a type in the next steps of the algorithm. Since the curves representing Types 2 and 3 are in the minority, a logarithmic scale is used.The feature vectors F and the corresponding class labels T obtained in this step are next used as a training set for a naive Bayes classifier.In the training phase, the naive Bayes classifier is fitted into the training data describing the three curve shape patterns. The classifier was used since it only requires a small amount of training data to estimate the parameters necessary for classification. Additionally, in spite over-simplified assumptions, in many complex problems the classifier often performs better than much more sophisticated solutions.First, the parameters of a probability distributionP(F|T)that the curve from class T is described by a vector of featuresFis estimated, assuming that the features Fidescribing each curve shape pattern are conditionally independent given the class Tj. It is also assumed that each feature fkexhibits the normal distribution within each class Tj. Therefore, the probability density of a feature fkwithin each class Tjis modelled as a Gaussian function with respect to the training data and according to the following equation:(6)p(fk|Tj)=1σkj2πexp(−(f−μkj)22σkj2)where μkjand σkjare the mean and the standard deviation of a feature fkwithin a class Tj. For each feature fka separate normal distribution is estimated for each class Tj.It was tested that the assumption of the feature Gaussianity works reasonably well the case of most regarded features. This is shown in Fig. 8which presents distributions of maximal enhancement (ME), signal maximum (SM), time to peak (TTP), wash in slope in degrees (WiS) and wash out slope in degrees (WiS) obtained for a sample DCE-MRI dataset. From the figure it can be seen that (despite of TTP) the individual distributions can be reasonably well modelled either by the Gaussian function or by a mixture of Gaussians which number correspond to the number of classes.Next, the a priori probability of each class Tjis estimated with respect to the fraction of curves representing each curve shape pattern within a training set (see the following equation):(7)p(Tj)=njntwhere ntis the number of samples within a training set, njis the number of samples qualified to jth class and∑nj=nt.Finally, the a posteriori probabilityP(Ti|F)that a curve described by a feature vectorFbelongs to class Tiis modelled according to Bayes rule using the following equation:(8)p(Tj|F)=∝p(F|Tj)P(Tj)where(9)p(F|Tj)=∏k=1np(fk|Tj)and n=5 is the number of features describing each curve.The classification step is performed with accordance to the maximum a posteriori decision rule, which means that the naive Bayes classifier assigns each unclassified curve to the most probable class. Therefore, for each unclassified curve the posterior probability of that curve belonging to each class is computed. Then, the resulting class labelT^is assigned according to the following formula:(10)T^=argmaxj∈{1,2,3}p(Tj)p(F|Tj)

@&#CONCLUSIONS@&#
The method proposed in this paper is a novel solution to the DCE time–intensity curve shape pattern recognition. The novelty lies mainly in the usage of the supervised Bayes classification for qualification of DCE curve types. To the best of author's knowledge this kind of approach has not been used so far in the considered problem.The overall estimated accuracy of the proposed method is relatively high and was assessed to be at the level of 0.9. This is a satisfying result, especially in the case, when the ground truth results used for comparison were subjective (biased on the operator's individual perception). Since the ground truth results are subjective, the overall accuracy of the proposed approach may be even better. However, it is obvious that the performance of the method still can be improved. Therefore, the future works will be concerned on further improvement of the curve shape pattern recognition rate. In particular, the effort will be made to better differentiate between the second and the third DCE curve shape pattern.Another concern which requires attention is providing reliable ground truth results for trustworthy assessment of the method. Recently, lack of the reference is the main limitation of the described study and thus more attention will be paid to this issue in the feature works.At the end it is worth mentioning that the proposed approach for DCE shape pattern qualification was developed with a view to usage in assessment of the prostate cancer. However, the method is universal and does not require any a priori knowledge about the cancer type. As a result the method can be successfully applied in various applications and computer aided diagnosis systems where DCE curve shape types need to be recognised.None declared.Supplementary data associated with this article can be found in the online version at doi:10.1016/j.compbiomed.2016.04.010.Application 1