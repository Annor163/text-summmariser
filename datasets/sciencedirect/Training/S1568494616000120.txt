@&#MAIN-TITLE@&#
Mortality prediction of septic shock patients using probabilistic fuzzy systems

@&#HIGHLIGHTS@&#
Probabilistic fuzzy systems (PFS) are used to predict mortality of septic shock patients.PFS models are compared with Takagi-Sugeno fuzzy models and logistic regression models.The methods are tested using ICU patients with abdominal septic shock.PFS models increase the transparency of the learned system using fuzzy rules.By providing estimates for the mortality risk, PFS help clinical decision making.

@&#KEYPHRASES@&#
Probabilistic fuzzy systems,Sequential forward feature selection,Area under the ROC curve,Mortality prediction,Septic shock,

@&#ABSTRACT@&#
Mortality scores based on multiple regressions are common in critical care medicine for prognostic stratification of patients. However, to be used at the point of care, they need to be both accurate and easily interpretable. In this work, we propose the application of one existent type of rule base system using statistical information – probabilistic fuzzy systems (PFS) – to predict mortality of septic shock patients. To assess its accuracy and interpretability, these models are compared to methodologies previously proposed in this domain: Takagi-Sugeno fuzzy models and logistic regression models. The methods are tested using a retrospective cohort study including ICU patients with abdominal septic shock. Regarding accuracy, PFS models are comparable to fuzzy modeling and logistic regression. In terms of interpretability, results indicate that PFS models increase the transparency of the learned system (using fuzzy rules), but at the same time, provide additional means for validating the fuzzy classifier using expert knowledge (from physicians in this paper). By providing accurate and interpretable estimates for the mortality risk, results suggest the usefulness of PFS to develop scores for critical care medicine.

@&#INTRODUCTION@&#
In 1991, the American College of Chest Physicians (ACCP) and the Society of Critical Care Medicine (SCCM) redefined sepsis as corresponding to a state where there is a systemic inflammatory response syndrome (SIRS) resulting from a confirmed infectious process [1]. A patient is considered to be in septic shock when the hypotensive state related to a sepsis condition persists, despite adequate fluid resuscitation [2].According to Angus et al. [2], more than 750,000 episodes of severe sepsis occur each year in the United States, translating into an annual mortality of more than 220,000 patients. This makes sepsis the tenth most common cause of death in the US. The mortality rate for severe sepsis and septic shock ranges from 13% to 50%, and is as high as 80% to 90% for multiple organ dysfunction [3].Scoring systems derived from prediction tools have been employed in critical care since the 1980s to assist clinicians in the process of prognostic stratification of patients [4]. In this setting, risk stratification helps (1) improving the clinical management of patients, (2) running clinical trials, and (3) as an audit tool [5]. For clinical management, the regular monitoring of scoring systems over a period of days provides an additional assessment regarding the response of patients to therapies and interventions. For clinical trials, scores are useful to understand the differences between the clinical state of the populations being evaluated. Finally, by taking into account the respective case-mix, scores can also be used as an audit tool to compare the performance of ICUs over time.For septic shock patients, different mortality prediction scores have been proposed either based on multivariate regression models [6] or on intelligent prediction methods, such as neural networks [7–9]. However, the use of logistic regression and neural networks may present drawbacks. On one hand, due to the highly nonlinear distribution of clinical data, techniques such as logistic regression may not be suitable. Flexible modeling approaches, such as non-parametric or semi-parametric modeling, are preferable, in which models can adapt to the underlying actual data distribution [10]. On the other hand, the use of neural networks is often referred to as a ‘black box’. These models are usually characterized by not having easily interpretable weights in the connection-weighting matrix, nor to easily show which input variables are the most important contributors to the output [10]. In order to deal with these ‘black box’ and crisp boundaries issues, advancements have been made to neural networks. In [11], the authors provide an interpretation of neural networks “so that they will be no longer seen as black boxes”, while in [12] a method of probability networks is proposed providing smooth transitions from one observed value to another. Nevertheless, clinicians still find it difficult to interpret.Fuzzy systems are universal approximators [13] and recognized tools in the machine learning framework, since they can present an interpretable model for the end user and are known for their capacity to deal with non-stochastic uncertainty [14]. Recent work discussed in detail the interpretability of fuzzy systems. An overview of interpretability measures is given in [15], and in [16] interpretability constraints for fuzzy information granulation is discussed. As interpretable universal approximators, fuzzy systems are a suitable tool for modeling clinical systems. The use of fuzzy systems to model clinical problems has already been proposed by different authors for different medical applications [17,18]. Despite these advancements, fuzzy systems lack the capacity of explicitly dealing with probabilistic uncertainty, which is a very important matter for physicians when it come to make a decision based on the output of a model. The capacity of probabilistic fuzzy systems to deal explicitly and simultaneously with two complementary types of uncertainty (fuzziness or linguistic uncertainty and probabilistic uncertainty), based on probability measures for fuzzy events [19], provides advantages when seeking interpretable models.In this work, mortality prediction in septic shock patients is used as an example to propose the application of probabilistic fuzzy systems as a tool to developed scoring systems in the critical care setting. These models are an extension of fuzzy systems, in which the deterministic fuzzy rules are replaced with probabilistic fuzzy rules. They allow the modeler to deal with the uncertainty associated with the linguistic terms used in the model, maintain the transparency of the learned system, and provide additional means for validating the fuzzy classifier using expert knowledge [19–21]. For clinical decision-making, estimating the probability of observing a class label is useful for both providing statistical support to the rules described as well as risk stratification against mortality. We evaluate the performance of this technique against established modeling approaches including Takagi-Sugeno fuzzy models and logistic regression.The outline of the work is as follows. In Section 2, we describe the basics of each of the modeling approaches used in the present work. The setup of the models and the database are presented in Section 3. In Section 4, we present the results, and discuss them in Section 5. The conclusions are presented in Section 6.This section describes the basics for each of the modeling approaches used in this paper. It is important to note that in this section we describe the general case containing multiple C classes for the output y. For our particular interest in mortality prediction (binary problem), the output y ∈ {C1,C2} and thus, either corresponds to the class ‘patient will survive’ (0) or ‘patient will die’ (1).Fuzzy modeling (FM) is a tool that allows the development of nonlinear models based on approximate reasoning that deals with uncertainty in the data [22,23]. This approach is particularly appealing as it provides not only a quantitative model, but also a linguistic interpretation in the form of rules and logical connectives. A fuzzy classifier contains a rule base consisting of a set of fuzzy if-then rules together with a fuzzy inference mechanism. These models ultimately classify each instance of a dataset as pertaining with a certain degree, to one of the possible classes defined for the specific problem being modeled [23]. In this work, first-order Takagi-Sugeno (TS) fuzzy systems [22] are used, which are described by rules of the type:(1)RuleRj:Ifx1isAj1and…andxNisAjNthenyj=ajTx+bjwhere j=1, …, J corresponds to the rule number, x=(x1, …, xN) is the input vector, N is the total number of inputs (features), Ajn, with n=1, …, N, is the antecedent fuzzy set and y is the consequent function (output) for rule Rj. The overall output is determined through the weighted average of the individual rule outputs. The number of rules J (defined by the number of clusters), and the antecedent fuzzy sets Ajnare determined using fuzzy clustering in the product space of the input and output variables [23]. The consequent parameters for each rule j are obtained from a weighted ordinary least-square estimate.Given that this is a classification problem, and that we have a linear consequent, a threshold t is required to turn the continuous output y′∈[0, 1] into the binary output y∈{0, 1}. In this way, if y′<t then y=0, and if y′≥t then y=1.A probabilistic fuzzy system is a particular type of fuzzy system consisting of a set of rules whose antecedents are typical fuzzy conditions, and whose consequents are probability distributions. They are based on the concept of the “probability of a fuzzy event” as proposed by Zadeh [24]. Considering the problem of determining the class ω∈ {ω1,…, ωC} to which a data point x belongs, the general probabilistic fuzzy classifier will have the following form [20,25,26](2)RuleRj:IfxisAjtheny=ω1withprobabilityPr(ω1|Aj)andy=ω2withprobabilityPr(ω2|Aj)and…y=ωCwithprobabilityPr(ωC|Aj)where j=1, …, J corresponds to the rule number, Ajis the antecedent fuzzy set of the jth rule and Pr(ωc|Aj) is the probability of the respective class ωcfor rule j. The antecedent fuzzy sets Ajin (2) are defined in the N-dimensional input space X. For each fuzzy set there is a corresponding probabilistic fuzzy rule. Furthermore, the probability parameters Pr(ωc|Aj) in (2) satisfy Pr(ωc|Aj)≥0, forc=1, …, C, and∑c=1CPr(ωc|Aj)=1.LetμAj(x)denote the membership function of a fuzzy set Aj. A probabilistic fuzzy classifier with rules given by (2) provides an estimate of Pr(y|x), the conditional probability distribution of y given x. It is assumed that the consequent space is well-formed. Provided that the probabilistic fuzzy classifier uses an additive reasoning mechanism similar to the Takagi–Sugeno reasoning, the estimatePrˆ(ωc|x)of a conditional probability Pr(ωc|x) is obtained by [25]:(3)Prˆ(ωc|x)=∑j=1JβAj(x)Pr(ωc|Aj),whereβAj(x)denotes the normalized rule activation given byβAj(x)=μAj(x)/∑j=1JμAj(x). The estimated conditional probability distributionpˆ(y|x)can be used for classifying a data point x. The following classification rule minimizes the probability of misclassification(4)yˆ=argmaxy∈{ω1,…,ωc}Prˆ(y|x).Therefore, in a probabilistic fuzzy classifier, one has to determine: (i) the parameters and type of the antecedent membership functions and, (ii) the probability parameters of the rule consequents.The first probabilistic fuzzy classifiers used a sequential method for determining the parameters in a probabilistic fuzzy classifier [20,21,27]. A more recent approach was developed in [28], where the parameters are simultaneously estimated using the maximum likelihood estimation [29]. Some studies also considered the use of rule weights, which correspond to the probabilities under certain conditions [30].Briefly, the principle behind the sequential method is that the set of parameters for the antecedent membership functions are estimated first, using for instance, unsupervised learning methods or expert knowledge. These parameters include the centers vjand widths Σjof the membership functions. Then, assuming that these first parameters are constant, the probability parameters Pr(ωc|Aj) for the rule consequents can be estimated based on probability measures of fuzzy events [24].In the present work, we consider each antecedent membership functionμAj(x)as the product of N univariate Gaussian membership functions, one for each dimension of the input space X. We then obtain(5)ϕ(x)=exp−∑n=1N(xn−vjn)2σjn2.In this way, the parameters that need to be estimated for the antecedent membership functions are given byvj={vj1,…,vjN}and Σj={σj1, …, σjN}. These variables indicate, respectively, the center and the width of the membership function in each dimension of the input space.Unsupervised methods such as clustering may be used for determining vjand Σj. A method based on fuzzy c-means (FCM) clustering [31] was considered for the estimation of the antecedent membership functions. The FCM algorithm is applied to identify a predefined number of cluster centers, which serve as the centers vjof the rule activation functionsβAj(x). The vectors Σjare estimated using the nearest neighbour[32] as follows:(6)σjn=minj′≠jvj−vj′,for(n=1,…,N),wherevj−vj′denotes the Euclidean distance between vjand vj′. In [27,28,33,34], it is proposed to estimate the probabilities Pr(ωc|Aj) according to conditional probability estimation[35] (this method to derive PFS will be referred to as PFS-CP), which results in(7)Pr(ωc|Aj)=∑i=1IβAj(xi)χωc(yi)∑i=1IβAj(xi),where the characteristic functionχωcequals 1 if y=ωcand equals 0 otherwise.The sequential method does not usually provide an optimal estimate of the antecedent and the probability parameters [28]. Some of the reasons include: (i) unsupervised learning of the antecedent parameters does not take class labels into account, which may decrease the performance of the classifier; and (ii) (7) generally does not provide maximum likelihood (ML) estimates of the probability parameters in a probabilistic fuzzy classifier. In [28], a ML method is used to estimate both the antecedent parameters and the probability parameters for the probabilistic fuzzy classifier. This method has two advantages: (1) maximizes the likelihood of the data for parameter estimation; (2) all parameters are estimated simultaneously.In this paper, first the sequential method described in Section 2.2.1 is used to initialize the parameters, which are then optimized using the ML estimation (this method to derive PFS will be referred to as PFS-ML). Maximization of the likelihood is equivalent to the minimization of the negative log-likelihood. Therefore, the following error function is minimized:(8)E=−∑i=1IlnPrˆ(yi|xi).For minimizing the error in (8), a gradient descent optimization algorithm is used. An outline of this method is given in Algorithm 1.Algorithm 1ML method to determine parameters vj, Σj, and Pr(ωc|Aj) of a PFS1) Initialize vj, Σj, and Pr(ωc|Aj)- Apply FCM clustering to find vjand Σj.- Determine initial values of Pr(ωc|Aj) by,Pr(ωc|Aj)=∑i=1IβAj(xi)χωc(yi)∑i=1IβAj(xi).2) Maximum likelihoodforiter=1→ no. of iterations dofortrain=1→ no. of training classification examples do- Simultaneous re-estimation of the parameters vj, Σjand Pr(ωc|Aj)through minimization of error function in (8).end for- DetermineE(iter)=−∑i=1IlnPrˆ(yi|xi).end forLogistic regression (LR) is a traditionally used multivariable method for modeling binary outcomes [36]. For more than one explanatory variable, the logistic regression model can be written as follows [37]:(9)logit(p)≡logp(x)1−p(x)=β0+β1x1+⋯+βNxNwhere p is the probability of death and x1, x2,…, xN, are the explanatory variables.A stepwise method of including the variables in the model is then carried out, testing the significance of inclusion or elimination of the variable at each stage. The final outputs of the model are the coefficients βi. The determined model can then be used to calculate the probabilities of an event p for a given set of inputs as in [38]:(10)p(x)=11+exp−β0+∑n=1Nβnxn.Feature selection is used to identify which of the available variables are closely related to the prediction of the outcome and to discard those unrelated to it, reducing the dimensionality of the dataset [39]. From the clinical point of view, this process may bring to light new variables that had not been previously considered as relevant to predict a given medical outcome.Tree search feature selection is an approach that orders all the possible combinations of features in the form of a tree, in which each branch represents a subset of them [40]. The main advantages of this method relate to its simplicity, possibility of graphical representation and transparent interpretation of the results, while the main disadvantage is related to their greedy and thus susceptible approach of finding local optima. In the present work, sequential forward selection was used. This technique was applied by combining it with the respective modeling technique in a so-called wrapper method [39].A detailed description of the sequential forward selection approach used here is reported in [40]. Briefly, a model is built for each of the features in consideration, and evaluated using a performance criterion upon the test set. The feature that returns the best value of the performance criterion is the one selected. Then, other feature candidates are added to the previous best model, one at a time, and evaluated. Again, the combination of features that maximizes the performance criterion is selected and this procedure is repeated until the value of the performance criterion stops increasing. In the end, all the relevant features for the considered process should be obtained. In our study, discrimination, which will be described in the following section, was used as the performance criterion.Since the problem that we consider is a binary classification (patient will die or patient will not die), the area under the receiver-operating characteristic curve (AUC) can be used to assess its discrimination performance [41,42]. This is a function of the true positive rate versus the false positive rate, integrated over all thresholds. The true positive rate and (1 – false positive rate) correspond respectively to the sensitivity and specificity of the model. In this particular problem, they represent the cases where the patient was correctly classified as dying and the cases where the patient was correctly classified as surviving.One of the aspects that distinguishes fuzzy modeling from other approaches is that, to a certain degree, fuzzy models are transparent to interpretation and analysis.We used an approach introduced in [43] for simplifying fuzzy rule-based models by reducing redundant information that is found in the form of similar fuzzy sets in the rule base. Similarity between fuzzy sets is determined using the Jaccard similarity coefficient, based on the set-theoretic operations of intersection and union:(11)S(A,B)=|A⋂B||A⋃B|,where A and B are fuzzy sets, |·| represents the cardinality of a set, and the operators ⋂ and ⋃ denote the intersection and the union, respectively [44].Two or more of such similar fuzzy sets can be merged to create a new fuzzy set representative of the merged sets. By substituting these merged fuzzy sets into a new single fuzzy set, the total number of fuzzy sets needed to constitute the model decreases. In this way, rule base simplification is achieved. However, this simplification may result in equal rules (with redundant information). In this case, only one of the equal rules is needed, and the others can be deleted. This process consists of rule base reduction. The flowchart of the simplification algorithm is depicted in Fig. 1.For the algorithm structure, the dataset was initially randomly divided into two subsets of the same size: one for feature selection (FS) and the other for model assessment (MA). In the FS data subset, a combination of sequential forward selection with probabilistic fuzzy systems, fuzzy systems or logistic regression was performed to find the subset of features that determine the best value of AUC. This best set of features was selected after ten rounds of training and testing upon the FS data subset. Afterwards, a 10-fold cross-validation was performed in the MA data subset to assess the performance of the models studied [45]. Note that the data set is formed by a set of samples, where each sample corresponds to a data vector x along the patient stay in the ICU. These samples were randomly divided between the FS and MA subsets. The ratio of survived to deceased was identical in the FS and MA subsets.This retrospective cohort study used data from the MEDAN database [46]. This is a database composed of ICU abdominal septic shock patients admitted to 70 different hospitals in Germany, collected from 1998 to 2002. All information was de-identified by removal of all protected health information. The MEDAN database contains 583 patients and 103 different variables including personal records, physiological parameters, procedures, diagnosis/therapies, medications, and respective outcomes (survived or deceased).For the purpose of this study, we performed our experiments in a subgroup of 383 patients that meet the criteria for abdominal septic shock, and focused exclusively on physiological parameters by initially considering the twenty-seven variables specified in Table 1. This choice of potential predictor variables was based on expert advice from intensivists, and an intention to include a set of commonly assessed variables within the ICU setting. There are two main types of measurements: bedside monitoring and laboratory testing. All chosen variables are measured independently with minimal correlation.It is important to note that this definition of variables has two major implications: (i) the number of patients that will form the dataset depends on the amount of variables defined, i.e. the more variables defined, the less patients are likely to have all of them collected at the same time; and (ii) the variables defined may bias the dataset towards selecting patients having similar conditions that required their specific measurement/testing.The primary outcome variable was the patient condition (alive or deceased) in a 72-h window from a given time point. This variable was defined as having a binary format, taking value one if the patient died within that period of time, and zero if not. This choice of time horizon followed the same reasoning as in [9], which considered 72-h as the most interesting prognostic period of time for building an alert system.As with other real-world databases, a few preprocessing steps were necessary to improve the quality of the data. In order to deal with variables collected with different sampling periods, a template variable was used. This process allows having all samples of all variables aligned at the same point in time as the template variable. We chose to use heart rate as the template, since it is the most frequently measured variable (in average one sample every 60min) and thus, the one introducing fewer artefacts in the data [47,48]. Regarding missing data, in general, ICU data can be missing either because they are perceived to be irrelevant for the current clinical problems (thus, not recorded), or because exogenous interventions or endogenous activities have rendered the data useless [49]. When it is possible to prove that a variable was not measured during a certain period of time because of an intentional reason (e.g. ventilator parameters when a patient is extubated), this missing segment is considered as non-recoverable [47]. In this work, these non-recoverable missing segments were deleted. On the other hand, if the variable was supposed to exist, but for some unintentional reason (e.g. cable disconnection) it is missing, this absent segment is considered recoverable and thus, proper imputation techniques can be applied [50,47,51]. In this work, the last available value was used to impute values to these recoverable missing segments.As previously pointed, both FM and PFS models require the definition of two parameters for the FCM-based clustering process [31]. These parameters include the number of clusters (which translates into the number of fuzzy rules) and the degree of fuzziness of the clustering (weighting exponent of the clustering algorithm). The first was determined based on the minimization of the partition index [52]. This index measures the compactness and separation of the clusters. It is a sum of individual cluster validity measures normalized through division by the fuzzy cardinality of each cluster. The lower this value the more compacted and separated are the clusters. A local optimum number of four clusters was found. Based on literature, the weighting exponent of the FCM algorithm, which determines the degree of fuzziness of the clustering, was given a value of 2 [53].For fuzzy models, the value of the threshold t, that turns the continuous output given by the model into a binary output, was determined during the training of the models, so that it would maximize their values of performance.Specific parameters to the PFS-ML models relate to the width of the membership functions and to the gradient descent optimization used during the maximum likelihood method. For all experiments the constraint σnj≥0.10with, j=1, …, Jandn=1, …, N, was imposed to avoid numerical instability. The number of iterations was set to 50 and a value of 0.03 was used for the learning rate. Instead of using convergence criteria, we preferred to fix the number of iterations to a number that guaranteed the error (8) to converge.For the simplification process, the similarity threshold for merging two fuzzy sets was defined as 0.4 and the similarity threshold for merging a fuzzy set to the universal set was defined as 0.8.To avoid any imprecise estimation of the contribution of each variable when using logistic regression, we started by analyzing the correlation between all variables, eliminating those highly correlated (p<0.05) [54]. Then a multivariate logistic regression combined with a forward selection algorithm was performed on the remaining set of variables, and a separate model was built using the most significant predictors (p<0.05) selected by the algorithm.

@&#CONCLUSIONS@&#
In the present work probabilistic fuzzy systems were applied to predict mortality among septic shock patients. Probabilistic fuzzy systems is a new approach for incorporating probability into fuzzy logic in order to better represent non-deterministic real world systems. The performance of this technique was evaluated against first-order Takagi-Sugeno fuzzy models and logistic regression models.Our study shows that probabilistic fuzzy systems with maximum likelihood estimation: (i) perform comparably as to traditional fuzzy systems and logistic regression models, and that (ii) they provide easily interpretable additional information based on probability. This additional information has the potential to make PFS models more useful within the clinical setting. Future work will involve validating the present results against larger ICU databases containing a much larger number of patients.