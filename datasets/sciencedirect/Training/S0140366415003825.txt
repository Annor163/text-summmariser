@&#MAIN-TITLE@&#
PrivHab+: A secure geographic routing protocol for DTN

@&#HIGHLIGHTS@&#
PrivHab+ is a secure geographic routing protocol that learns the habits of the nodes.PrivHab+ compares nodes and selects the best to carry a message towards a location.PrivHab+ makes use of cryptographic techniques to preserve nodes’ privacy.PrivHab+ performance is studied under the scope of a podcast distribution application.

@&#KEYPHRASES@&#
Opportunistic networking,Delay-Tolerant networking,DTN routing,Georouting,Privacy,

@&#ABSTRACT@&#
We present PrivHab+, a secure geographic routing protocol that learns about the mobility habits of the nodes of the network and uses this information in a secure manner. PrivHab+ is designed to operate in areas that lack of network, using the store-carry-and-forward approach. PrivHab+ compares nodes and chooses the best choice to carry messages towards a known geographical location. To achieve a high performance and low overhead, PrivHab+ uses information about the usual whereabouts of the nodes to make optimal routing decisions. PrivHab+ makes use of cryptographic techniques from secure multi-party computation to preserve nodes’ privacy while taking routing decisions. The overhead introduced by PrivHab+ is evaluated using a proof-of-concept implementation, and its performance is studied under the scope of a realistic application of podcast distribution. PrivHab+ is compared, through simulation, with a set of well-known delay-tolerant routing algorithms in two different scenarios of remote rural areas.Many initiatives have been implemented to improve the life conditions of people living in developing countries by universalising the access to knowledge and information. These applications usually target rural areas and are very likely to deal with challenges like a sparse population, and a lack of data communication networks.The need of infrastructure constrains the reach of these applications, because they cannot operate in regions lacking it. It happens that regions where the communication networks are unavailable or spotty, are usually the ones where these services would be more needed and valuable. Delay Tolerant Networking (DTN), based on the store-carry-and-forward strategy, is designed to operate in these challenged scenarios. DTN deals with the absence of simultaneous end-to-end paths [3] through the usage of mobile devices that opportunistically establish contact and exchange messages between them.Routing protocols designed to operate in DTN scenarios usually generate and use information about node behaviours, as the historic of contacts established with each other node [27]. Then, they share this information with neighbours in order to improve the decision making [26]. Moreover, in some cases, a node is linked to a person, e. g. because it is carried in a pocket or backpack [31], or because they travel in the same vehicle. Therefore, the information that routing protocols use and share can be seen as private information about people’s whereabouts or frequent behaviours. The more accurate and sensitive this information is, the more useful it is for the routing protocol, the more important is to protect its privacy [2]. Accordingly, a protocol that protects the privacy of this information expands the amount of scenarios where it can be used [13].Our main contributions are summarised below:•We introduce the concept of node’s habitat, the area where a node is more likely to be found. The habitat is built by exploiting the life-cycles of the network users. It is a very useful tool for making routing decisions by comparing two nodes’ habitats and selecting the best choice to deliver a message to its destination. We use an elliptic model of habitat to allow devices of small capabilities to work and to operate with it.We define PrivHab+, a novel DTN secure geographical routing protocol designed to operate in areas without network infrastructure. PrivHab+ uses the learnt information about the usual whereabouts of the nodes to find the best neighbour to carry the messages. PrivHab+ protects node’s privacy by cryptographically protecting this information to avoid its disclosure.The rest of this article is organised as follows. In Section 2, reviews the state of the art and provides a description about some related work of Geographical Routing Protocols, Secure Routing Protocols and Social-based Routing Protocols. In Section 3, we present the habitat, a useful information to compare nodes while routing messages. We explain how it is modelled and updated. Later, we introduce the concepts of homomorphic cryptography and Taxicab geometry, both needed to preserve nodes’ privacy while routing using the habitat. In Section 4.5, we present PrivHab+, a routing protocol that uses the habitats of the nodes to route messages while preserving the privacy of the nodes of the network. In Section 5, we analyse the knowledge obtained by each participant of the protocol and we reason about the privacy that PrivHab+ provides. In Section 6, we present the proof-of-concept we have implemented, and we use it to measure the performance of PrivHab+. In Section 7, we expose the results of the simulations that compare PrivHab+ with a set of well-known DTN routing protocols. Finally, Section 8 concludes this paper.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
Anything learned by A about HB, or by B about HA, from the protocol is also learnable from the output alone. The computation made is a routing protocol, so, if m is forwarded to B, coordinates of P are revealed to B because they will be needed in the next executions. Otherwise, the only thing B learns about P is the region1818The region where P is located is far less accurate that the coordinates of P or the distance between P and HB. Moreover, B does not even know who is the destination, and therefore, B cannot relate this P’s region with any node.where it is located in relation with HB, because this knowledge is necessary for B to compute dB.Therefore, PrivHab+ is secure to A and B because it reveals only the result of the algorithm and inferences derived from this result. Besides, PrivHab+ provides best-effort privacy to P because it hides its location and reveals only the region where P is located. As we have explained in the previous section, this can be easily enhanced by breaking the relation between the destination and P using a pseudonym generator mechanism.In the active adversary mode, we consider an attacker that may use untruthful information about their own habitat, the messages they carry, or the location P where a message is intended, in order to disclose private information about the other part’s habitat.A node carrying a message can lie about P, dAand rAin order to uncover information about HB. There are two strategies that an active attacker A can follow: 1) Produce chosen-destination arbitrary messages using a set of false P′ anddA′to try to discover the area covered by HB; and 2) tamperrA′to learn about rB.1.Discover the area covered by HB: every time PrivHab+ is executed, A learns that HBis located completely outside a circle with centre at P and radius dAif node A is chosen as the best choice. The same way, A learns that at least one part of HBis located inside a circle with centre at P and radius dAif the best choice is B. Therefore, node A can exploit this by producing arbitrary messages destined to a set of locations P′ and using set of false distancesdA′,and then repeatedly execute PrivHab+ to try to learn the area covered by HB. The knowledge that A can obtain from this is summarised by Table 5.Discover rB: the result of an execution of PrivHab+ consists of a tuple containing two results randomly ordered. Each result can be greater or equal than zero (≥ 0), or negative (< 0). One of them, the radius comparison, only makes sense if and only ifdA=0. In order to know the result of the radius comparison, A needs to repeatedly execute PrivHab+ using the same valuesdA′=0andrA′,and a different P, until obtaining a different result in one of the two comparisons. When this happens, node A learns which result corresponds to each comparison, and learns if rBis higher or lesser thanrA′. Note that the only way to obtain a different result in one comparison using this method is by using two falseP1′andP2′that are located one inside HBand the other outside it. Table 6 summarises this process.Node B does not initiate the execution of PrivHab+, nor controls the amount of messages mithat will be routed. Then, its only chance to lie is manipulating the results of the comparisons sent in Step 3. The candidate node B can lie about its habitat, usingHB′instead of HB, or about the distance from its habitat to P, usingdB′instead of dB. Given that using a tampered habitatHB′will lead to the calculation of an untruthful distancedB′,both cases can be treated likewise. Table 7summarises all knowledge learned by B in these two cases.Node B will obtain more information about HAlying than being truthful only if B finally receives the message anddB′>dB,or if B does not receive the message anddB′<dB. In both cases, P, and, therefore dB, are unknown to B prior of the exchange. Therefore, B wantsdB′to be high to obtain more information if B will win the comparison, but a higherdb′makes B less likely to win it. Equivalently, B wantsdB′to be small if B will lose the comparison, but a lesserdb′makes B more likely to be selected as the best candidate. Besides, B will not obtain P if does not receive the message, and knowing the distance between HAand P is not useful if P is unknown. For these reasons, there is no a straightforward strategy to selectHB′or dBand guarantee that B will take an advantage from this.An active attacker can try to learn things about the other part’s habitat by using untruthful information during the execution of PrivHab+. A can try to learn the area covered by HBand its radius rB, while B can try to learn the distance from HAto P. In both cases, the information obtained by the attacker is the same information (the result of one or more comparisons) that he can infer from a truthful execution of the protocol. The only thing an attacker can change is the value to compare with the other part’s radius or distance. However, the attacker can only benefit from these changes if the change made and the result of PrivHab+ are aligned. And in all cases happens that changing the value to improve its usefulness decreases the probability of obtaining the desired result.As A is the node that starts the transaction and the only one that knows the number of messages he carries, he can determine how many times to execute PrivHab+. If A executes PrivHab+ enough times, using untruthful information and the attacks described in Section 5.2.1, he can completely uncover the area covered by HBand its radius. Given that nodes always operate with encrypted data, there is no way for one part to tell apart a truthful execution of PrivHab+ from an untruthful one. However, B can decrease the effectiveness of these attacks by limiting the amount of interactions per unit of time with every other node.When A is performing a series of untruthful executions to discover B’s habitat, A wants to know the result of the previous execution to improve the amount of obtained information in the next one. For example, A can start by selecting an evenly spread set of positions to try to discover the area covered by HB. However, when A has found that there is a part of HBinside the circle defined by one of these positions, it is much more useful to A to investigate this circle and its surroundings than continue with the remaining positions. Therefore, B can reduce the effectiveness of the attacker by taking the countermeasure of forcing A to send him at once the information needed to perform all the executions before sending any response.Finally, when combining the two proposed measures, limiting the amount of executions per unit of time, and requiring all the information at once before sending any results to A, the effectivity of an active attack becomes greatly reduced, and the attacker ends learning almost the same things that he would learn by being truthful. Besides, the information protected by PrivHab+, the habitat, changes periodically. For this reason, slowing enough an attack can be considered equivalently as avoiding it, because when time passes the habitats change and the first things learned by the attacker become obsolete.We have defined an elliptic model of habitat. The habitat models node’s whereabouts based on the idea of exploiting life-cycles. The habitat is useful to compare the intermediate nodes to decide who is a better choice to carry each message towards its destination. We have presented PrivHab+, a secure geographical DTN routing protocol that uses the habitat to make routing decisions. PrivHab+ takes advantage of Taxicab geometry and makes use of homomorphic cryptography techniques to preserve the privacy of the participants while comparing the habitats of the candidate nodes.PrivHab+ has been analysed as a secure multi-party computation to proof that the protocol is secure. The only knowledge that can be learned by each participant about others intimacy is the same that could be inferred from the output of the protocol. This is an important point that makes PrivHab+ recommendable to use in scenarios where nodes are so related, directly or indirectly, to a person that their privacy needs to be protected.We have developed a proof-of-concept implementation that demonstrates that the presented protocol is viable and that it can be executed on small devices with a good performance. Both the computation and the communication overhead introduced by PrivHab+ is proven to be affordable and to not degrade the performance of the network. Besides, simulations based on two podcast distribution scenarios have shown that PrivHab+ performs better than a set of well known DTN routing protocols and minimises the network overhead. The qualitative comparison between PrivHab+ and the other routing protocols shows that PrivHab+ is a good choice not only for this two scenarios. In fact, PrivHab+ is a good choice in any DTN scenario where nodes are linked to people, where mobility patterns are routinary, and where the considered distances are high, forcing the need of lots of hops to reach each destination.As future lines of research, we plan to study the impact of different forwarding policies on the performance of PrivHab+, to improve the elliptic model of habitat using a more complex representation, that does not have to be necessarily a geometric figure, and to develop an enhanced version of PrivHab+ that compares simultaneously three or more habitats. We also plan to study the performance of PrivHab+ in different scenarios and to present more real applications that could benefit from this secure geographic routing protocol.