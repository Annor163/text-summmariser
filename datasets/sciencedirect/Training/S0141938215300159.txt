@&#MAIN-TITLE@&#
Visual discomfort relaxation for stereoscopic 3D images by adjusting zero-disparity plane for projection

@&#HIGHLIGHTS@&#
Factors from spatial frequency, disparity energy and visual attention are considered.An optimal ZDP from the derived visual discomfort map is established.We adjust the convergence plane first based on the depth value of the ZDP.We reproject the disparity ranges of the crossed and uncrossed disparities.

@&#KEYPHRASES@&#
Visual discomfort relaxation,Stereoscopic 3D images,Zero-disparity plane,Disparity remapping,

@&#ABSTRACT@&#
It is a challenging task to improve the visual comfort of a stereoscopic 3D (S3D) image with satisfactory viewing experience. In this paper, we propose a visual comfort improvement scheme by adjusting zero-disparity plane (ZDP) for projection. The degree of visual discomfort is predicted by considering three factors: spatial frequency, disparity response, and visual attention. Then, the selection of an optimal ZDP is guided by the predicted visual discomfort map. Finally, the disparity ranges of the crossed and uncrossed disparities are automatically adjusted according to the ZDP as requirements. Experiment results show that the proposed scheme is effective in improving visual comfort while preserving the unchanged depth sensation.

@&#INTRODUCTION@&#
In recent years, stereoscopic 3D (S3D) images have become very popular. Many 3D television and displays are available, and many 3D movies are produced using sophisticated 3D video capture and stereography techniques. However, visual fatigue/discomfort is still an unsatisfactory experience in viewing a S3D image/video, which hinders the widespread promotion of 3D services. The issue of visual discomfort involves not only technical aspects, but also perceptual aspects [1,2]. As a result, the demand for visual comfort improvement is increasing in the fields of 3D content production, 3D display design, and so on.There are several factors that induce visual discomfort in S3D images. (i) Disparity magnitude. It has been known that scenes with larger disparities tend to induce visual discomfort. The magnitude of crossed and uncrossed disparities has different impacts on visual discomfort, and the crossed disparity plays a more important role in affecting the visual discomfort [3]. If the disparity does not lie within the zone of comfort, the so-called Percival’s Zone of Comfort (PZC) [4], observers will experience visual discomfort. In addition, depth of focus (DOF) can serve as a threshold on accommodation to form comfortable viewing zone [5]. (ii) Spatial frequency. Schor et al. [6] have demonstrated that spatial frequency has a significant influence on binocular fusion limit with the visual stimuli created by the difference of Gaussians, i.e., the binocular fusion limit increase as spatial frequency decrease. (iii) Visual attention. The salient object attracts our eyes at the first glance, and our eyes try to adjust vergence to focus on the salient object [7]. Thus, conflict between accommodation and convergence will occur [8]. In addition, disparity gradient, object motion, etc, will all affect the visual comfort. Comprehensive factors affecting visual comfort can be found in [1,2,9,10].Several visual comfort assessment (VCA) methods have been proposed to measure the degree of visual discomfort in an objective manner [11–16]. Kim and Sohn [11] proposed a visual fatigue prediction metric by considering excessive horizontal and vertical disparities. Lee et al. [12] exploited the effect of stimulus width on perceived visual comfort by measuring subjective visual comfort and binocular fusion limit. Sohn et al. [13] derived a VCA model based on relative disparity and object thickness features. Park et al. [14] extracted features accounting for both accommodation and vergence, and derived a 3D-VAM predictor for VCA. In our previous work, we trained a robust VCA model via learning a preference classification model [15]. Other relevant works can also be found in [16,17].To improve visual comfort, disparity remapping is an essential postproduction technique to adjust the disparity range so as to provide a satisfactory viewing experience [18]. Linear disparity remapping is the simplest way to scale a disparity range to the visual comfort zone. However, unnatural visual artifacts may occur by the linear way. Recently, nonlinear disparity remapping schemes have been presented to enhance 3D viewing experience. Lang et al. [19] presented nonlinear disparity remapping operators to enhance the depth perception of salient object. Yan et al. [20] proposed a disparity remapping technique to adjust the depth range of a stereoscopic video according to the actual display setting, while preserving the relationship of neighboring features with line and plane bending constraints. Oh et al. [21] proposed a nonlinear remapping method that predicted a visual fatigue map based on spatial frequency, disparity magnitude and disparity motion, and compressed the disparity range of the problematic region. Jung et al. [22] proposed a new method for visual comfort improvement that adjusted (scaled and shifted) the disparity of a scene under the guidance of an objective VCA metric. Sohn et al. [23] used linear disparity remapping to adjust the disparity range, and nonlinear disparity remapping to selectively adjust disparities of local problematic disparity ranges. Other relevant works can also be found in [24,25].In this paper, we propose a visual comfort improvement scheme which considers visual discomfort factors existing in a stereoscopic image. The main goal of this work is to offer a simple but effective solution for shifting the disparity of a stereoscopic image. Toward this end, visual discomfort is predicted by taking the factors from spatial frequency, disparity response, and visual attention. Then, the selection of an optimal ZDP is guided by the predicted visual discomfort map. Finally, the disparity ranges of the crossed and uncrossed disparities are automatically adjusted according to the ZDP, thus resulting in a comfortable viewing for a stereoscopic image.The remainder of the paper is organized as follows. Section 2 introduces related background and works. Section 3 presents the proposed quality assessment approach. The experimental results are given and discussed in Section 4, and finally conclusions are drawn in Section 5.The brain uses binocular disparity to extract depth information from the retinal images in binocular vision. As shown in Fig. 1, depending on the distance from the plane of fixation, disparity has different forms of zero disparity, positive (uncrossed) disparity and negative (crossed) disparity. In the figure, α is the angle between the two eyes when verged at a fixation point on the display screen (to reflect accommodation distance) and β is the angle between projections onto the retina points which the viewer is looking at (to reflect convergence distance). Points with negative (α−β<0), or positive (α−β>0) disparities are perceived in front of or behind the display screen, respectively. Normally, human visual system (HVS) can tolerate some level of the accommodation-vergence conflict without a loss of visual comfort (e.g., within Percival’s Zone of Comfort (PZC)). However, when fusing and focusing the objects perceived outside the PZC, HVS can perceive the loss of accommodation and/or loss of binocular fusion, leading to visual discomfort (like eyestrain, headache, or diplopia).In this paper, we focus on visual discomfort induced by accommodation-vergence conflict, and disparity characteristics (e.g., disparity range, display plane) are considered to reduce the visual discomfort. We divide the methods into two broad categories:(1)Disparity remapping[18–22]. The existing disparity remapping methods adjust (squeeze) the disparity range of a scene (Fig. 2(a)). The disparity range can be linearly or nonlinearly (also globally or locally) adjusted into the comfort zone to avoid excessive accommodation-vergence conflicts of the scene. However, since the range of comfort zone is limited (e.g., ±1° disparity for comfortable viewing zone), if large disparity range squeezing is performed, rendering artifacts will be appeared in the processed images.Disparity shifting[24,25]. The existing disparity shifting methods adjust the ZDP of a scene but maintain its original disparity range (Fig. 2(b)). Excessive disparities can be reduced to minimize the accommodation–vergence conflicts in a scene. The main advantage of the disparity shifting is its low computational complexity. However, since the overall disparity range is not changed, disparity shifting alone cannot fully cover the range of comfort zone if the disparity range exceeds the range of a certain comfortable viewing zone.In this paper, we focus on the latter for visual comfort improvement (or visual discomfort relaxation) for its simplicity and accessibility. However, directly applying the disparity shifting on the stereoscopic images cannot obtain satisfactory results. We make innovations in the following aspects:(1)We comprehensively consider the visual discomfort factors from spatial frequency, disparity response and visual attention to characterize the degree of visual discomfort locally, and establish an optimal ZDP from the derived visual discomfort map.Instead of directly adjusting the disparity values, we adjust the convergence plane first based on the depth value of the ZDP, and then reproject the disparity ranges of the crossed and uncrossed disparities, but maintain the overall disparity range unchanged.The objective of the proposed visual discomfort relaxation scheme is to control the ZDP with respect to the predicted degree of visual discomfort. In other words, the proposed scheme is to relaxe the eye strain in fusing discomfortable objects. The overall framework of the proposed scheme is shown in Fig. 3. In order to predict the degree of visual discomfort for a S3D image, three factors are taken into account: spatial frequency, disparity response, and visual attention. Then, a visual discomfort map is obtained to indicate the degree of discomfort in a local manner. In addition, a ZDP is selected from the derived visual discomfort map. Using the ZDP as benchmark, a disparity reprojection operation is performed to adjust the disparity ranges of the crossed (negative) and uncrossed (positive) disparities.As investigated in earlier studies [3–10], visual discomfort in S3D images can be induced by many factors, such as excessive disparity, accommodation-convergence conflict, binocular mismatch and depth motion, etc. In this paper, we consider the following factors that may induce visual discomfort in S3D images: spatial frequency, disparity response and visual attention. Each factor can be visualized as an index map to indicate the degree of visual discomfort locally, i.e., the local value of the map is somewhat proportional to the degree of visual discomfort. Finally, these index maps are aggregated to generate an overall visual discomfort map.Binocular fusion limit will be increased with the decreased spatial frequency [26]. Generally, regions with high spatial frequency tend to give more visual discomfort than those with low spatial frequency. Many methods have been proposed to extract spatial frequency. Here, we directly exploit phase congruency to extract the spatial frequency. In this paper, we use the method in [27] for phase congruency (PC) calculation using log-Gabor filter. A set of responses on different scales and along different orientations, denoted as[ηs,o,ζs,o], can be obtained by applying the log-Gabor filter. Then, by modulating the scale and orientation, local amplitude at location x on scale α and along orientation o is given by(1)As,o(x)=ηs,ox2+ξs,ox2At the same time, the local energy along orientation o is given by(2)Eo(x)=Fox2+Hox2whereFo(x)=∑sηs,o(x)andHo(x)=∑sζs,o(x). Then, the PC map is computed across all orientations by(3)f1(x)=1NP·∑oEo(x)ε+∑s∑oAs,o(x)where ε is a small positive constant, and NPis the normalization factor of phase congruency. The design of the filter is based on the work in [27].It is also known that visual discomfort is directly related to the stimulus from the amount of screen disparity, i.e., the accommodation–vergence conflict becomes more severe when increasing screen disparity [28]. Some psychophysical experiments have been conducted to investigate the relationship between subjective visual discomfort and the amount of binocular disparity. In this paper, we directly use the function in [29] to predict the degree of visual comfort with a varying amount of the angular disparities, i.e.,(4)VC(da)=-0.020(da)3-0.138(da)2+0.208(da)+4.849,ifda<0-0.009(da)3+0.150(da)2-0.954(da)+4.912,otherwiseNoted that in the subjective assessment [29], only the foreground is given a disparity in the range of +6° to −6°, and the background has zero disparity. The recorded visual comfort score at da=0 is the largest, however, depth sensation for this case does not exist. Thus, the above model will be still guaranteed when applied for versatile 3D contents. The angular disparity da(x) of each pixel is obtained from pixel disparity dc(x) via(5)da(x)=2tan-1I/2V-tan-1I/2V-Zwhere I and V are the inter-ocular distance and the viewing distance, respectively. The distance Z between an object and display is computed as(6)Z=dm(x)·Vdm(x)-IThe displayed disparity dm(x) is converted from dc(x) by(7)dm(x)=XmXC·dc(x)where XCis the width of the image, and Xmis the horizontal length of the display.To reflect the degree of visual discomfort, the above visual comfort prediction function is inversely to obtain the disparity response map, denoted as f2(x).(8)f2(x)=1-VC(da(x))NVwhere NVis the normalization factor of visual comfort prediction values.It is also known that 3D visual attention plays an important role in determining the overall degree of visual discomfort [17], e.g., the salient regions tend to be comfortable or uncomfortable [30]. Refer to [31], we extract four features of color, luminance, texture and depth from DCT coefficients from an input stereoscopic image. The feature contrast of a basic region i is defined as a function of the region position piand feature vector fi, i.e.,(9)Sif=∑j‖fi-fj‖2·w(pi,pj)where fiand fjare the feature vectors in regions Riand Rj; piand pjare the positions of the regions; the Gaussian weightw(pi,pj)=exp(-‖pi-pj‖2/2σp2), where σpcontrols the range of feature contrast.From another perspective, a salient region is also expected to be spatially compact. Thus, the spatial compactness of each region is calculated by(10)Sip=∑j‖pj-μi‖2·w(fi,fj)where the Gaussian weightw(fi,fj)=exp(-‖fi,fj‖2/2σc2); σccontrols the range of spatial distance; μiis the weighted mean position of color ci, which is calculated by(11)μi=∑jpj·w(fi,fj)∑jw(fi,fj)The final 3D saliency value for each region is computed by(12)fi=γ1·Sif+γ2·Sipwhere γ1 and γ2 are two parameters used to weight the two components. In the experiment, we consider the saliency map from feature contrast more important than the spatial compactness, and the parameters are set as γ1=0.7 and γ2=0.3 empirically.Based on the above index maps computed in Eqs. (3), (8) and (12), a final visual discomfort map is obtained by(13)F(x)=∏i=13f̃i(x)wheref̃i(x)denotes the normalized version of fi(x). Rather than using linear combination of three index maps, it is more effective to compute the visual discomfort map by the multiplication combination. Fig. 4shows the examples of each index maps and the final visual discomfort maps. Obviously, by combining these index maps using multiplication, regions with high visual discomfort will be highlighted effectively. It is worth emphasizing that the factors affecting visual discomfort are not limited to the above items, and other cues, such as accommodation-convergence conflict [32], unnatural blur/sharpness [33], crosstalk [34], can be investigated and included in the framework.To achieve a comfortable viewing for the discomfortable S3D image, the ZDP should be adjusted to reduce the amount of negative disparities. Typically, excessive negative disparities may cause visual discomfort. In this research, the ZDP is directly setted on the key-point with the maximum visual discomfort value, because we regard that visual discomfort for this key-point should be particularly reduced. Thus, we have(14)xZDP=argmaxxF(x)By assigning a zero or an expected disparity value for the ZDP (i.e., shifting the ZDP on the xZDP), the targeted visual discomfort object is arranged to a comfortable position.Regarding depth quantization, the relationship between the real depth value z and the quantized depth level v is expressed using a non-linear 8-bit depth quantization function in MPEG-3DV [35](15)z=1v2551znear-1zfar+1zfarwhere znearand zfarare the farthest and nearest depth values.The horizontal disparity can be obtained from the real depth value by [35](16)d=f·l·1zc-1zwhere f, l, and zcrepresent the focal length of the camera, baseline length between the two views, and the depth value of the convergence plane.Given the depth value vZDPin the ZDP, its real depth value is computed by(17)zZDP=1vZDP·C1+C2whereC1=12551znear-1zfar, andC2=1znear.By setting a zero disparity value for the ZDP (dZDP=0), the adjusted convergence plane is expressed as(18)z̃c=zZDP·f·ldZDP·zZDP+f·lWe also set several non-zero disparity values for the ZDP, and find that their performances are not prominent (the results with different non-zero values will be analyzed in SubSection 4.4). Thus, we use a zero value for the ZDP in all sequences. With the adjusted convergence plane in (18), the subsequent disparity adjustment will be very simply by reprojecting the left image to its right side using the adjusted disparity. Considering the adjusted convergence plane in (18), the disparity distance after adjusting is represented as(19)Δd=f·l·1zc-1z̃cOur scheme is especially suitable to adjust a parallel plane to be convergence. For example, in a parallel camera array (only with negative disparity that1/zc≈0), for the pixels with depth values larger than zZDP, the adjusted disparity values will be positive, while the adjusted disparity values of other pixels will be still negative (to adjust the ratio between the negative and positive disparity ranges).Different with the state-of-the-art disparity remapping methods that squeeze the disparity range [17–21], the overall disparity range after reprojection is not affected but placed into a comfortable disparity interval. The absolute disparity range is expressed as(20)Φ=Φ-∪Φ+=f·l·1znear-1zfarwhere the negative disparity range Φ− and positive disparity range Φ+ are represented as(21)Φ-=f·l·1znear-1z̃cΦ+=f·l·1z̃c-1zfarThe crossed disparities (perceived in front of the screen) and uncrossed disparities (perceived behind the screen) have different impacts on visual discomfort, and especially the crossed disparities will have greater impact on the visual discomfort. For the case only with negative disparity (e.g.,1/zc≈0), the ratio between the crossed and uncrossed disparity ranges with or without adjusting is expressed as(22)κ=zfar-znear,without adjustingzZDP·zfar-znear·zfarznear·zfar-zZDP·znear,with adjustingSince we project the left image to its right side using the adjusted disparity, occlusion or disocclusion will be appeared unavoidably in the projected right image. In this research, we use the common hole filling algorithms in the view synthesis reference software (VSRS) to fill these occluded/disoccluded pixels. Even though the projected (or hole-filled) right image is somewhat different with the original right image, their influences on stereoscopic depth sensation can be omitted.As stated in the above SubSection 2.2, the prominent advantage of disparity shifting is its low computational complexity. By omitting the computational complexity of the visual discomfort map prediction, the complexity of the disparity reprojection operation may be very low because it is only computed once without complex matrix operation.

@&#CONCLUSIONS@&#
This paper proposes a novel visual discomfort relaxation method for stereoscopic 3D images. Firstly, factors from spatial frequency, disparity response, and visual attention, are considered to predict the degree of visual discomfort. Then, an optimal ZDP for the left image is selected guided by the predicted visual discomfort map, and the disparities are obtained with the ZDP. Finally, disparity reprojection is performed according to the adjusted disparities of left image to get the stereoscopic composite images. We have evaluated performance with subjective experiments. Experimental results showed that the depth sensation and visual comfort with the proposed method are easy to recognize and the stereo senses are high.