@&#MAIN-TITLE@&#
Linear feature detection based on the multi-scale, multi-structuring element, grey-level hit-or-miss transform

@&#HIGHLIGHTS@&#
Multi-scale extension of multi-structuring elements for hit-or-miss transform.Utilizing the grey-level hit-or-miss transform for linear feature detection.Performing linear feature detection without thresholding.

@&#KEYPHRASES@&#
Multi-scale,Hit-or-miss transform,Linear feature detection,Mathematical morphology,

@&#ABSTRACT@&#
Detecting the linear features in an image is a key technology for different applications. In this paper, a simple and effective algorithm based on the hit-or-miss transform is proposed. To detect linear features with different directions, multi-structuring elements corresponding to different directions are constructed. To detect linear features with different widths, a multi-scale extension of the constructed multi-structuring elements is used. Then, the grey-level hit-or-miss transform that utilizes the constructed multi-scales of multi-structuring elements could effectively extract all of the possible linear features without thresholding. Therefore, after refining the extracted linear feature regions using three simple steps, the final linear features could be effectively detected. Experimental results on different images from different applications show that the proposed algorithm performs well for detecting linear features with different widths, different grey distributions and noises.

@&#INTRODUCTION@&#
Linear features in an image usually represent the important properties in different image-based applications, such as defect detection in industry [1], insect morphology analysis [2], and length measurement [3,4]. So, it is crucial to detect linear features in an image.Linear features in an image are usually complicated, which make detection difficult. One effective algorithm should satisfactorily detect all of the possible linear features in different types of images. To detect linear features, several algorithms have been proposed. Radon and Hough transform based algorithms [5,6] have been used to detect straight lines, circles and ellipses, but they could not be easily generalized for detecting lines with arbitrary shapes. Empirical algorithms [1,7] usually use prior knowledge from the special type of detected linear features, and therefore, these algorithms could not detect all of the possible linear features in different types of images. Shortest path based methods [8,9] could only detect several linear features because of some special limitations; thus, they may be not effective for detecting all of the possible linear features in an image. To detect all of the possible linear features, thresholding methods [1,10], non-maximum suppression based methods [2] and edge detectors [1,11] have been used. Thresholding methods may be effective if the grey value distributions of the linear feature regions are very different from other regions. Non-maximum suppression-based methods and edge detectors may be sensitive to the noises in images or the grey variation of image regions.Mathematical morphology has been widely used in different applications [12–24]. Among the morphological operators, the top-hat transform and grey-level hit-or-miss transform could be used to extract image regions with a similar shape to the used structuring element [13,17–24]. However, the performance of the top-hat transform based algorithm may be affected by thresholding in the post-processing procedure. Linear features are usually the regions with linear shape in an image. So, the grey-level hit-or-miss transform may also be used to detect linear features by utilizing the linear structuring element. Moreover, by appropriately constructing the hit-or-miss structuring elements, post-processing after the hit-or-miss transform for detecting the possible linear features may not need thresholding. Actually, because the perfect value for thresholding is important but difficult to determine, using the hit-or-miss transform for linear feature detection would simplify the detection procedure. Thus, a hit-or-miss transform based algorithm is proposed in this paper. The proposed algorithm is effective and simple. The main contributions of this paper are: (1) Utilizing the grey-level morphological hit-or-miss transform in the application of linear feature detection; and (2) proposing a simple but effective algorithm for linear feature detection without thresholding. In this algorithm, multi-structuring elements are constructed and used in the hit-or-miss transform to detect all of the possible linear features with different directions. Additionally, the multi-scales of the multi-structuring elements are designed and used in the hit-or-miss transform to detect all of the possible linear features with different widths. Moreover, no special information or properties of the original image is needed. Then, the proposed algorithm could be used in different types of images. Additionally, several simple operations are used to obtain the lines with the width of a single pixel to represent the final detected linear features. Experimental results on different types of images show that the proposed algorithm is effective.This paper is organized as follows. Section 2 introduces the hit-or-miss transform. Section 3 presents the algorithm. Section 4 describes the experimental results, and Section 5 concludes the paper.The definitions of the morphological operators in this section are from [12–24]. Suppose there is a Euclidean or digital space E (E=Rnor Zn). For a setI⊂E,Iˇ={−x|x∈I} is the symmetrical of I. Ic=E/I is the complement of I. Ip={x+p|x∈I} is the translate of I.ϕis a null set. Morphological operations are based on two sets: the image F and the structuring element B.The dilation and erosion of image F by using structuring element B are defined using the Minkowski addition (denoted by⊕) and subtraction (denoted by⊖) as follows:(1)F⊕B=⋃b∈BFb,(2)F⊖B=⋂b∈BF-b.In the definitions of dilation and erosion, b is the pixel of B.The hit-or-miss transform is defined based on dilation and erosion. In the hit-or-miss transform, a pair of structuring elements (denoted by A and B andA∩B=ϕ) is used. A and B are the hit and miss structuring elements, which represent the foreground and background structuring elements, respectively. Using A and B, the hit-or-miss transform is defined as follows [12,22,24]:(3)F⊗(A,B)=(F⊖B)∩(Fc⊕B).⊗denotes the general definition of the hit-or-miss transform.The hit-or-miss transform has been frequently used in binary image processing. In addition, it has been used to generalize the hit-or-miss transform for grey-level image analysis [12,22,24]. Suppose T represents the grey levels of an image, and TErepresents grey-level images E→T, denoted by F, G, …, respectively. Then, TEis a complete lattice for the component-wise ordering F⩽G, F∈TE, G∈TE. In this case, the grey dilation and erosion are defined by using Minkowski addition (⊕) and subtraction (⊖) as follows [12,22,24]:(4)F⊕G=suph∈E(F(p-h)+G(h)),(5)F⊖G=infh∈E(F(p-h)-G(h)).In image space, p and h represent the pixels in F and G, respectively.Using the grey dilation and erosion, one grey-level hit-or-miss transform, denoted by HMT, is defined as follows [12,22,24].(6)HMT(p)=max{(F⊖A)(p)-(F⊕B⌣)(p),0}.The hit-or-miss transform detects regions corresponding to the shape of the used structuring elements. Then, if the pair of structuring elements is reasonably designed, the hit-or-miss transform could detect linear features with shapes corresponding to the shape of the used structuring elements. To detect linear features at all directions, multi-structuring elements corresponding to different directions should be used.In digital space, any linear feature could be approximately represented by lines in four directions: 0°, 45°, 90° and 135° [2,17,23]. Therefore, four pairs of structuring elements corresponding to four directions (0°, 45°, 90° and 135°) could be constructed and used. The hit structuring element A is used to represent the linear feature regions. Four hit structuring elements corresponding to four directions (0°, 45°, 90° and 135°) are demonstrated in Fig. 1. The miss structuring element B represents the outer region of linear feature regions. Four miss structuring elements corresponding to four directions (0°, 45°, 90° and 135°) are demonstrated in Fig. 2. Although these used structuring elements have similar shapes to [23], these structuring elements in this paper are used by the hit-or-miss transform and have different size relationships from [23]. Additionally, these structuring elements have multi-scale extensions in this paper.nL is the length of the hit and miss structuring elements. nW is the width of the hit structuring element. nIW is the width of the inner region of the miss structuring element. nCW is the width of the outer region of the miss structuring element.In digital space, the matrix expressions of the hit structuring element A0 and the miss structuring element B0 are as follows:(7)A0=0…0………0…01…1………1…1nW0…0………0…0︷nL.(8)B0=1…1………1…1nCW0…0………0…0nIW1…1………1…1nCW︷nL.In the expressions, one represents the covered pixel by the structuring element. Zero represents the un-covered pixel by the structuring element. A45, A90 or A135 is the result of the 45°, 90° or 135° rotation of A0, respectively. B45, B90 or B135 is the result of the 45°, 90° or 135° rotation of B0, respectively.Using structuring elements (A0, B0), the hit-or-miss transform detects linear features corresponding to direction 0° as follows. max represents the maximum operation.(9)HMT(A0,B0)(p)=max{(F⊖A0)(p)-(F⊕B⌣0)(p),0}.Similarly, the detected linear features corresponding to directions 45°, 90° and 135° are as follows:(10)HMT(A45,B45)(p)=max{(F⊖A45)(p)-(F⊕B⌣45)(p),0},(11)HMT(A90,B90)(p)=max{(F⊖A90)(p)-(F⊕B⌣90)(p),0},(12)HMT(A135,B135)(p)=max{(F⊖A135)(p)-(F⊕B⌣135)(p),0}.Combining the linear features of different directions would produce all of the possible linear features [2,17,23]. In this paper, we also use this method to combine the linear features of different directions. Then, the final result of the linear feature detection should be the combination of the results HMT0, HMT45, HMT90 and HMT135 at different directions (0°, 45°, 90° and 135°) as follows:(13)L=HMT(A0,B0)(p)+HMT(A45,B45)(p)+HMT(A90,B90)(p)+HMT(A135,B135)(p).Actually, linear features in images usually have different widths. One value of nIW will only extract linear features with width nIW. To extract all of the possible linear features with different widths, different scales of miss structuring elements B with different values of nIW should be used.Suppose n scales should be used. The pair of structuring elements corresponding to direction 0° at scale i (1⩽i⩽n) is denoted by (A0, B(i, 0)). In addition, the width of miss structuring elements B(i, 0), denoted by nIWi, is nIWi=2×i+1. Then, the detected linear features corresponding to direction 0° at scale i are expressed as follows.(14)HMT(A0,B(i,0))(p)=max{(F⊖A0)(p)-(F⊕B⌣(i,0))(p),0}.Similarly, the pairs of structuring elements corresponding to directions 45°, 90° and 135° at scale i (1⩽i⩽n) are denoted by (A45, B(i, 45)), (A90, B(i, 90)) and (A135, B(i, 135)), respectively. Then, the detected linear features corresponding to directions 45°, 90° and 135° at scale i are expressed as follows:(15)HMT(A45,B(i,45))(p)=max{(F⊖A45)(p)-(F⊕B⌣(i,45))(p),0},(16)HMT(A90,B(i,90))(p)=max{(F⊖A90)(p)-(F⊕B⌣(i,90))(p),0},(17)HMT(A135,B(i,135))(p)=max{(F⊖A135)(p)-(F⊕B⌣(i,135))(p),0},So, the final detected linear features at scale i, denoted by Li, are the combination of HMT(i, 0), HMT(i, 45), HMT(i, 90) and HMT(i, 135) as follows:(18)Li=HMT(A0,B(i,0))(p)+HMT(A45,B(i,45))(p)+HMT(A90,B(i,90))(p)+HMT(A135,B(i,135))(p).Linear features are usually bright or dark regions in an image. The hit-or-miss transform is used to extract bright regions. However, if the linear features are dark regions in an image, the linear features will be bright regions in the complementary of the original image. Then, the complementary of the original image could be used. Therefore, only bright linear features are considered in this paper. In this case, the detected linear features at different scales should be bright regions, which means the final result of the detected linear features at all scales should be the maximum value of the detected results of all of the scales for each pixel. Then, the final detected result L could be expressed as follows.(19)L=max(L1,L2,…,Ln).The implementation of the hit-or-miss transform using multi-scales of multi-structuring elements for linear feature detection is demonstrated in Fig. 3.After performing the hit-or-miss transform with multi-scales of multi-structuring elements, all of the pixels with grey values that are larger than zero should be the linear feature regions. However, because the linear feature regions usually have different widths or different grey distributions and some regions are very dim, the remaining linear feature regions may have some defects, such as breaking one linear feature into several parts and separating one linear feature into two linear features by isolating holes. To suppress these defects, a repairing step is used.A morphological dilation operation could dilate binary image regions [12]. Then, the dilation operation could be used to connect the broken regions. However, dilation may also connect some very close regions that belong to different linear feature regions. To avoid this situation, the morphological thin operation [12] is performed first before the dilation operation. Thin operation could maintain the shape and the length of the linear feature regions while shrinking the regions. Then, the following dilation operation connects broken regions while avoiding the combination of the neighbouring linear feature regions. Because the dilation operation is used to connect the broken regions, the used structuring element should be small. Usually, the structuring element could be a square with size one.Linear features are usually represented by lines with the width of a single pixel. After the repairing step, the detected linear features are binary linear feature regions. To obtain linear features represented by lines with the width of a single pixel, the morphological thin operation [12] is used. The final result of thin operation could effectively give the lines with the width of a single pixel.After thin operation, there may be some very small line segments in the result image. These small line segments usually correspond to the noise regions of the original image, and they should be removed. Because these small line segments have very small lengths, they could be easily removed by comparing their lengths with a threshold T. If the length of one line is smaller than T, the corresponding line should be removed. T is used to remove small lines, which should be a small value. In this paper, T=3. After this step, the final lines with the width of a single pixel represent the final detected linear features of the original image.

@&#CONCLUSIONS@&#
Linear feature detection is one of the crucial techniques in image processing. Because linear feature regions in an image are usually complicated, it is difficult to detect all of the linear features. To effectively detect all of the linear features in different types of images, a grey-level hit-or-miss transform based algorithm without thresholding is proposed to solve this problem. The hit-or-miss transform could be used to detect image regions with a similar shape to the shape of the structuring elements. Because of the constructed multi-structuring elements in the hit-or-miss transform, the proposed algorithm could detect linear features with different directions. Additionally, because of the multi-scale extension of the multi-structuring elements in the hit-or-miss transform, the proposed algorithm could detect linear features with different widths. Moreover, the detected linear features are refined by using several simple operations without thresholding, which gives the lines with the width of a single pixel. These lines represent the final detected linear features. Therefore, the proposed algorithm is simple and effective. Experimental results have been performed on different types of images, which verified that the proposed algorithm could effectively detect linear features with different widths, different grey distributions and noises. This is useful for different applications, such as defect detection in industry, insect morphology analysis, and length measurement.