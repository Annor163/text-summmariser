@&#MAIN-TITLE@&#
Bayesian reconstruction of projection reconstruction NMR (PR-NMR)

@&#HIGHLIGHTS@&#
We design a mathematical model for reconstructing multidimensional NMR spectra.We compare the performance of several statistical algorithms for PR-NMR.A generalized Monte Carlo algorithm is applied to restore the NMR spectra.

@&#KEYPHRASES@&#
Inverse problem,Projection reconstruction,Bayesian model selection,Reconstruction of multidimensional NMR spectra,Mixed linear model,

@&#ABSTRACT@&#
Projection reconstruction nuclear magnetic resonance (PR-NMR) is a technique for generating multidimensional NMR spectra. A small number of projections from lower-dimensional NMR spectra are used to reconstruct the multidimensional NMR spectra. In our previous work [1,2], it was shown that multidimensional NMR spectra are efficiently reconstructed using peak-by-peak based reversible jump Markov chain Monte Carlo (RJMCMC) algorithm. We propose an extended and generalized RJMCMC algorithm replacing a simple linear model with a linear mixed model to reconstruct close NMR spectra into true spectra. This statistical method generates samples in a Bayesian scheme. Our proposed algorithm is tested on a set of six projections derived from the three-dimensional 700MHz HNCO spectrum of a protein HasA.

@&#INTRODUCTION@&#
It is well known that the structures of molecules of interest are studied both by X-ray crystallography and by NMR spectroscopy. While X-ray crystallography works only in a solid state, NMR spectroscopy characterizes three-dimensional structures, dynamics and molecular interactions of molecules in a liquid state and even in a gas state. It is also known that multidimensional NMR spectroscopy is very useful for obtaining more accurate and precise structure of molecules. However, a serious limitation of multidimensional NMR spectroscopy is the long time required to record a set of multidimensional NMR experiments. The minimum measurement time of an N dimensional NMR experiment increases as the number of dimensions increases. This makes higher multidimensional NMR spectroscopy intractable in practice. For these reasons, several investigators have been attempting to speed up these measurements through more efficient approaches [3–7], which are traced back to the concept of accordion spectroscopy [8]. One of the recent approaches designed to address this problem is GFT-NMR by Kim and Szyperski [9]. GFT-NMR experiments detect sums of and differences in chemical shifts by linking the various evolution dimensions. Another approach, which is the main consideration of this paper, is projection reconstruction NMR (PR-NMR) by Freeman and Kupce [10–13]. To implement the reconstruction of multidimensional NMR spectra, we have investigated the use of several deterministic and statistical approaches [2,1,14]. Although deterministic algorithms including back projection and lowest value algorithms can reconstruct the spectra quickly, the reconstructed spectra are rather different from the underlying true spectra. Meanwhile, the statistical approaches based on a Bayesian scheme are relatively slow but provide reconstructions that are closer to the true spectra than those using deterministic approaches. In addition, there are two types of schemes for reconstructing spectra from projections: the pixel-by-pixel approach and peak-by-peak approach. In our previous papers [1,2,14], we demonstrated maximum likelihood (ML) reconstruction, maximum a posterior (MAP) [15,16] reconstruction and maximum entropy (ME) [17,18,3,19] reconstruction for pixel-by-pixel approach. We also showed that reversible jump Markov chain Monte Carlo (RJMCMC) reconstruction based on a peak-by-peak scheme can be designed with the simple linear model and work better than other approaches based on a pixel-by-pixel approach in that it reduces the complexity of the problem and speeds up the calculation.Although the previous RJMCMC algorithm with the simple linear model works effectively in particular PR-NMR experiments, we can still improve the methodology by carefully considering the noise of each projection. In practice, each projection is NMR spectra obtained from separate lower dimensional experiments meaning that each projection may have a different noise level. In this paper, an extended and generalized RJMCMC based algorithm is proposed to replace the simple linear model with the linear mixed model to explain such different noise levels per each projection.22These noises are regarded as random effect of the linear mixed model in this manuscript.As mentioned in the introduction, the serious limitation of the promising multidimensional NMR spectroscopy is the long minimum measurement time, which increases as the number of dimensions increases. This makes higher multidimensional NMR spectroscopy impracticable. For example, suppose that n time points are sampled in each evolution period for a d-dimensional NMR experiment. In this case, the total experimental time is determined by the number of time points (n), the number of scans (Na), the number of dimensions (d), and the duration of each scan, typically about one second [20]. The minimum experimental time of the phase sensitive d-dimensional NMR experiment increases exponentially with the dimension as the dimension increases so therefore it is proportional to∝nd. Therefore, several investigators have been attempting to speed up these measurements by more efficient approaches [3–7], which are traced back to the concept of accordion spectroscopy [8]. One of the recent approaches to address the measurement time problem is projection reconstruction NMR (PR-NMR) by Freeman and Kupce [10–13]. The PR-NMR reconstructs multidimensional NMR spectra by using relatively lower dimensional NMR spectra quickly. Apart from Kupce and Freeman, several other groups have contributed to the PR-NMR and its related topics [21–25].An N-D experiment involvesN−1evolution periods and 1 acquisition period. For example, there exist two consecutive evolution periods (t1 and t2) for a 3-D experiment. In NMR spectroscopy, a signal that evolves at a chemical shiftΩAin t1 modulates the signal in the second evolution period t2. Thus, it can be regarded as an inter-modulation of the chemical shiftsΩAandΩBof the two dimensions. In other words, signals that evolve atΩAduring t1 pass on a componentcosΩAorsinΩAto the next evolution period. Therefore, the signal obtained in the acquisition period(t3)is modulated as one of the following:S1=cos(ΩAt1)cos(ΩBt2)S2=sin(ΩAt1)sin(ΩBt2)S3=sin(ΩAt1)cos(ΩBt2)S4=cos(ΩAt1)sin(ΩBt2).The inter-modulation creates a cross-peak in a two dimensional frequency domainF1F2plane at co-ordinates(ΩA,ΩB).Projection reconstruction NMR (PR-NMR) is based on the inter-modulation of chemical shifts. The basic idea of PR-NMR is to increase the evolution times t1 and t2 jointly at relative rates in order to generate a projection of the spectra onto a plane inclined at a proper angle. If t1 and t2 are set totcosαandtsinαrespectively for a 3D experiment, then we have combined the terms of the modulations for hyper-complex Fourier transformation:Re1=S1−S2=cos[(ΩAcosα+ΩBsinα)t]Re2=S1+S2=cos[(ΩAcosα−ΩBsinα)t]Im1=S3+S4=sin[(ΩAcosα+ΩBsinα)t]Im2=S3−S4=sin[(ΩAcosα−ΩBsinα)t].It can be observed from the above equations that the projections always occur in pairs tilted at±α.In many application domains, linear models are often used for modeling the relationship between a response variable y and predictor variables,x1,…,xp. The relationship can be modeled with a linearly parametrized function as follows:y=β0+β1x1+β2x2+⋯+βpxp+ϵwhere the coefficient βi(fixed effect) fori=0,1,2,…,pis unknown and ϵ is the error term. Using the matrix representation for the n different observations, the regression equation for the above example can be written asY=XA+ϵwhereY=(y1,y2,…,yn)T,A=(β0,β1,…,βp)T,ϵ=(ϵ0,ϵ1,…,ϵn)Tand the matrixXis formed byX=[1x1(1)x2(1)⋯xp(1)1x1(2)x2(2)⋯xp(2)⋮⋮⋮⋱⋮1x1(n)x2(n)⋯xp(n)].However, some parameters among predictor variables can have random effects under uncertainty and such a simple linear model with fixed effects cannot explain the parameters well. The linear mixed model (LMM) is a statistical model containing both fixed and random effects to address this problem. The common form of the LMM is(1)Y=XA+ZB+ϵwhereZis the design matrix for the random effects relating observations andBis a vector of the coefficients of random effect variables.Reversible jump Markov chain Monte Carlo (RJMCMC) has been a popular method for addressing model selection problems [26] in many applications such as image processing [27,28] and nuclear spectroscopy [29]. RJMCMC enables Markov chains to move in between different dimensions of parameters. This can be used to infer the joint distribution of two types of parameters, a model indicator k and a parameter vectorxk. This is described as inferringp(k,xk|y), whereyis observed information. The conventional MCMC mentioned cannot solve this problem since it is not straightforward in comparing the densities of objects in different dimensions. The reversible jump MCMC, suggested by [30], samples over a union space on the different dimensions of parameter spaces by applying the dimension matching procedures in a generalized MCMC framework.Reconstruction of multidimensional NMR spectra from a small number of projections can be achieved using two strategies: pixel-by-pixel modeling [14,2] and peak-by-peak modeling [1,2]. While pixel-by-pixel modeling determines all pixels on an image individually in terms of the given projections, the peak-by-peak approach reconstructs an image using a finite collection of specific peak shapes. Even though the peak-by-peak model is an idealization of reality, it is a very reasonable assumption since the NMR peak shape can be well approximated as a specific shape such as Gaussian or Lorentzian. In the peak-by-peak approach, each peak consists of a center position, amplitude, and peak-width. Peak-by-peak estimation can be more efficient since it models explicitly the sparseness inherent in the NMR spectra. Thus, in the peak-by-peak approach, we do not have to directly update all areas of the image as would be required in the pixel-by-pixel approach. Another interpretation is that a solution can rapidly be obtained since the number of parameters for peak-by-peak estimation is much smaller than that for pixel-by-pixel. Here, then, we define the underlying image model at pixel locationxwith a finite collection of peaks,(2)s(x)=∑k=1KAkN(x;mk,σ2I)wheres(x)is the intensity at the image positionx,N(·;a,b)denotes multivariate(/univariate) normal distribution with mean a and covariance b andx=[x1,x2,…,xd]T,mk=[mk,1,mk,2,…,mk,d]Twhere d is the dimension of the evolutionary periods of the reconstructed NMR spectra. In this paper, we simply used d=2 because we are reconstructing 3D NMR spectra. In Eq. (2), Akis the amplitude of the k-th peak. We use the Gaussian shape, which has two components:mkfor the center position and σ for peak width, as shown in Eq. (2). Two or more individual widths of the peaks may provide more accurate reconstruction than a single line width but we use a single width for our approach for two reasons. First, considering only a single width reduces time complexity in estimation; therefore, this can speed up our proposed approach. Second, we can reconstruct any shape of peaks only with such a single line width. That is, our proposed approach is based on a few assumptions. One is that the shape of the peak is considered as a Gaussian shape function. The other assumption is that a single line width can be used to approximate all peaks. Of course, our proposed algorithm may not perform well if the assumptions are not correct. Therefore, we simulate additional experiments to verify the assumptions used in this paper before applying these to real experimental NMR data.First, our proposed approach uses a Gaussian shape function to design the peak profile in this paper although other line shape functions such as Lorentzian and Laplacian can also be effectively used. However, in fact, it is known that none of these correctly represents the underlying actual spectral line shape, which is defined by the decay rate of the time signal and appodization function. Fig. 1demonstrates a comparison between actual non-Gaussian synthetic spectra and their reconstructed shape using the Gaussian shape function of the Eq. (2). The solid lines of Fig. 1(a) and (c) are the spectra with a single Laplacian shaped peak and the dashed lines of the subfigures are the reconstructed spectra with a Gaussian shaped function. As can be seen in the subfigures, the reconstructed spectra with 10 Gaussian components (K=10) are much closer to the actual Laplacian shape than one with a Gaussian component (K=1). In a way similar to Laplacian, the spectra with Lorentzian shaped peaks can also be well approximated using only Gaussian shaped functions as shown in Fig. 1(b) and (d).To validate the other assumption, we generate a synthetic spectra with two Gaussian shaped peaks that have different amplitudes and widths as shown in Fig. 2. The left peak of the synthetic spectra is constructed with the location parameterμ1=30and shape/width parameterσ1=3and the right peak withμ2=80andσ2=5. With a fixed widthσ=3, the spectra are reconstructed varying the number of Gaussian components. The dashed line of Fig. 2(a) shows the reconstructed spectra with K=2 and that of Fig. 2(b) demonstrates the reconstructed spectra with K=10. As can be seen in this Fig. 2(a), the right peak, with a different width, is not properly reconstructed even in the Gaussian case because of the different width of the peak. However, both peaks are closely approximated to the actual spectra only with a single width Gaussian when 10 Gaussians (K=10) with a common single width are used to compose the spectra. That is, as K increases, such differences or errors from different shapes or different widths are significantly reduced, as shown in Fig. 1(b) and (d) and Fig. 2(b). Eventually, we can model real NMR peaks with various shapes by composing Gaussian shaped components that have a single width.In PR-NMR, input data are a small number of projections obtained at different projection angles. Suppose thatyis the projection data. λiand l stand for the i-th projection angle and the sample index into a projection, respectively,i=1,…,|Λ|. The PR-NMR data is then defined as(3)yl(i)=Rs(λi,l)+ϵiwhereyl(i)is the l-th data-point of the i-th projection taken at angle λiandRs(λi,l)is the projection function for the i-th angle λiand data point. Suppose that the number of data points in each projection is Nsand the number of peaks is K. Eq. (3) can be written in the linear model framework using vector notation as follows:(4)Y=XA+ewhereA=A1:Kande~N(e;0,σe2I). While we assumed σeto be known in our previous work [1], we estimate it in this paper.Yis the stacked vector of projection data, defined asY=[y1(1),…,yNs(1),…,y1(|Λ|),…,yNs(|Λ|)]T.Xdenotes the integrated peaks obtained by substituting Eq. (2) in terms of angles λ,A=A1:K=[A1,A2,…,AK]Tis a vector of peak amplitudes, andeis a noise vector. When we have|Λ|projections,Xis a matrix with size(Ns|Λ|)×KandA1:Kis aK×1vector. The size of vectorsYandeis(Ns|Λ|).For example, suppose that we have|Λ|=6projections withNs=512points. If the sampled or given spectra have K=5 peaks, as shown in Fig. 3(a), then we obtain its correspondingX, from Fig. 3(b). Since there are 5 peaks in the image and each projection has 512 points, the number of columns is 5 and the number of rows is6×512=3072. In Fig. 3(b), the area “(4, 3)” denotes the 4th projection of an image with only the 3rd peak.Although the simple linear model of the previous section works effectively in certain PR-NMR experiments [1], we can still improve the methodology by carefully considering the noise from each projection. In practice, each projection is NMR spectra obtained from separate lower dimensional experiments meaning each projection may have a different noise level. In order to subtract the noise from the spectra, we need to understand the noise. In general, there are two different types of noise: projection noise and full plane noise. In each experiment (of lower dimensional NMR spectra), a certain amount of noise can be added into all projected spectra with varianceσμ2. We refer to this noise as projection noise for a particular projection. Full plane noise is the other type of noise that is randomly added in a particular location of the spectra. In PR-NMR, only projection noise may be considered by settingσe=0. However, we added the “full plane noise” in order to indirectly consider the noise reduction of the reconstructed spectra rather than projected spectra. Such a denoising scheme for the full plane spectra is commonly applied even in one or two dimensional NMR processing [31]. We show the existence of both types of noise from Tables 1 and 2in Section 5. We now map these two noises to the statistical terms that are commonly used in the linear mixed model. The projection noise is regarded as a projection-specific random effect and the full plane noise is interpreted as a fixed effect in the linear mixed model. By carefully separating noise in the linear mixed model, we can expect better and well reconstructed multidimensional NMR spectra. Now our linear mixed model is defined as(5)Y=XA+ZB+e,whereAandBrepresent fixed and random effects respectively. To subtract the projection noise in each projection, we modelZ=[g(1)0Ns×10Ns×1⋯0Ns×10Ns×1g(2)0Ns×1⋯0Ns×1⋮⋮⋮⋱⋮0Ns×10Ns×10Ns×1⋯g(|Λ|)]andB=[b1,b2,…,b|Λ|]T~N(0,σμ2I), whereg(i)is a projection noise pattern in the ith projection with Nsdata points and0Ns×1is anNs×1zeros vector. In this model, findinggmay not be straightforward since there is no known pattern for projection noise in a generalized form. One of the simple ways to determine the pattern of each projection is to use a low-pass filter, such as average filter or Gaussian filter, that passes slowly changing regions or signals and reduces or removes the amplitude of signals from quickly changing regions in the projection. For simplicity, we assume that there exists a constant amount of noise in each projection, and then we say that the expectations of the projection noise are scaled with varianceσμ2for all projections as shown in Fig. 4(a). Therefore, we simply defineg(i)=1Ns×1for alli∈{1,2,…,|Λ|}. To subtract such projection noise for each projection of PR-NMR, we modelZagain as follows:(6)Z=I|Λ|×|Λ|⊗1Ns×1where ⊗ stands for the Kronecker product and1Ns×1is aNs×1ones vector. The termYin the linear mixed model is the same as that in simple linear model.XandAof the linear mixed model are also built with a similar structure to the previous simple linear model. Therefore, the linear mixed model reduces to a simple linear model when the random effect becomes zero. From this point of view, the linear mixed model is a sort of generalization of the linear model but has a richer structure to explain the data. Note that we can still represent such a richer linear mixed model with a simple linear model by only changing the structure of covariance as follows:(7)Y=XA+e^,wheree^~N(e^;0,σμ2ZZT+σe2I). Therefore, we have a unified and simplified form for both models by(8)Y=XA+ϵϵ~N(ϵ;0,Σ),whereΣ={σe2Iifitisasimplelinearmodelσμ2ZZT+σe2IifitisaLinearMixedModel.Since the peak-by-peak approach presents a computational challenge in that the number of peaks is not known a priori, trans-dimensional methods were applied in order to estimate the number of peaks in our previous paper [1]. Reversible jump Markov chain Monte Carlo (RJMCMC) is used to approach the trans-dimensional problems.Use ηkto denote the parameter vector associated with the peak profiles indexed byk∈{1,2,…,K}. Then, for K peaks we have a set of hidden variables as follows:(9)η1:K=(m1:K,A1:K,σ,σe,σμ)wherem1:K=(m1,1:K,m2,1:K,…,md,1:K). With this specific scheme, our target posterior of interest is written asp(K,η1:K|Y), where K is also a random variable for the number of peaks. Interestingly, some hidden parameters amongη1:Kcan be regarded as nuisance parameters that we do not need to estimate until they are required. For instance, the amplitudes of the peaksA1:Kcan be removed with the linear Gaussian assumption as shown in Eqs. (10) and (13). We can also estimate σeandσμvia the maximum likelihood (ML) technique rather than by the RJMCMC scheme to obtain stable results within a practical time as well as to speed up the simulation by reducing the searching space in RJMCMC. We have now three types of hidden parameters:1.{m1:K,σ}: These are the main parameters of interest for the peak profile that we want to estimate and reconstruct. They are estimated using the RJMCMC technique, and since only these parameters are of interest for the RJMCMC procedure, we rename these parametersθ1:K, i.e.θ1:K={m1:K,σ}.A1:K: This parameter is an element of peaks׳ profile but we separately classify this parameter from other profiles of the peaks,θ1:K.σeandσμ: For stable and fast estimation, we infer these parameters by using the maximum likelihood scheme rather than the RJMCMC scheme.After drawing a sample onθ1:Kand K via RJMCMC in each time step, we then estimate the σeandσμvia the maximum likelihood (ML) approach and maximum a posteriori (MAP) approach:(12)σ^e,σ^μ=argσe,σμmaxlogp(Y|X,σe,σμ)byMLestimateorσ^e,σ^μ=argσe,σμmaxlogp(σe,σμ|Y,X)byMAPestimate.For an MAP estimate, we set up the prior of σe2 andσμ2by inverse Gamma distribution:σe2~IG(σe2;α,β)andσμ2~IG(σμ2;α,β)whereα=3andβ=6. We recursively run RJMCMC for the profiles of the peakθ1:Kand ML/MAP for standard deviations of noises σeandσμ.With such a unified and simplified form represented by Eq. (8), we use the following marginalized likelihood for both the simple linear model and the linear mixed model. The marginalized likelihood is obtained by integrating out the amplitude parameters by assuming that the amplitudes follow normal distribution as follows:(13)p(Y|X,σe,σμ)=∫p(Y|X,A,σe,σμ)p(A|σe,σμ)dA=exp{−12[YTΣ−1Y+μAT1K×1TC−11K×1μA−HTΦ−1H]}|2πΣ|1/2|2πC|1/2|2πΦ|1/2whereΦ=XTΣ−1X+C−1H=XTΣ−1Y+C−1(μA1K×1).andΣis obtained from Eq. (8) andC=diag(CA,…,CA)of Eq. (11).Both RJMCMC forp(K,θ|Y,σe,σμ)and ML for σeandσμrecursively run until convergence. More details for the algorithms are described below:•Update the profiles of peaks via RJMCMC. This step of the proposed algorithm is very similar to that of our previous approach where the details of the algorithms of RJMCMC for PR-NMR are described [1]. The difference is the replacement of the simple linear model with the linear mixed model resulting in a richer covariance than with the previous approach. The updated covariance of each sample is used to build the likelihoodp(Y|θ1:K,σe,σμ)=p(Y|X,σe,σμ).1.Propose a type of move from ‘Birth’, ‘Death’, ‘Split’, ‘Merge’ and ‘Dimension invariant’.If the move type is dimension invariant, RJMCMC draws samples over parameters using a standard Metropolis-Hastings (MH) algorithm, so that each unknown parameter is updated according to an acceptance probability:(14)αK|K=min{1,p(Y|θ1:K′,σe,σμ)p(θ1:K′|K)q(θ1:K;θ1:K′)p(Y|θ1:K,σe,σμ)p(θ1:K|K)q(θ1:K′;θ1:K)}whereθ1:K′andθ1:Kare profiles of the peaks of new and previous samples respectively.If the move type is dimension variant such as ‘Birth’, ‘Death’, ‘Split’ and ‘Merge’, then RJMCMC draws samples over parameters using a Metropolis-Hastings (MH) algorithm in RJMCMC scheme, so that each unknown parameter is updated according to an acceptance probability:(15)αK′|K=min{1,p(Y|θ1:K′′,σe,σμ)p(θ1:K′|K′)q(K;K′)q(θ1:K;θ1:K′′)p(Y|θ1:K,σe,σμ)p(θ1:K|K)q(K′;K)q(θ1:K′′;θ1:K)}whereK′and K are the number of the peaks of the new and previous samples respectively. Note that Green׳s Jacobian terms for dimension matching are not required in our algorithm.Estimate σeandσμvia ML/MAP1.Estimate σeandσμvia ML:σ^e,σ^μ=argσe,σμmaxlogp(Y|X,σe,σμ)or MAP:σ^e,σ^μ=argσe,σμmaxlogp(σe,σμ|Y,X).Recursively update the profiles (via RJMCMC) and standard deviations of the noises σeandσμ(via ML/MAP) until convergence.Fig. 4(a) shows the projections of 13C15N correlation peaks in the 700MHz HNCO spectrum of the protein HasA.This is the observed datasetY. Figs. 4(b) and 6(a) show a contour image and its segmented binary image of a desired target map, respectively. The binary image is obtained by a simple single thresholding segmentation technique onto the ground truth spectra. The F1F2 plane is extracted from a full three-dimensional HNCO experiment on HasA, performed using the conventional method where both evolution times are incremented independently. The 16 peaks include a doublet and very weak peaks, as shown in Fig. 4(b). Now, our task here is to reconstruct the underlying multidimensional spectra of Fig. 4(b) from the six lower dimensional projected spectra of Fig. 4(a) by using several deterministic and statistical approaches. Given this dataset, we have checked the characteristics of the dataset before applying the reconstruction approach to verify the assumption that each projection can have different amplitudes in scale. Thus, we summed all values of spectra in each projection to check whether the spectra are scaled up or down at the rate ρifor the i-th projection. As shown in Table 1, the summed values for 0° are rather different from others so this proves that each projection has a differently scaled amplitude for each projection. For a stable estimation, we re-scaled the i-th projection by1/ρi. In addition, another interesting factor to characterize the data is the noise level. The noise level of each projection can be different with varying projection angles although the projections are made from the same 3D HNCO spectra. Table 1 also shows that noise levels vary in terms of the projection angles. In particular, there is huge noise at a 90° projection. In the table,E(ϵ)andV(ϵ)indicate the mean and standard deviation of noise level ϵ, respectively.Before demonstrating the performance of our proposed linear mixed model approach, we tested sensitivity of the selection of model parameters such as σein our previous simple linear model [1]. We call this modelLinearσe=τfor any real positive value τ. In order to obtain the optimal value of σeforLinearσe, we applied several metrics to the reconstructed spectra with varying σeas shown in Table 2.Table 2 shows that theLinearσehas the best outputs betweenσe=5andσe=15. In the view of RMSE,Linearσeperforms well atσe=15whileLinearσeperforms well atσe=5in the view of KLD. Therefore, we select the central valueσe=10to represent it.The following figures include multidimensional spectra reconstructed usingLinearσe=0.1,Linearσe=10andLinearσe=30.As can be seen in Fig. 5, the best result is obviously obtained from the second approach of Fig. 5(c), but note that we have to carefully and manually set the model parameters σeat 10 in this approach.However, in general, we do not know the standard deviation of the noise; if we under-estimate it by 0.1 as in Fig. 5(b) or over-estimate it by 30 as in Fig. 5(d), the restored spectra are rather different from the desired spectra. In the case of the under-estimation of σe, we obtain unwanted peaks, which are simply denoted as “false alarm”. Thus, it is difficult to distinguish the real peaks from the false alarms since noises are considered as signals and the filtering technique fails. When we use an over-estimation of σeas in Fig. 5(d), we lose many weak but desired peaks in the reconstructed spectra. For these reasons, it is very crucial to obtain a precise and accurate σein the simple linear model. We therefore need to address this problem by automatically estimating σevia ML or MAP in the simple linear model: these improved versions are named asLinearML, andLinearMAPfor the ML and MAP estimates of σe, respectively.However, LinearML, and LinearMAPmay not be sufficient for obtaining spectra close to the underlying target map if lower dimensional spectra are independently corrupted by unwanted noise. Owing to such complicated models and datasets, we generalize the linear model to linear mixed model with fixed effect. In this paper, we name this generalized model MixedMLand MixedMAPwith ML and MAP estimates for the hidden parameters respectively. In order to observe the performance of RJMCMC based on our proposed linear mixed model, we have compared several approaches categorized as either pixel-by-pixel or peak-by-peak.•Pixel-by-pixel approach: LetR,yandMbe the unknown multidimensional spectra of the desired target map, given lower dimensional projections and an assumed model respectively.1.LV (Lowest value): The lowest intensity is retained from corresponding locations in projections to infer each pixel valueRof the target map.ABP (Adaptive back-projection): This restores a spectra from a set of measured projections via a well-known inverse Radon transform technique [32].ML (Maximum likelihood): This seeks an optimalR^to maximize the likelihoodp(y|R,M)[16,2]. Since ML is a non-Bayesian (Frequentist) approach, we can modify this problem into maximum a posteriori (MAP) approach by maximizing the posteriorp(R|y,M)in a Bayesian framework [33]. However, we do not have any known prior information aboutR, so we simulate only ML estimation for performance evaluation in this paper.ME (Maximum entropy): This reconstructs a desired spectraRby maximizing the entropy with a Lagrange multiplier [34,35]. Nowadays, it is common to use maximum entropy as a prior knowledge in Bayesian statistics, but we do not use ME for the prior in this paper. In addition, maximum entropy reconstruction algorithms are very popular in multidimensional NMR domains. However, this is rather different from our problem since the conventional maximum entropy reconstruction algorithms are considering sub-sampling with sparse sampling strategies rather than projection space. From this point of view we cannot use recent ME reconstruction algorithms developed by several researchers because of their different data characteristics for PR-NMR [3,19]. More details on other types of sub-sampled NMR datasets are described in [36,37].Peak-by-peak approach: All RJMCMC algorithms are based on the peak-by-peak approach and they infer (θ1:K,K)[and optionally(σe,σμ)].1.Linearσe: this uses a simple linear model with fixed σe(e.g.σe=0.1,σe=10, and σe=30).LinearML: this uses a simple linear model but σeis updated in each sample of RJMCMC followed by an ML approach.MixedML: this uses a linear mixed model to build likelihood and both σeandσμare updated in each sample of RJMCMC followed by an ML approach. Since the first and second derivatives are not explicitly defined, we use a quasi-Newton method to obtainσ^eandσ^μ.LinearMAP: this uses a simple linear model but σeis updated in each sample of RJMCMC followed by an MAP approach.MixedMAP: this uses a linear mixed model to obtain likelihood and both σeandσμare updated in each sample of RJMCMC followed by an MAP approach.Fig. 6shows the reconstructed spectra by several pixel-by-pixel (b–e) and peak-by-peak (f–i) approaches referred to above. In particular, all RJMCMC reconstruction algorithms including our proposed approaches are peak-by-peak approaches and the sub-images are the averaged reconstructed spectra after burn-ins from the four different approaches. In order to estimate the number and profiles of peaks, the four variants of RJMCMC techniques are also compared with other pixel-by-pixel approaches and we generate in total 6000 samples including 3000 burn-in periods. As can be seen in the figures, many false ridges exist in most pixel-by-pixel approaches (including LV, ABP, and ML) except ME. Interestingly, in ME reconstruction strong signals are enhanced but low signals are suppressed in the reconstructed multidimensional spectra. The likelihoods of Fig. 6(g) and (i) are designed with the linear mixed model to explain the projection noise for each projection. The model parameters σeandσμare recursively calculated whenever RJMCMC draws samples.Table 3demonstrates the performance comparison with several popular metrics: root mean square error (RMSE), Kullback Leibler distance (KLD), peak signal-to-noise ratio (PSNR), structural similarity (SSIM) and area under curve (AUC). See the appendix for more details on the metrics used. Mixed model based approaches have smaller RMSEs and KLDs and higher SSIMs and AUCs compared with other algorithms except PSNR. Here, maximum entropy appears to have the best result in PSNR because the strong signals are enhanced and the effects of the enhanced signals are larger than the side-effects of the suppressed signals. Therefore, mixed model based approaches (MixedMLand MixedMAP) infer closer and more accurate multidimensional spectra. The area under curve (AUC) is calculated from the receiver operating characteristic (ROC), shown in sub-graph 7(a). The ROC is obtained by comparing two segmented binary spectra. One binary spectra is obtained by applying a single thresholding technique into a desired spectra of Fig. 6(a) and the other binary spectra is obtained by increasing a single threshold from 0 to 1 to segment the restored spectra. Performance from the best to worst showsMixedMAP−MixedML−LinearML−LinearMAP−(LV,ML,ME)−ABP. In order to view the details of the ROC, the dilated sub-graph is displayed in Fig. 7(b). In this plot, the sensitivity of ME reconstruction algorithm sharply increases but it falls to about 0.8 after FPR=0.01. This indicates that ME reconstruction finds a few strong peaks well in the low threshold but that it fails to uncover weak signals as the threshold increases.Fig. 8 shows the analysis of the samples of variants of RJMCMC reconstruction algorithms: (a) acceptance ratio, (b) trajectories of the number of peaks, (c) the distribution of the number of sampled peaks and (d) the convergence diagnostics. Interestingly, theMixedMAPhas a lower acceptance ratio after burn-ins whileMixedMLhas a higher acceptance ratio in the burn-ins period as shown in Fig. 8(a). In addition,MixedMAPhas a relatively lower acceptance ratio throughout the whole period except at the beginning from 1 to 100. This suggests thatMixedMAPgenerates well-mixed samples from the beginning and that it can speed up the RJMCMC algorithm to build target density. Fig. 8(b) shows the trajectories of the number of peaks for four RJMCMC algorithms. After the burn-in period, the number of peaks inLinearMLandMixedMLconverges to around 25 while those inLinearMAPandMixedMAPconverges to about 40. An alternative view concerning the number of peaks is the histogram/distribution of the number of peaks in Fig. 8(c), and the MAP approach has a set of samples with more peaks than the ML approach. Additionally the mixed model has more peaks than the linear model.Fig. 8(d) plots the convergence diagnostics by using the potential scale reduction factor (PSRF) statistic for the peak׳s width σ[38].33Convergence is asserted provided all the PSRF values fall below 1.2, a value that is known to work well in practice [38]. If this criterion is not satisfied for all estimands, then it is indicative of a lack of convergence and the simulation run needs to be lengthened.All four variants of RJMCMC techniques pass the convergence checking.

@&#CONCLUSIONS@&#
