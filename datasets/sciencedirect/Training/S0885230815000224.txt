@&#MAIN-TITLE@&#
Subspace-based DOA with linear phase approximation and frequency bin selection preprocessing for interactive robots in noisy environments

@&#HIGHLIGHTS@&#
Two DOA preprocesses, that are called linear phase approximation and frequency bin selection, are proposed.The proposed DOA methods can estimate the direction of a signal in a noisy environment.The developed system can be used in interactive robots for improving the performance of DOA estimation.The proposed method outperforms the conventional DOA methods, which are called MUSIC and MVDR methods.

@&#KEYPHRASES@&#
Sound source location,Direction of arrival (DOA),Angular correction,Linear phase approximation,Covariance matrix reconstruction,Frequency bin selection,Interactive robot,Human–robot interaction,

@&#ABSTRACT@&#
This work develops a method of estimating subspace-based direction of arrival (DOA) that uses two proposed preprocesses. The method can be used in applications that involve interactive robots to calculate the direction to a noise-contaminated signal in noisy environments. The proposed method can be divided into two parts, which are linear phase approximation and frequency bin selection. Linear phase approximation rectifies the phases of the two-channel signals that are affected by noise, and reconstructs the covariance matrix of the received signals according to the compensative phases using phase line regression. To increase the accuracy of DOA result, a method of frequency bin selection that is based on eigenvalue decomposition (EVD) is utilized to detect and filter out the noisy frequency bins of the microphone signals. The proposed techniques are adopted in a method of subspace-based DOA estimation that is called multiple signal classification (MUSIC). Experimental results reveal that the mean estimation error obtained using proposed method can be reduced by 7.61° from the conventional MUSIC method. The proposed method is compared with the covariance-based DOA method that is called the minimum variance distortionless response (MVDR). The DOA improves the mean estimation accuracy by 4.98° relative to the conventional MVDR method. The experimental results demonstrate that both subspace-based and covariance-based DOA algorithms with the proposed preprocessing method outperform the DOA estimation in detecting the direction of signal in a noisy environment.

@&#INTRODUCTION@&#
The objective of a sound source location system is to determine the direction of a sound source using the DOA algorithm. The DOA algorithm finds the coherence of received signals using a correlation matrix, and calculates the angle of the sound source from a restrictive space. Much great deal of research has been done on sound source location, and especially speech source location in several scenarios and applications, such as human–robot interaction, human–computer interaction, surveillance systems, audio–visual conferencing, and speech recognition (Chen et al., 2008; Mestre and Lagunas, 2008; Togami et al., 2009; Pirinen et al., 2003; Xiao et al., 2004; Caylar, 2009; Liu and Chen, 2010; Li, 2005; Wang et al., 2010; Hwang and Sarkar, 2005). For DOA methods, a conventional beamformer (Krishnaveni et al., 2013; Mestre and Lagunas, 2006) utilizes a linear array of equally spaced sensors to receive sound, and coherently sum the outputs of the distributed sensors using weight vectors. The weight vectors contain information about the time delay that is associated with path length variation. Maximum likelihood (ML) methods (Li et al., 1995; Swindlehurst, 1998) have been developed to exploit DOA estimation when the narrow-band plane waves of the received signals are already known.Much of the literature reveals that a noisy ambient environment worsens the performance of a sound source location system. Ambient noise is a signal that can influence the components of the covariance matrix of collected signals, resulting in phase distortion in the frequency domain. Phase distortion can generate an estimation error in the analysis of the direction of a sound. Over the past few decades many methods that involve beamscan algorithms and subspace algorithms have been developed to mitigate the effect of noise in DOA (Cho et al., 2008, 2010; Wang et al., 2006; Yang et al., 2008; Wang and You, 2008; Hioka et al., 2003; Tanigawa and Hamada, 2003).Cho et al. (2008, 2010) proposed a distributed microphone system that was composed of 16 microphones to locate a sound source position using the accumulated correlation coefficient between the multiple channel pairs. The experimental results indicate that the position of the sound can be calculated by cross-power spectrum phase (CSP) analysis. Wang et al. (2006) presented a new beamforming DOA using two virtual subarrays. The presented method yields a phase-shifted reference signal whose phase relative to the reference signal is a function of the target DOA. Yang et al. (2008) proposed the least square-based (LS-based) phase estimation method for preprocessing in the multiple signal classification (MUSIC) algorithm to find information about the direction to the speech source. The experimental results, based on computer simulation, reveal the accuracy of the estimated DOA of test speech. Wang and You (2008) presented a wideband beam-space preprocessing method, in which a rotational signal subspace (RSS) algorithm is utilized to obtain the effective data on reference frequency bins. In the computer simulations, a linear array with 20 sensors is used to receive the wideband signal (such as Gaussian white noise), and then to evaluate the beam-space covariance matrix for use in the DOA algorithm. Hamada et al. (Hioka et al., 2003; Tanigawa and Hamada, 2003) introduced a two-channel method for estimating DOA using virtually generated multichannel data; their method was based on the harmonic structure of vowels. Their simulation results demonstrated that the proposed method was suitable for sound localization in noisy environments.To increase the interaction between human beings and robots, DOA methods also have been adopted in the application of interactive robots in recent years. The interactive robot using DOA technique can compute the position of user and then give feedbacks such as communication, message, and personal information to the user. Therefore, how to reduce the noise interference on DOA estimation for robot interaction becomes more noteworthy. Reviewing the previous DOA methods (Cho et al., 2008, 2010; Wang et al., 2006; Yang et al., 2008; Wang and You, 2008; Hioka et al., 2003; Tanigawa and Hamada, 2003), the main contribution of the methods is to reduce the influences of ambient noises or room reverberations. However, there are several additional aspects should be considered for the application of interactive robots. The first one is the geometry of microphone array for interactive robots. Cho et al. (2008, 2010) installed 16 microphones in a 4×4 lattice condition, and the distance between the microphones was 135cm. This size of microphone array does not suitable for interactive robots. The second one is the number of microphones that are used in a microphone array. The microphone array using more microphones can achieve better performance on estimating the direction of a target sound source (Cho et al., 2008, 2010; Wang and You, 2008). Nevertheless, for the application of interactive robots, it is another consideration that how to select a suitable microphone array and avoid the high dimensional matrix operation from the microphone signals. The third one is the restricted condition for test voices such as harmonic structure of vowel signals (Hioka et al., 2003; Tanigawa and Hamada, 2003). Hamada et al. only used the vowel voice “a” to illustrate the DOA performance in experimental results; it is not enough to demonstrate the flexibility of DOA method in noisy environments. The final one is experimental evaluation; the type of evaluation can be classified as computer simulation (Wang et al., 2006; Yang et al., 2008; Wang and You, 2008) and practical evaluation (Cho et al., 2008, 2010; Hioka et al., 2003; Tanigawa and Hamada, 2003). To confirm the feasibility of the DOA method, this work tends to actualize a DOA estimation that can be really adopted in practical environments.Integrating the above-mentioned DOA methods and the aspects for applications of interactive robots, this work presents a DOA method for interactive robots to estimate the direction of a source signal in noisy environments. The proposed method has following four properties: Appropriate size of a microphone array for interactive robots, lower-dimensional matrix operation, flexible DOA method for source signals, and practical evaluation for noisy environments. In the DOA method, two DOA preprocessing techniques, called linear phase approximation and frequency bin selection, are applied. The linear phase approximation can rectify the distorted phase by iterative regression. To increase the accuracy of DOA estimation, a subspace-based signal-to-noise ratio (SNR) calculation is utilized to identify and filter out the noisy frequency bin in frequency bin selection. After the proposed preprocessing techniques are applied, the compensated covariance matrix of the desired signals can be utilized in the estimation of DOA. The performance of subspace-based DOA estimation is experimentally compared with two conventional DOA estimations and the proposed method is found to be suited to estimating the direction of signal in noisy environments. This work provides another feasible method for DOA estimation in real noisy environments.The rest of this paper is organized as follows. Section 2 presents an overview of the proposed system for estimation DOA. Section 3 then describes in detail the proposed DOA system and the preprocessing method. Section 4 considers the experimental results. Section 5 briefly draws conclusions.Fig. 1displays the overview of the proposed system. Firstly, a uniform linear array of a pair of microphones is used to collect a sound, which is indicated as source signal in Fig. 1 and the following description. In the linear phase approximation preprocessing, the covariance matrix of the observed signals is firstly estimated to obtain noise-contaminated phase data. Subsequently, the regression procedure is developed to rectify the distorted phase data of the observed signals. In covariance matrix reconstruction, the covariance matrix of the signals is reconstructed using the improved compensative phase data.Following the linear phase approximation, an eigenvalue decomposition (EVD) is performed to decompose the reconstructed covariance matrix at the beginning of frequency bin selection. In subspace-based DOA estimation, the EVD is adopted to decompose the covariance matrix into the source subspace and the noise subspace. The signal power can then be calculated from the EVD results. Before the DOA estimation is performed, a proposed subspace-based SNR estimation is conducted to determine the amount of noise in each frequency bin. The frequency bins that contain noise can be identified and filtered out using the threshold value that was calculated in the subspace-based SNR estimation.Compared with the system by Yang et al. (2008), the main difference is that the order between phase approximation and frequency selection. According to the method by Yang et al., the frequency bins which have local maximum power are firstly picked, and then the selected frequency bins are adopted in phase regression. However, the method of frequency selection is not much objective because the information of noise is unknown. When the power magnitude of the noise is larger than that of the source signal in some frequency bins, the phase regression would generate false phases to DOA estimation and cause biased DOA result. To avoid this situation, the proposed method selects all the frequency bins in linear phase approximation to obtain the preliminary compensative phases. Subsequently, these compensative phases are examined again in the proposed frequency bin selection. Finally, the significant frequency bins can be reserved for DOA estimation.In DOA estimation, a subspace-based DOA algorithm is utilized because it supports high-resolution DOA performance using the proposed DOA method. The performance of covariance-based DOA estimation without the EVD can be improved using linear phase approximation. The following sections describe the proposed method and experimental results.Fig. 2presents the microphone signals x1(t) and x2(t) from the source signal are received by the uniform linear microphone array in a noisy environment. A pair of microphones, with a spacing of d, are placed in the environment with the source signal, y(t), and the noise, n(t). The direction of the source signal from the microphones is θ, and the first microphone signal x1(t) is set as the reference. The observed signals in the time domain can be modeled using the matrices and vectors that satisfy Eqs. (1) and (2), where t and τ are the time index and the time delay.(1)X(t)=Y(t)+N(t)(2)x1(t)x2(t)=y1(t)y1(t−τ)+n1(t)n2(t)The relationship between the time delay and the direction of the source signal can be formulated as Eq. (3), where c is the velocity of sound in air.(3)τ=dcos(θ)c−1In the frequency domain, Eqs. (1) and (2) can be expressed as Eqs. (4) and (5), where f is the frequency.(4)X(f)=Y(f)+N(f)(5)X1(f)X2(f)=Y1(f)Y1(f)e−j2πfτ+N1(f)N2(f)To simplify the representation of the observed signals and to determine the description of phase in noiseless and noisy environments, the noise that is described in Eq. (5) is ignored. In addition, the unwrapping factor for phase information is also omitted for simplicity in following description. In a noiseless environment, the observed signals can be regarded as a source signal. Equation (6) gives the relationship between the observed signal and the steering vector A(f,θ).(6)X(f)=Y1(f)Y1(f)−j2πfτT=1e−j2πfτTY1(f)=1e−j2πfdcosθc−1TY1(f)=A(f,θ)Y1(f)According to Eq. (6), the covariance matrix of the observed signals can be defined as Eq. (7), where ·*(f) is the conjugate transpose of the complex-valued signal, and E[·] represents the expectation value of a matrix. The exponential term in Eq. (7) contains information about the time delay. In subsequent discussion of the time delay, a part of the exponential term in Eq. (7) is replaced by the symbol ζ(f, τ), which is defined in Eq. (8). The symbol ζ(f, τ) denotes phase data or just “phase” in the following description.(7)RXX=E[X(f)X*(f)]=EY1(f)Y1*(f)Y1(f)Y2*(f)Y2(f)Y1*(f)Y2(f)Y2*(f)=EY1(f)2Y1(f)2ej2πfτY1(f)2e−j2πfτY1(f)2(8)ζ(f,τ)=2πfτClosely examining Eq. (8) reveals that, in a noiseless environment, the phase ζ(f, τ) is directly proportional to the frequency when the time delay τ is the same for all frequency bins. In Fig. 3, three different directions of a source signal (speech is used herein) are individually tested in a noiseless environment. The phase data of observed signals in different directions are depicted as straight lines. Such a line will be called a phase line hereafter. Fig. 3 also indicates that the slope of a phase line depends on the time delay τ, which is determined by the direction of observed signals.However, in a noisy environment, noise makes the time delay τ vary. Fig. 4shows the coordinates of the phase data associated with various frequency bins in a noisy environment. Comparing Fig. 3 with Fig. 4 reveals that noise destroys the linearity of the phase line. The noise-contaminated phase data generate phase distortion and lead to biased DOA estimation.To reduce the phase distortion, preprocessing by the proposed linear phase approximation is utilized to estimate and rectify the phase data for each frequency bin. The linear phase approximation has following three stages, which are covariance matrix calculation, regression, and covariance matrix reconstruction. Regression is the principal process in linear phase approximation, which is presented in detail in Fig. 5.The purpose of linear phase approximation is to rectify the noise-contaminated phase using a flexible linear regression approach. Following the proposed processing, the compensative phase is obtained to rectify the observed phase. In Fig. 5, the observed phase ζ(f, τ) is estimated using the covariance matrix that is calculated in the first stage. However, this phase is distorted by noise. To eliminate the distortion, a first-order regression is adopted in the phase line regression to evaluate the coefficients of a linear equation that fits the phase line in a least squares sense. The linear equation is Eq. (9), where p1 and p2 are the coefficients of the linear equation, and x is the index of frequency bin. The straight line that satisfies Eq. (9) can be regarded as the predicted ideal phase line in the absence of noise.(9)p(x)=p1x+p2In phase update, the objective is iteratively to adapt the phase line to the ideal one. For the observed data, each frequency from the phase data ζ(f, τ) can match a corresponding index of frequency bin x. After substituting the index of frequency bin for the linear equation indicated in Eq. (9), the output p(x) can be obtained according to the coefficients (i.e., p1 and p2) of the linear equation. The output can be taken as the ideal value of phase data, and all the outputs with different indices of frequency bins form a predicted phase line without the influence of noise.In the comparative procedure, each ζ(f, τ) is compared with the corresponding output p(x). At the beginning of the linear phase approximation, the first index of the frequency bin means that the frequency is zero. Therefore, in the first comparison, the value of the phase data is directly set as zero without comparing with the corresponding value p(x). Subsequently, the following phase data are individually compared with the corresponding value during the second comparison to the final comparison. The phase data that are lower than the corresponding value p(x) are updated to the corresponding value p(x). The updated phase data can be rewritten as ζ(f,τˆ). Equation (10) yields the representation of updated phase data, whereτˆis the compensative time delay in the frequency bin.(10)ζ(f,τˆ)=2πfτˆIn the iteration after an update, a refinement that is based onζ(f,τˆ)is performed in the next iteration. To find an optimal phase line, a criterion that involves a square error calculation is applied. The phase line is iteratively updated if the square error exceeds a predefined threshold. Otherwise, the system outputs the phase data from the previous iteration to the next stage. Fig. 6plots the rectified phase line that is obtained after the regression stage.In the regression stage, the noise-contaminated phase data are enhanced by compensating for the time delay. The observed signals that satisfy Eqs. (4) and (5) can be written as Eqs. (11) and (12) in terms ofXˆ(f), which includes the hypothetical modified source signalYˆ(f)and the modified noiseNˆ(f).(11)Xˆ(f)=Yˆ(f)+Nˆ(f)(12)Xˆ1(f)Xˆ2(f)=Yˆ1(f)Yˆ1(f)e−j2πfτˆ+Nˆ(f)=X1(f)X1(f)e−j2πfτˆ=X1(f)X1(f)e−jζ(f,τˆ)In covariance matrix reconstruction, the system reconstructs a new covariance matrix in each frequency bin based on the regressed phase dataζ(f,τˆ). Equation (13) represents the reconstructed covariance matrix.(13)RXˆXˆ=E[Xˆ(f)Xˆ*(f)]=EXˆ1(f)Xˆ1*(f)Xˆ1(f)Xˆ2*(f)Xˆ2(f)Xˆ1*(f)Xˆ2(f)Xˆ2*(f)=EX1(f)2X1(f)2ej2πfτˆX1(f)2e−j2πfτˆX1(f)2=EX1(f)2X1(f)2ejζ(f,τˆ)X1(f)2e−jζ(f,τˆ)X1(f)2In the above stages, the system reconstructs covariance matrices for each frequency bin. However, the slope of the predicted ideal phase line still differs from that of the theoretical one. Fig. 7illustrates this difference.To improve the performance of the DOA estimation, another proposed DOA preprocessing called frequency bin selection is used to identify the frequency bins, which contain the intense noise-contaminated phases. Fig. 8presents the procedure of the proposed frequency bin selection.At the beginning of frequency bin selection, the covariance matrix can be obtained by applying Eq. (13). In the following eigenvalue decomposition stage, the EVD ofRXˆXˆ, which is given by Eq. (13) yields Eq. (14), where Q is a square matrix whose ith column is the eigenvector qi, and Λ is a diagonal matrix. The diagonal elementsλYˆandλNˆare the eigenvalues of the source and the noise.(14)RXˆXˆ=QΛQ−1Λ=λYˆ00λNˆQ=qYˆqNˆIn subspace-based SNR estimation, the system quantifies the noise level at each frequency bin by parameter ɛ. The parameter ɛ, defined by Eq. (15), specifies the logarithm of the ratio ofλYˆtoλNˆ.(15)ε=logλYˆλNˆIn noise detection, the parameter ɛ is compared with a designated threshold χ. If ɛ exceeds the threshold χ, then the observed signal contains more of the wanted signal than noise. Therefore, the corresponding covariance matrix is preserved in DOA estimation. Otherwise, the system simply neglects the frequency bin.In the final stage, a subspace-based method called MUSIC is used in DOA estimation. In the MUSIC procedure, the signal can be separated into the source subspace and the noise subspace by using EVD to decompose its covariance matrix. From Eqs. (11) and (12), the observed signal following the linear phase approximation can be written as Eq. (16) in terms of the steering vectorAˆ(f,θ).(16)Xˆ(f)=Yˆ(f)+Nˆ(f)=1e−j2πfτˆTYˆ1(f)+Nˆ(f)=Aˆ(f,θ)Yˆ1(f)+Nˆ(f)According to Eqs. (14) and (16), the direction of the signal can be estimated from the eigenvector of the covariance matrix and the steering vector. The maximum power at the test angle θ can thus be obtained. The direction is calculated using Eq. (17).(17)PMUSIC(θ)=1AˆH(f,θ)qNˆqNˆHAˆ(f,θ)During the calculation of signal power for a frequency bin whose subspace-based SNR parameter is larger than the designated threshold in the frequency bin selection, the signal power at different trial angles (0–180°) can be obtained by using Eq. (17). Then the values of signal power about this frequency bin at each trial angle are collected. When the power values from all the selected frequency bins are calculated, an accumulative signal power at each trial angle can be acquired according to the pre-calculated signal power from the selected frequency bins. Finally, the DOA result can be gained by finding the angle that has the maximum accumulated signal power.

@&#CONCLUSIONS@&#
