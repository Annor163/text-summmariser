@&#MAIN-TITLE@&#
Hierarchical aggregation of multiple fuzzy controllers for global complex control problems

@&#HIGHLIGHTS@&#
Combining the outputs of multiple controllers a better control behavior can be achieved.The proposed approach consists of a method of controlling at 2 levels.A superior control is designed for adjusting the behavior of the individual controllers.The approach is illustrated with the problem of airplane flight control.

@&#KEYPHRASES@&#
Fuzzy systems,Genetic algorithms,Fuzzy control,Hierarchical fuzzy control,

@&#ABSTRACT@&#
In this paper, we illustrate a proposed method for control that combines the outputs of several individual controllers to improve global control of complex nonlinear plants. In the first part of this paper, we illustrate the proposed method that consists of two levels, where in the top level a fuzzy system represents a superior control that is designed for adjusting the behavior of the individual fuzzy controllers at the lower level. To test the approach, we consider the problem of flight control because it requires several individual controllers. Also a comparison is performed, where the hierarchical control strategy is compared with a simple control approach using the t student test. In this paper, we show that the proposed method outperforms the conventional fuzzy control approach. In the optimal design of the proposed control architecture a genetic algorithm was also applied to tune the parameters of the fuzzy systems in an optimal fashion.

@&#INTRODUCTION@&#
In the real-world, there exist many complex control problems in which using traditional approaches could be producing limited results [1,2,7,8,11]. The main contribution in this paper is a proposed method that consists in dividing a complex problem into many individual control subproblems. In this case, each individual control problem can be solved using a reduced controller [12,13,19–21]. The architecture of the proposed method is considered using two levels in the topology: individual controllers are used to make local control of individual subsystems and after this an aggregation mechanism is used to combine the behaviors of these controllers [22–24,27,28].This proposed method is of relevant importance when working with complex control problems that need the use of more than a single controller to achieve a total control objective [35,36,38,39,41,44]. There has been several research works in the control area, although each author takes their own approach to carry out the investigation and here we explain some works that consider control problems in a similar way. E. Sanchez, H. Becerra, and C. Velez [30] describe different flight controllers for an X-Cell mini-helicopter. They divided their work in two parts. The first scheme consists of a conventional SISO PID controller for z-position and roll, pitch, and yaw angles. In the second scheme, two of the previous PID controllers are used for roll and pitch, and a linear regulator is added to control altitude and the yaw angle. E. Rachman, J. Jaam, and A. Hasnah [28], in their work used nonlinear simulation for automatic flight control system to the complete control design process. After, they used the linear approach in the design and simulation of the controller (control laws), they simulated the controller on the nonlinear real aircraft model. Y. Zhang et al. [46] show in their work, a simple and useful modeling method to acquire a dynamics model of an aerial vehicle containing unknown parameters using mechanism modeling, and then to design different identiﬁcation experiments to identify the parameters based on the sources and features of its unknown parameters. As mentioned above, there are several works in aviation that have been mentioned for their importance regarding control, flight control range from small trajectories, using methods, such as fuzzy logic and neural networks [46,47].The paper is structured as follows. In Section 2, we present some essential concepts of flight maneuvers and control. Section 3 proposed a method, which is explained and a description of the problem and results obtained are covered in Section 4. Finally, Section 5 presents conclusions.Flight mechanics is the science of predicting and controlling aircraft motion [25,31,32]. From Newton's second law we know that the motion of any physical body depends on the forces and moments acting on the body. The forces and moments exerted on an aircraft in flight are the aerodynamic forces and moments acting on the aircraft's skin, the propulsive forces and moments created by the aircraft's engine, and the gravitational force between the aircraft and the Earth [34,37]. Because aerodynamic forces and moments are central to the study of aircraft motion [40]. There are three main approaches to the determination of flight vehicle's aerodynamic characteristics: analytical, computational, and experimental. Analytical techniques range from sophisticated theoretical approaches to those based on simple numerical methods to estimate pressure distributions. Experimental techniques include the use of wind tunnels and vehicle flight test to measure or infer the forces, moments, and/or pressure distributions on the vehicle [33].In Fig. 1a conventional airplane is presented with its control surfaces (elevator, ailerons, and rudder). Every airplane can flight using its 3 axes (roll, pitch, and yaw), the pitching moment created by the pressure distribution over the airfoil is another key characteristic, this moment takes about a point along the chord line. A yaw moment on the vehicle may be generated by any surface generating a side force, such as the vertical tail in sideslip or with its rudder deflected. Roll is a movement around the longitudinal axis of the airplane. In Fig. 2the basic movements of the airplane are illustrated.Today, there exist many case studies where neural networks, intelligent control, and fuzzy systems have an important role in solving real-world problems, and in some cases other techniques are also used to achieve the required solutions. The solutions of these control problems could be improved by using a new hierarchical structure combining multiple controllers. A simple control structure is presented in many studies, but what will happen when the case of study has more complexity? As a particular case of this situation, in Fig. 3we present the block schematic diagram of the flight control system and Fig. 4illustrates a possible solution using an architecture that considers multiple controllers that could be used for a complex control problem. This figure represents a basic scheme of control when we use several controllers for solving a complex problem that can be decomposed in several simpler problems.However, with the traditional approach of Fig. 4 the main assumption is that the individual controllers can work independently without interaction, which is not true for real world problems. For this reason, in this paper, we propose a method to improve the scheme of control in these situations. The proposed method for control is illustrated in Fig. 5.The proposed method is based on the model shown above where we have more than one individual controller for a complex problem. In the proposed method (Fig. 5) the incorporation of the multiple control system is presented. Basically, after studying each individual controller (c1, c2, and c3) we can proceed to design an aggregator of their results. This aggregator takes the individual values of each controller and converts them to a single unified system. When the structure of the aggregator is obtained, the rules for that system can be designed using a genetic algorithm [3–6,9,17], and the parameters are defined as explained later in Section 4. From the aggregator, the output data are obtained and these go directly to the simulation plant, and once the simulation is performed, one global result is obtained, and these data feeds the system going to the individual systems and perform the same process.The complex control problem used to test the proposed method is the flight control. This case of study aims at controlling the flight of an airplane, and we offer first a brief explanation about the problem. In this problem, we need to control the total flight of the airplane and for this reason, it is necessary to know that to control the flight it is necessary to use at the same time three main controllers (longitudinal, lateral, and direction control) [14,16]. For longitudinal control it is important to consider the stick of the pilot because with this the elevators are moved (up and down pulling or pushing the stick) and this movement changes the position of the nose of the airplane (movement in axes y). To achieve direction control, the pedals are used to make changes and when the pedals are pressed (to the left or right) the rudder moves (left or right) and the aircraft is moving left or right in the x axes. Finally, lateral control changes by moving the stick left or right and when this happens the ailerons are moved up or down (alternating) and the aircraft moves in the z axes. Based on the above explanation, we decided to design first the individual controllers (longitudinal, lateral, and direction control). A fuzzy system was designed for each controller. To obtain the longitudinal control a fuzzy system with one input and one output was implemented, in the output variable we used the elevator because when it moves the aircraft moves in the y position and in the input the stick is used. In this case, the linguistic values are: push, pull, or not move the stick and depending on the movement a reaction in the elevator is obtained. In the lateral control the outputs are the ailerons, because when the ailerons are moved the aircraft can change the direction in the z axes and in the input is the stick of the pilot and when this is moved right or left the ailerons have a reaction (up/down) and the linguistic values of the stick are: move right, move left, and center. In the direction control, the output is the rudder and when the rudder is moved (left or right), the aircraft changes the trajectory in the x axes and in the input, the pedals are considered (left and right). When the pedals are pressed the rudder has a reaction to the left or right and the aircraft changes the position to the new direction. The fuzzy systems were designed with different types of membership functions. First, triangular membership functions were used and the behavior was observed, then Gaussian and trapezoidal membership functions were also tested to compare the behavior. The types of membership functions were changed to analyze the behavior of the plant and to obtain a better control. The parameter values of the membership functions are initially established by default as evenly distributed in the ranges of the variables, and after using a genetic algorithm all the parameters of the membership functions are moved according to the objective function of the problem, which is to minimize the error. The rules of each fuzzy system were obtained based on knowledge about the flight and are the following:•If wheel is push then elevator is downIf wheel is center then elevator is centerIf wheel is pull then elevator is upIf wheel is left then aileron is left_up_right_downIf wheel is center then aileron is centerIf wheel is right then aileron is right_up_left_downIf pedals is left then rudder is leftIf pedals is center then rudder is centerIf pedals l is right then rudder is rightWhen the fuzzy systems were obtained, simulation tests were performed with the simulation plant shown in Fig. 6and in Fig. 7, which represent subsystems where the control is applied.It is important to mention that the plant has a reference that the aircraft has to follow. In addition there is turbulence block, but also a joystick can be used to introduce more turbulence in the behavior of the aircraft in flight. For a better explanation of the problem structure, the general idea is presented in Fig. 8.The uncertainty presented in this case study is: the turbulence that may occur during a plane flight from the initial rise until it lands; also we have uncertainty, such as clouds, day or night, and different weather. The uncertainty is handled as an extreme case where wind gusts are intensively generated in cruise flight and also randomly abrupt movements were introduced on the plane using a manual joystick. To model the uncertainty, such as the mentioned above turbulence, the simulation and noise are implemented. The noise simulation is possible; thanks to a block having a generator equation which simulates these conditions. For example, to introduce turbulence in the aircraft the block uses the Dryden spectral representation to add turbulence to the aerospace model using band-limited white noise through appropriate forming filters. It is important to mention that this block implements the mathematical representation in the military specification MIL-F-8785C and military to obtain this noise. The proposed method is designed to endure these uncertainties, besides if a most extreme case happened, for example, if an individual controller failed (elevator, aileron, or rudder) the proposed method could still control the flight of the plane because each controller comes individually as sub-modules and then going to the aggregator where rules are optimized for these cases. The control design for any complex control problem has to consider each individual controller to study individually the simpler problems and then apply the proposed method using the aggregator. The results using the individual controllers are shown in Table 1.The behavior of the controllers is shown in Fig. 9.Fig. 9 shows the behavior of the elevator, aileron, and rudder, and these results were obtained using manual executions to observe the behavior, but later we show the behavior using a genetic algorithm and its improvement. In Table 1 we can appreciate that errors are relatively high, and then these errors are reduced when the proposed method is applied. The controller design has three levels of control, but for a fuzzy controller we can consider two alternatives. The first is to change the ways of separating input sets for the level of control (longitudinal, lateral, and directional) and get a fuzzy control for each level. The second is to make only one controller, which permits full control of the aircraft obtaining total handling. The first option was taken because this architecture needed to be tested, and in the case of a real flight if one controller fails the other two help in avoiding a crash. First, remembering that the three individual controllers were initially obtained, and that each controller has one output. Then we develop an aggregator with three inputs and three outputs, the inputs take the values of each individual controller to obtain new improved outputs to achieve the control. The aggregator structure is illustrated in Fig. 10.Having defined the structure of the aggregator, then the rules are needed to continue, but how we can know, which are the best set of rules? For this reason a genetic algorithm [17,25] was used to improve the results and to obtain the best set of rules, and the chromosome of the genetic algorithm in this case is shown in Fig. 11.To obtain the rules we use the Michigan approach, where each chromosome is a rule. Each gene contains a value between 1 and 3, and the parameters are: number of generations −20, number of individuals (population size) 25, selection-roulette, discrete mutation, crossover of a single point with a crossover rate=0.9 and mutation rate −0.2. In the genetic algorithm, the fitness is based on the errors of each controller and the results of all controllers are added, and finally results are divided by the numbers of the controllers. Eq. (1) shows how the fitness function is calculated.(1)fY=∑i=1nyREF1in−yFS1in+∑i=1nyREF2in−yFS2in+∑i=1nyREFNin−yFSNinNwhere YREF is the reference, YFS is the output of the controller and n is the number of points used in the comparison and N is the number of the controllers. Finally the fuzzy rules are as follows:1.If (Elevator is high) and (rudder is high) and (Aileron is low) then (Nelevator is high) (Nrudder is medium) (Naileron is medium)If (Elevator is high) and (rudder is medium) and (Aileron is high) then (Nelevator is medium) (Nrudder is high) (Naileron is medium)If (Elevator is low) and (rudder is medium) and (Aileron is low) then (Nelevator is low) (Nrudder is low) (Naileron is medium)If (Elevator is medium) and (rudder is high) and (Aileron is medium) then (Nelevator is medium) (Nrudder is medium) (Naileron is medium)If (Elevator is medium) and (rudder is medium) and (Aileron is high) then (Nelevator is medium) (Nrudder is medium) (Naileron is medium)If (Elevator is medium) and (rudder is low) and (Aileron is high) then (Nelevator is low) (Nrudder is medium) (Naileron is low)If (Elevator is low) and (rudder is medium) and (Aileron is high) then (Nelevator is medium) (Nrudder is high) (Naileron is medium)If (Elevator is low) and (rudder is low) and (Aileron is low) then (Nelevator is medium) (Nrudder is medium) (Naileron is high)If (Elevator is low) and (rudder is high) and (Aileron is low) then (Nelevator is medium) (Nrudder is medium) (Naileron is medium)If (Elevator is low) and (rudder is medium) and (Aileron is medium) then (Nelevator is medium) (Nrudder is medium) (Naileron is medium)Having designed the fuzzy rules and the aggregator, the simulation was performed and the results are shown in Table 2.The corresponding behavior of the airplane is illustrated in Fig. 12, where the reference and real behavior are shown.Previously we have illustrated (Fig. 12) the behavior of the airplane when the proposed method was applied. In this case, the blue line is the reference and the green line is the behavior and this is why both lines are almost one line, the square error is used and the resolution presented in Fig. 12 is result of the Matlab version. Now in Table 3we illustrate the results when different noise levels are applied to perturb the behavior of the airplane.The bound of the uncertainty was estimated by successively using different levels of uncertainty and when the noise level was of 20000 the proposed control can still work properly. We even tested with 25000, 50000, and more levels, but the error did not decrease significantly. We consider 20000 to be a good estimate of this bound.In the above tables the errors are shown using or not using the proposed method. In this case we can notice that when a high level of noise is introduced the system can be affected greatly as shown in the first table where errors are higher. Noise affects the stability of the aircraft greatly because the different kinds of noise are introduced simultaneously. When the proposed method (last tables) was used, it can be noticed that the controller could improve the flight and not be affected so much by the noise used and having achieved the previous results, we can say that by applying the proposed approach we model uncertainties appropriately when the plane is used in flight control, and the obtained results have a good stability if flight control even though noise and the weather conditions could be changing in time. Also the behavior of each controller, when the proposed method was applied, was better and the aggregator appropriately improved the control of the airplane, but to verify if the aggregator is really useful statistical t student tests were performed, and three tests were used one for each controller (aileron, elevator, and rudder). The first statistical test is using the individual value of the ailerons with its 15 samples and the values obtained with the aggregator and genetic algorithm, the second test is with the individual values for elevator controller compared with the aggregator and genetic algorithm, and finally last test is with individual value of the rudder controller and the aggregator with optimization. In comparison with the results of Kada B. and Ghazzawi Y. [15], where they describe the structure and the design aspects of a robust PID controller for higher-order systems and the response is very slow and the errors are around 0.70 and even higher, and with the proposed method the response is quick and the error is lower.In Table 4the test shows that there is sufficient statistical evidence to say that there is significant difference of the results of the proposed method using the aggregator when compared with the individual fuzzy controller (with more than 95% confidence). And the difference in the behavior is illustrated in Fig. 13where values are represented graphically.Tables 5 and 6also show a significant improvement when the proposed method is applied. In other words, the proposed method generates a significant increase in the controller's performance to have better stability against perturbations. Figs. 14–15also show these differences in the two cases. Tables 5 and 6 show comparisons between the individual fuzzy systems and the aggregator with optimization, and these significant differences were also observed with a margin of more than 95% confidence.

@&#CONCLUSIONS@&#
In this paper, a proposed approach for global control was presented and this method is based on the hierarchical aggregation of multiple fuzzy controllers. The efficiency of the method for control was illustrated with the problem of flight control. It is important to mention that the proposed approach can be used in complex control problems when these require the use of several individual controllers. In this case of study the approach was useful to divide the complex problems into sub-problems [28,29,41,42] and then perform an aggregation of the individual results. In the final section of the paper a statistical t student test was performed to prove the efficiency of the proposed method and this test shows that this proposed approach is useful to achieve the control complex control application, like airplane control, when multiple controllers are involved. As future work, we plan to consider other complex nonlinear plants to tests the proposed approach, and in addition to enhance the aggregation with higher orders or types of fuzzy logic.