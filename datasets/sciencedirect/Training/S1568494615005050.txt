@&#MAIN-TITLE@&#
Negative selection algorithm with constant detectors for anomaly detection

@&#HIGHLIGHTS@&#
FB-NSA and FFB-NSA generate a layer of detectors, which are around the self space.The detectors generated by FB-NSA and FFB-NSA in nonrandom ways.The detectors of FB-NSA and FFB-NSA are only related to the training samples.FB-NSA can detect the abnormal degree of mechanical equipment.

@&#KEYPHRASES@&#
Artificial immune system,Negative selection algorithm,Anomaly detection,Bearing,

@&#ABSTRACT@&#
In the paper, two novel negative selection algorithms (NSAs) were proposed: FB-NSA and FFB-NSA. FB-NSA has two types of detectors: constant-sized detector (CFB-NSA) and variable-sized detector (VFB-NSA). The detectors of traditional NSA are generated randomly. Even for the same training samples, the position, size, and quantity of the detectors generated in each time are different. In order to eliminate the effect of training times on detectors, in the proposed approaches, detectors are generated in non-random ways. To determine the performances of the approaches, the experiments on 2-dimensional synthetic datasets, Iris dataset and ball bearing fault data were performed. Results show that FB-NSA and FFB-NSA outperforms the other anomaly detection methods in most cases. Besides, CFB-NSA can detect the abnormal degree of mechanical equipment. To determine the performances of CFB-NSA, the experiments on ball bearing fault data were performed. Results show that the abnormal degree based on the CFB-NSA can be used to diagnose the different fault types with the same fault degree, and the same fault type with the different fault degree.

@&#INTRODUCTION@&#
Anomaly detection problem can be stated as a one-class classification problem, because only normal samples are available at training stage [1]. The task of anomaly detection method is similar to that of the biological immune system because both of them aim to detect the abnormal information [2]. The negative selection algorithm (NSA) was proposed by Forrest et al. in 1994 under the inspiration of the mechanism of T-cell maturation in the thymus [3–5]. Many modified versions of NSA algorithms had provided more efficient solutions for problems of anomaly detection [6–8], fault diagnosis [9], computer security [10,11], and optimization [12].The initial NSA used binary encoding to represent self and non-self samples [3]. Later, a real-valued NSA (RNSA) was presented, and the hypersphere detectors with constant radius were adopted [13,14]. Soon after, variable-sized detector [15,16], hypercube detector [2,14], hyper-ellipsoid detector [17,18], and multi-shaped detector [19] were proposed. Compared with these detectors, the hypersphere detector is more widely used, because it has a simple mathematic description.In order to achieve enough detector coverage and reduce the detector number, many methods were proposed [20–25]. Although the methods mentioned above can improve the detection rate and eliminate the holes, the detectors of these methods are generated at random. Even for the same training data, the position, size and quantity of detectors generated in each time are different. Little attention has been paid to the NSA with constant detectors. That is, the position, size and quantity of NSA detectors are constant. These detectors are only related to the training samples, and have nothing to do with training times.The paper presents two negative selection algorithms with constant detectors. One is named as Boundary-Fixed Negative Selective Algorithm (FB-NSA). The other is an improved FB-NSA algorithm named Fine Boundary-Fixed Negative Selective Algorithm (FFB-NSA). FB-NSA and FFB-NSA generate a layer of detectors, which are around the self space. The FB-NSA detectors and FFB-NSA detectors seem to be the boundary of self space and non-self space. Self samples are on one side of the detectors, and non-self samples are on the other side of detectors or within detectors.The remaining sections of the paper are structured as follows. The models of FB-NSA, FFB-NSA and CFB-NSA are presented in detail in Sections 2, 3 and 4, respectively. The experimental results are presented in Section 5. In Section 6, conclusions are provided.The detectors of traditional RNSA are generated at random. The detectors which are around the self space can be generated easily, but they can not be directly used for anomaly detection. It is easy to calculate the distance between a detector and a testing sample, but it is difficult to confirm the position relationship between a detector and a testing sample. Therefore, these detectors cannot recognize what side of detectors the testing sample is on.As shown in [0,1]2 in Fig. 1a,t1 belongs to self space and it is a self sample, marked ast1∈S;t2 andt3 belong to non-self space, and they are non-self samples, marked ast2∈N,t3∈N. When the testing algorithm of the traditional NSA is used,t1∈S(right),t2∈N(right),t3∈S(wrong).To sum up, the FB-NSA detector can be defined as:Definition 1FB-NSA detector,D={<di,ri,pi>|di∈Rn,ri∈R}wherediis the center of FB-NSA detector; riis the radius ofdi, ri=d−rs; d is the distance betweendiand its the nearest training sample; rsis the radius of training samples; piis the position information ofdi.When the radii of FB-NSA detectors are the same, this approach is named Boundary-Fixed Negative Selective Algorithm with Constant-Sized Detectors (CFB-NSA). When the radii of FB-NSA detectors are different, this approach is named Boundary-Fixed Negative Selective Algorithm with Variable-Sized Detectors (VFB-NSA). The FB-NSA and FFB-NSA detectors are described in [0,1]2 shown in Fig. 1. There are 26 FB-NSA detectors and 29 FFB-NSA detectors around the self space.t1∈S, and it is on one side of the FB-NSA detectors;t3∈N, and it is on the other side of the FB-NSA detectors;t2∈N, and it is in the detector di, as shown in Fig. 1a.It is difficult to confirm the position relationship between two hyperspheres, but it is easy to confirm the position relationship between two hypercubes. If the non-self space is filled with the same hypercubes, the non-self space can be approximated with Eq. (1):(1)VNonself=limVhypercube→0∑i=1∞(Vhypercube)iFig. 2shows the approximation process in 2-dimensional space. There are 202, 402, 802, and 1602 squares in Fig. 2a–d, respectively. It is clear that the boundary of squares in the non-self space can be approximated to the boundary of non-self space.Therefore, the FB-NSA detectors can be generated with the hypercubes which are close to the self space. The center of the hypercube is the center of the detector, and the position relationship between the two hypercubes is the position relationship between two detectors. These hypercubes are defined as boundary hypercubes, and every boundary hypercube generates a FB-NSA detector.The key to generate FB-NSA detector is to obtain the boundary hypercubes. To obtain boundary hypercubes, the state spaceTshould be evenly divided into mnhypercubes:(2)T=⋃i=1mnhi,where m is the number of the segments of each dimension, and n is the number of space dimension.Definition 2Empty hypercube and non-empty hypercube, when a hypercube hiis covered by a self sample or a self sample located in hi, it is non-empty, marked as hi=Θ. Otherwise it is empty, marked as hi=O.It is complicated to determine whether a hypercube is covered by self sample through calculation. To simplify the algorithm, a definition, recognition radius δ, is proposed.Definition 3Recognition radius δ, δ is a pre-set distance.(3)f(hi)=Θd≤δOd>δwhere d is the distance betweenciand training samplesj, andciis the center of hypercube hi.Recognition radius δ is an important parameter to determine the hypercubes’ property. According to Definition 3, whether a hypercube is empty is determined according to the distance between its center and self sample. It is clear that to obtain all the hypercubes which are covered by self sample δ should be larger than rs.The number of FB-NSA detectors increase with the increase of δ, but the detection efficiency decrease with the increase of δ. The hypercube which is less covered or not covered by self sample can be recognized as the boundary hypercube, when δ is relatively large. Besides, the generated FB-NSA detectors can not cover the holes near self space, when δ is relatively large.The effects of δ on the quantities of FB-NSA detectors in [0,1]2 is shown in Fig. 3. The state space is evenly divided into 152 squares: the pale gray squares are non-empty; others are empty; the dark gray squares are boundary squares. Fig. 3 shows that h7,7, h8,7, h9,7, h7,8, h8,8, h9,8, h7,9, h8,9, and h9,9 are covered by self sample. When δ=rs, only h8,8 can be recognized as the non-empty square. When δ=rs+0.5/m, 9 non-empty square can be recognized, and 12 boundary squares are generated (shown in Fig. 3a). When δ=rs+1/m, 13 non-empty squares can be recognized, and 12 boundary squares are generated (shown in Fig. 3b). When δ=rs+1.5/m, 21 non-empty squares can be recognized, and 16 boundary squares are generated (shown in Fig. 3c).The effects of δ on the quality of FB-NSA detectors in [0,1]2 is shown in Fig. 4. The dark gray area is self space which is generated with training samples as shown in Fig. 4. There are some holes near h6,14, h7,14, h8,14, h8,15, h8,16, h7,16, h14,6, h14,7, and h14,8, as shown in Fig. 4. When δ=rs+0.5/m, 53 FB-NSA detectors are generated, and 5 of them cover the holes as shown in Fig. 4a. When δ=rs+1/m, 52 FB-NSA detectors are generated, and no detector cover the holes as shown in Fig. 4b. Obviously, the detection rate of δ=rs+0.5/m is higher than that of δ=rs+1/m. In general, δ=rs+0.5/m in this paper.Definition 4Boundary hypercube, when a hypercube is empty and at least one of its adjacent hypercube is non-empty, it is a boundary hypercube.The position information of a boundary hypercube, the position information of a boundary hypercube is used to record the property of its every adjacent hypercube. The position information of a boundary hypercube is the position information of a FB-NSA detector which is generated by this boundary hypercube.In order to better understand these definitions, further explanation is shown in 2-dimensional dataset. The state space [0,1]2 is evenly divided into 202 squares. As shown in Fig. 5a, the black areas are self pace; the pale gray squares are non-empty; others are empty; the dark gray squares are boundary squares. Fig. 5b shows the FB-NSA detectors which are generated by these boundary squares.For example, h9,19 is a boundary square, and the FB-NSA detector generated by this boundary square is marked asdk1. The properties of its adjacent squares are h8,19=Θ, h9,18=Θ, h10,19=O, and h9,20=O. The position information of h9,19 can be described as:{t∈S|t.x<c9,19.xort.y<c9,19.y},wheretis a testing sample andtis not in h9,19;c9,19 is the center of h9,19.In the same way, the position information ofdk1 can be described as:pk1:{t∈S|t.x<dk1.xort.y<dk1.y}.The position information pk1 shows that a testing sample, which is not in the FB-NSA detectordk1, is a self sample, when it is on x− direction of the FB-NSA detectordk1 or it is on y− direction of the FB-NSA detectordk1.In the same way, the position information ofdk2,dk3,dk4 anddk5 which are generated by h13,19, h15,8, h15,5 and h6,15 can be described as:pk2:{t∈S|t.y<dk2.y}.pk3:{t∈S|t.x<dk3.xort.x>dk3.x}.pk4:{t∈S|t.x<dk4.xort.x>dk4.xort.y<dk4.y}.pk5:{t∈S|t.x<dk5.xort.x>dk5.xort.y<dk5.yort.y>dk5.y}When the space is a high-dimension space (n>2), the position information of a detector can be record in the same way. Taking 4-dimensional space (The four dimensions are recorded as x1, x2, x3, and x4 respectively.) as an example. Suppose the hi1,i2,i3,i4 is a boundary hypercube, and the FB-NSA detector generated by this boundary hypercube is marked asdk6. The properties of its adjacent hypercubes are hi1−1,i2,i3,i4=Θ, hi1,i2−1,i3,i4=O, hi1,i2,i3−1,i4=Θ, hi1,i2,i3,i4−1=Θ, hi1+1,i2,i3,i4=O, hi1,i2+1,i3,i4=Θ, hi1,i2,i3+1,i4=O, and hi1,i2,i3,i4+1=O. The position information of hi1,i2,i3,i4 can be described as:{t∈S|t.x1<ci1−1,i2,i3,i4.x1ort.x2>ci1−1,i2,i3,i4.x2ort.x3<ci1−1,i2,i3,i4.x3ort.x4<ci1−1,i2,i3,i4.x4},wheretis a testing sample andtis not in hi1,i2,i3,i4;ci1,i2,i3,i4 is the center of hi1,i2,i3,i4.In the same way, the position information ofdk6 can be described as:pk6:{t∈S|t.x1<dk6.x1ort.x2>dk6.x2ort.x3<dk6.x3ort.x4<dk6.x4}.FB-NSA can be used for anomaly detection after the detectors and their position information are obtained. It is not necessary to record these inequalities in actual applications. In general, the position information is coded as a code piofdiin the training stage and then decoded in the testing stage.There are multiple ways to code the position information, and here to introduce one of them. There are 4 cases in every dimension, with x dimension of a hypercube h as the example, as follows:Its adjacent hypercubes on x− and x+ direction are empty; its adjacent hypercube on x− is non-empty and on x+ direction is empty; its adjacent hypercubes on x− is empty and on x+ direction is non-empty; its adjacent hypercubes on x− and x+ direction are non-empty. They are coded as “0”, “1”, “2” and “3” respectively.The pk1, pk2, pk3, pk4, pk5 and pk6 are coded as: 11, 01, 30, 31, 33, and 1211.Suppose the code of a 4-dimensional detector's position information is 2103, it can be decoded as follows:pkn:{t∈S|t.x1>dkn.x1ort.x2<dkn.x2ort.x4<dkn.x4ort.x4>dkn.x4}.The training stage of FB-NSA is to obtain the boundary hypercubes and code their position information. The training stage includes the following four main steps.Step 1: To divide the state space.State spaceTis evenly divided into mnhypercubes and then the centercof each hypercube is calculated.Step 2: To identify the property of hypercube.The hypercube's property can be obtained according to Definitions 2 and 3.Step 3: To look for boundary hypercubes and code their position information.The boundary hypercubes can be obtained according to Definition 4 and their position information can be coded according to Definition 5.Step 4: To calculate the radii of FB-NSA detectors.The radii of FB-NSA detectors can be obtained according to Definition 1.The testing stage of FB-NSA is different from that of RNSA. In addition to the distance between testing sample and FB-NSA detector, the position relationship between them is also considered. In other words, when the testing sample is outside the detectors of FB-NSA, the position information of FB-NSA detectors is required for recognizing the type of testing sample.However, the position information of every FB-NSA detector only represents local position relationship of the state space. When the position information of single FB-NSA detector is used to recognize the type of testing sample, sometimes mistakes are generated, because the position information is incomplete. During the testing stage of FB-NSA, the position information of 2 FB-NSA detectors which are nearest to the testing sample is required for recognizing the type of the testing sample.As shown in [0,1]2 in Fig. 6, the nearest FB-NSA detector tot1 isd16 and the next isd14. The position information ofd16 andd14 are as follows:p16:{t∈S|t.y<d16.y}p14:{t∈S|t.x>d14.xort.y<d14.y}When the position information of single FB-NSA detector is used to recognize the type of testing sample,t1 meets the position information ofd16,t1∈S(mistakenly recognized). When the position information of 2 FB-NSA detectors which are nearest to the testing sample is used to recognize the type of testing sample,t1 does not meet the position information ofd16 andd14 at the same time,t1∈N(right recognition).The above analysis indicates that the testing stage includes two main steps.Step 1: To calculate the distance between testing sampletand FB-NSA detectors.Step 2: If the minimum distance d≤rs,t∈N. Otherwise, decode the position information of 2 FB-NSA detectors nearest tot. If thetmeets these position information at the same time,t∈S; otherwise,t∈N.When w detectors (w>2) have the same distance from the test sample, two of these detectors are selected at random.Definition 6The detection range of RNSA detector, the range is where the RNSA detector recognizes the testing samples as non-self samples in the state space.It is clear that the detection range of traditional RNSA detector, such as V-detector, is its own size in state space.FB-NSA detector looks like a hypersphere, but its detection range is different from that of RNSA detector. FB-NSA detectors depend on their position information to recognize the type of testing sample. Therefore the detection range of FB-NSA detector goes beyond its size.Fig. 7shows the detection range of FB-NSA detectors in [0,1]2. The state space is evenly divided into 102 squares: the white squares are empty and the gray squares are non-empty. There are 10 self samples. The dark area is self space. As shown in Fig. 7a, 17 FB-NSA detectors are generated. Takingd3 as an example to analyze the detection range of FB-NSA detectors, the position information ofd3 is as follows:p3:{t∈S|t.x>d3.xort.y>d3.y}When only the position information ofd3 is used to recognize the type of testing sample, the detection range ofd3 in non-self space is the white area shown in Fig. 7b. According to the testing algorithm of FB-NSA, two FB-NSA detectors, which are nearest to the testing sample, are required for recognizing the type of testing samples. Therefore the real detection range ofd3 is smaller than that in Fig. 7b. The area's color from light to dark respectively indicate the detection range of d1, d2, …, and d17, as shown in Fig. 7c.FB-NSA generates a layer of detectors, which are around the self space. The detectors overlap and can fully separate the self space from the non-self space in general. However, partial FB-NSA detectors do not overlap, and cannot fully separate the self space from the non-self space intuitively. In fact, FB-NSA detectors also depend on their position information to fully separate the self space from the non-self space.Fig. 8shows the closure of FB-NSA detector in [0,1]2. There are 18 FB-NSA detectors.d4 does not overlapd6. The position information ofd4 andd6 are as follows:p4:{t∈S|t.x>d4.xort.y>d4.y}p6:{t∈S|t.x>d6.xort.y>d6.y}The FB-NSA detectors is closed with {t∈S|t.y>d4.y andt.x>d6.x}, and indicated by Arrow (Fig. 8).Thus it can be seen that FB-NSA detectors can fully separate the self space from the non-self space.RNSA defines self samples and detectors as hypersphere in general. There are many holes among self samples and detectors. These holes are false negative areas. The samples in these areas can be recognized as self samples. FB-NSA detectors depend on their position information to recognize the type of testing samples, and also have false negative areas.Definition 7The detection blind area of FB-NSA detectors, the area is the false negative area of FB-NSA detectors.The detection blind area of FB-NSA detectors includes two parts. One part is composed of the holes between self samples and detectors, and caused by the inherent character of hypersphere. This part can be defined as the first detection blind area of FB-NSA detectors. Another part is composed of the areas near the FB-NSA detectors, and caused by the situation that the two adjacent FB-NSA detectors are not overlapping or not overlapping enough. This part can be defined as the second detection blind area of FB-NSA detectors.The first detection blind area of FB-NSA detectors is the inherent characteristic of RNSA, and cannot be eliminated. The second detection blind area of FB-NSA detectors is the special characteristic of FB-NSA, and can be reduced or even eliminated under certain conditions.Fig. 9shows the detection blind area of FB-NSA detectors in [0,1]2. The dark gray area in Fig. 9 is self space and the pale gray area is the detection blind area of FB-NSA detectors. The second detection blind area of FB-NSA detectors is indicated by Arrow 1 and Arrow 2, and the other area is the first detection blind area of FB-NSA detectors.The number of FB-NSA detectors is related to parameter m. When m is relatively large, the FB-NSA detectors are relatively small. With the increase of m, the number of FB-NSA detectors and the detection rate increase, and the first detection blind area of FB-NSA detectors and the detection efficiency decrease. On the contrary, when m is relatively small, the FB-NSA detectors are relatively large. With the decrease of m, the number of FB-NSA detectors and the detection rate decrease, and the first detection blind area of FB-NSA detectors increase.Thus it can be seen that the parameter m and the detection rate are a pair of contradictions. To solve this contradiction, we refer the idea of V-detector and local mesh refinements. Firstly, relatively large FB-NSA detectors with relatively small m in state space are generated. Secondly, relatively small FB-NSA detectors generated with a relatively large m are used to cover the detection blind area of the FB-NSA detectors generated with a relatively small m in the last time. Compared to the FB-NSA detectors which are generated with relatively large m, this way can reduce the FB-NSA detectors while maintaining the high detection rate, under the same training parameters setting. An improved Boundary-Fixed Negative Selection Algorithm is proposed, named as Fine Boundary-Fixed Negative Selection Algorithm (FFB-NSA).For convenience, FB-NSA is recorded as FB-NSA (m=n0), and FFB-NSA is recorded as FFB-NSA (n1-n2-…-nk).Fig. 10shows the mechanism of FFB-NSA in [0,1]2. FB-NSA (m=10) has 26 detectors, as shown in Fig. 10a, and the first detection blind area of FB-NSA detectors is large. FB-NSA (m=40) has 115 detectors (Fig. 10b), and the first detection blind area of FB-NSA detectors is small. Obviously, the number of FB-NSA (m=10) detectors is less than that of FB-NSA (m=40), and the detection rate of FB-NSA (m=10) is lower than that of FB-NSA (m=40). FFB-NSA (10–40) has 57 detectors, as shown in Fig. 10c. The number of detectors of FFB-NSA (10–40) is less than that of FB-NSA (m=40), and the detection rate is higher than that of FB-NSA (m=10), and is close to that of FB-NSA (m=40).The FFB-NSA reduces the number of detectors which are generated by FB-NSA with different values of the parameter m. When the coverage of a small FB-NSA detector covered by a large FB-NSA detector is larger than a threshold, the small FB-NSA detector is deleted. The rest detectors are FFB-NSA detectors.It is difficult to calculate the overlapping portions of two hyperspheres in high-dimensional space. However, a small FB-NSA detector with relatively large m must be generated in the area where a large FB-NSA detector with relatively small m is generated, but the opposite is not always true. Therefore the rule of FFB-NSA which is used to reduce the number of detectors is to delete a small FB-NSA detector when its center is in a large FB-NSA detector. In order to improve the generation efficiency of FFB-NSA detectors, it is set that m is changed as follows: m, 2m, 4m, …Fig. 11shows the rule of FFB-NSA in [0,1]2. The gray area is self space (Fig. 11). In Fig. 11a, 12 FB-NSA detectors are generated with m=8. In Fig. 11b, 24 FB-NSA detectors are generated with m=16.For convenience, the squares shown in Fig. 11a are recorded as Hij, and the squares shown in Fig. 11b are recorded as hij. Taking H3,3, h6,6, H4,4 and h8,8 as examples to illustrate the rule of FFB-NSA. The detector generated by h6,6 can be deleted since it is covered by the detector generated by H3,3. The detector generated by h8,8 cannot be deleted since no detector is generated by H4,4, and only a small part of the detector generated by h8,8 is covered by the detector generated by H4,3. There are 20 FFB-NSA detectors including 8 FB-NSA (m=8) detectors and 8 FB-NSA (m=16) detectors (Fig. 11c). These detectors cover the holes generated by FB-NSA (m=8) detectors.The outline of the training algorithm of FFB-NSA is illustrated in Fig. 12.NSA is mainly used in anomaly detection in fault diagnosis field. Previous studies about NSA mainly focus on improving the detector coverage and detection rate, and eliminating the holes [20–25]. The abnormal degree detection is seldom studied.Definition 8Abnormal degree is used to describe the degree to which a non-self sample deviates from the self space.The abnormal degree of equipment is required in the fault diagnosis of mechanical equipment. An abnormal degree function μAshould be established. The funcion is mapping the state spaceTand the abnormal degree spaceA(The value of A ranges from 0 to 1). That is, [0,1]n→[0,1]. “0” indicates normal, “1” indicates abnormal, “0–1” expresses the abnormal degree.The detectors of NSA are generated at random and it is difficult to calculate the abnormal degree of equipment. The FB-NSA generates a layer of detectors, which are around the self space. The position, size and quantity of FB-NSA detectors are constant under the same training samples. Therefore FB-NSA can be used to detect the abnormal degree of mechanical equipment.It is easy to calculate the abnormal degree of non-self samples which are not in the FB-NSA detectors, but it is difficult to calculate the abnormal degree of non-self samples which are in the FB-NSA detectors. Therefore it is assumed that the non-self samples which are in the FB-NSA detectors have the same abnormal degree.To describe the abnormal degree of non-self samples better, the FB-NSA detectors have the same radius, and the radius cannot be too large. Therefore CFB-NSA can be used for the abnormal degree detection of equipment. With the increase of m, the number of FB-NSA detectors, the time complexity, and space complexity increase. The parameterm=1/rscan meet the needs.To sum up, the abnormal degree of equipment with CFB-NSA can be defined as:(4)μA(t)=0t∈S2πarctan(rd)t∈N&d≤rd2πarctan(d+rd)t∈N&d>rdwheretis testing sample; rdis the radius of CFB-NSA detectors; d is the minimum distance betweentand CFB-NSA detectors.The radii of FB-NSA detectors are different in general. Therefore the radii of CFB-NSA detectors can be obtained by adjusting the radii of FB-NSA detectors. Linearization adjustment is one of the simplest ways to obtain the radii of CFB-NSA detectors. That is, the new center of a FB-NSA detector is on the line which is created between the two points. One is the old center of the FB-NSA detector, the other one is the center of its nearest self sample.The training algorithm of CFB-NSA is similar to that of FB-NSA, but the radii of CFB-NSA detectors require repeated adjustment and calculation. The training stage includes the following seven main steps.Step 1: To divide the state space.Step 2: To identify the property of hypercube.Step 3: To look for boundary hypercubes and code their position information.Step 4: To calculate the radius of FB-NSA detectors.Step 5: To calculate the average radius, and adjust the center of detectors.Step 6: To calculate the radius of detectors.Step 7: If all the detectors have the same radius, end the program. Otherwise go to Step 4.In order to determine the performance and possible advantages of FB-NSA and FFB-NSA, we carried out the experiments on 2-dimensional synthetic datasets and Iris data. Experiments were also carried out to compare the results obtained from other anomaly detection algorithms. Detection rate (DR) and false alarm rate (FA) are defined as follows:DR=TPTP+FN,FA=FPFP+TN,where TP, FN, FP, and TN are the counts of true positive, false negative, false positive, and true negative, respectively.Over the unit square [0,1]2, four shapes shown in Fig. 13are used as the self space in anomaly detection experiments [16,26].These experiments were mainly designed to demonstrate the difference among FB-NSA, FFB-NSA and V-detector. In [0,1]2, 10,000 points are generated randomly. The ring has 2633 self samples; the pentagram has 1610 self samples; the triangle has 2531 self samples; the cross has 3492 self samples, and the rest are non-self samples. 100 and 1000 self samples were randomly selected as training samples. The testing samples include 100 self samples which were randomly selected from the rest self samples, and 900 non-self samples which were randomly selected. The plot shows the mean of 100 repeated tests performed with the same parameters.Fig. 14shows the DR of the different self space among FB-NSA (m=40), FB-NSA (m=20), FFB-NSA (20–40) and V-detector (coverage 0.99) when all the other settings are the same.The DR decreases with the increase of rs. The non-self space covered by self samples increases with the increase of rs, thus leading to the lower detection rate.The DR decreases with the increase of the number of training samples. The non-self space covered by self samples increases with the increase of the number of training samples, and the holes between detectors and self space increase at the same time, thus leading to the lower detection rate.The DR of FB-NSA increases with the increase of m. The number of FB-NSA detectors increases and the size of FB-NSA detectors become small with the increase of m. These detectors can cover more holes, thus leading to the higher detection rate.In all the cases, DR(FB-NSA (m=40))>DR(FFB-NSA (20–40))>DR(FB-NSA (m=20)) due to the characteristics of FB-NSA and FFB-NSA, as explained in Section 3.2.In the vast majority of cases, DR(FB-NSA (m=20))>DR(V-detector (0.99)). Every time V-detector generates the detectors with different positions, sizes and quantities because these detectors are randomly generated. When the preset coverage is reached, V-detector stops generating detectors. The size of holes between these detectors and self space is varies. Therefore, some holes may be relatively big. FB-NSA and FFB-NSA generate the detectors with constant position, size and quantity, because these detectors are generated in non-random ways. When m is a constant value, these detectors are only related to the training samples, and have nothing to do with training times. The holes between these detectors and self space are constant, and there is no relatively big hole. Therefore, the detection rate of V-detector (0.99) is lower than that of FB-NSA (m=20).Fig. 15shows the FA of different self space among FB-NSA (m=40), FB-NSA (m=20), FFB-NSA (20–40) and V-detector (coverage 0.99) when all the other settings are the same.The FA decreases with the increase of rsand the number of training samples. The holes in self space decrease with the increase of rsand the number of training samples, thus leading to the lower false alarm rate.The FA of FB-NSA increases with the increase of m. The size of FB-NSA detectors becomes small with the increase of m. These detectors can recognize the holes which are in self space as non-self space, thus leading to the higher false alarm rate.In all the cases, FA(FB-NSA (m=40))>FA(FFB-NSA (20–40))>FA(FB-NSA (m=20)). The detectors of FB-NSA (m=20) is relatively big, and these detectors only cover a few holes in self space. The detectors of FB-NSA (m=40) is relatively small, and these detectors can recognize more holes in self space as non-self space. The number of small detectors of FFB-NSA (20–40) is more than that of FB-NSA (m=20), but less than that of FB-NSA (m=40). Therefore, the false alarm rate of FFB-NSA (20–40) is higher than that of FB-NSA (m=20), but lower than that of FB-NSA (m=40).In most cases, FA(FFB-NSA (20–40))>FA(V-detector) when the number of training samples is relatively small; FA(FFB-NSA (20–40))<FA(V-detector) when the number of training samples is relatively large. When the number of training samples is relatively small, the holes in self space are relatively big. FFB-NSA (20–40) can generate small detectors, which can recognize most of these holes as non-self space. Therefore, FA(FFB-NSA (20–40))>FA(V-detector) in this case. When the number of training samples is relatively large, the holes in self space are relatively small. FFB-NSA (20–40) detectors cannot cover majority of these holes, but the detectors of V-detector generated at random may cover partial of these holes. Therefore, FA(FFB-NSA (20–40))<FA(V-detector) in this case.Fig. 16shows the number of detectors of different self space among FB-NSA (m=40), FB-NSA (m=20), FFB-NSA (20–40) and V-detector (coverage 0.99) when all the other settings are the same.The number of detectors increases firstly and then decreases with the increase of rswhen the number of training samples is relatively small, and the number of detectors decreases with the increase of rswhen the number of training samples is relatively large. When the number of training samples is relatively small and rsis relatively small, there are less holes in self space, and the holes are relatively big. A few detectors are required for covering these holes. The number of holes in self space increases and the size of these holes become small with the increase of rs. More detectors are required for covering these holes. The number of the holes in self space decreases after rsincreases to a certain value. When the number of training samples is relatively large and rsis relatively small, there are many holes in self space, and the holes are relatively small. More detectors are required for covering these holes. The number of the holes in self space decreases with the increase of rs.The number of detectors increases with the increase of m with the same parameters due to the characteristics of FB-NSA.In all the cases, the detector number of FFB-NSA (20–40) is larger than that of FB-NSA (m=20), and smaller than that of FB-NSA (m=40) due to the characteristics of FB-NSA and FFB-NSA, as explained in Section 3.2.In most cases, the detector number of FFB-NSA (20–40) is smaller than that of V-detector in ring and cross shaped self space. In most cases, the detector number of FFB-NSA (20–40) is smaller than that of V-detector in pentagram and triangle shaped self space when rsis relatively small, and the detector number of V-detector is smaller than that of FFB-NSA (20–40) in pentagram and triangle shaped self space when rsis relatively large.In order to determine the advantages of FB-NSA and FFB-NSA, the comparison of FB-NSA, FFB-NSA and other anomaly detection algorithms is carried out on the famous benchmark Fisher's Iris Data. One of the three types of Iris data is considered as normal data, while the other two are considered as abnormal data. Fifty percent of normal data are randomly selected as the training data and other data are considered as the testing data. The results are the average values of 100 repeated tests obtained according to each method under the same parameter setting. Figs. 17–19show the complete influence trend of self radius on the results within the rsrange from 0 to 0.02.Fig. 17 shows the DR of the different self samples among FB-NSA (m=3), FB-NSA (m=6) and FFB-NSA (3–6) when all the other settings are the same.Fig. 17a shows that the all the DR is 100%, when Setosa is used as normal data and the other two are used as abnormal data. Because Setosa is linear separable with the others, the minimum distance between the samples in Versicolor and the samples in Virginica is shorter than rs. When rs≤0.2, there is no non-self sample covered by self samples.Fig. 17b and c shows that the DR decreases with the increase of rs. The results and causes are similar to that of 2-dimensional synthetic datasets.Fig. 18 shows the FA of the different self samples among FB-NSA (m=3), FB-NSA (m=6) and FFB-NSA (3–6) when all the other settings are the same. The results and causes are similar to that of 2-dimensional synthetic datasets.Fig. 19 shows the number of detectors of the different self samples among FB-NSA (m=3), FB-NSA (m=6) and FFB-NSA (3–6) when all the other settings are the same. The results and causes are similar to that of 2-dimensional synthetic datasets.Table 1shows the comparison of the famous benchmark Fisher's Iris Data. The comparison results are the average values of 100 repeated tests obtained according to each method under the same parameter setting. One of the three types of Iris data is considered as normal data, while the other two are considered as abnormal data. The normal data are either completely or partially used to train the system. The results of FB-NSA and FFB-NSA in Table 1 are obtained with rs=0.1 and the others are from previous reports [7,15,27]. I-detector and Self-Detector have the highest detection rate and false alarm rate. However, their testing algorithm indicates that they may belong to positive selection algorithm (PSA) rather than NSA. The ANSA needs fewer detectors, but its detection rate is relatively low. The results show that FFB-NSA (3–6) and FB-NSA (m=6) have the higher detection rate and lower false alarm rate. For the similar detection rate, the detector number of FFB-NSA (3–6) is smaller than that of other methods except PSA methods in most cases.In conclusion, DR(FB-NSA (m=n1))>DR(FFB-NSA (n1−n2))>DR(FB-NSA(m=n2)), where n1>n2. FA(FB-NSA (m=n1))>FA(FFB-NSA (n1−n2))>FA(FB-NSA (m=n2)). The detector number of FFB-NSA (n1−n2) is larger than that of FB-NSA (m=n2), and smaller than that of FB-NSA (m=n1). By adjusting m, the detection rate of FB-NSA and FFB-NSA can approximate that of V-detector with any detector coverage. When the detection rate of FFB-NSA is slightly higher than that of V-detector, the detector number of FFB-NSA is smaller than that of V-detector in most cases.In order to determine the performance and possible advantages of CFB-NSA, we carried out the experiments on the ball bearing fault data. The data is from fan end accelerometer data in bearing fault data set of Case Western Reserve University.The raw data is the time series data and analyze by “db16” wavelet for eight layers to get the high-frequency wavelet coefficients energy of each layer as the signal feature. Then 500 normal samples and 450 fault samples (every kind of fault has 50 samples) were generated. In order to improve the calculation speed, these samples were reduced to 4-dimension with PCA, and normalized to [0,1]4.50 self samples were randomly selected as training samples. The testing samples included 50 self samples randomly selected from the rest self samples, and all the fault samples. The radius of training sample is 0.15, and the parameter m=10. The plot shows the mean of 100 repeated tests performed with the same parameters.Fig. 20shows the abnormal degree distribution of different fault types with the same fault degree. Fig. 21shows the abnormal degree distribution of ball fault with different fault degree. Table 2shows the statistical result on the abnormal degree of different fault types.Figs. 20 and 21 show that detection rate of CFB-NSA is 100% and that the false alarm rate of CFB-NSA is 0%. Fig. 20 shows that the abnormal degree based on the CFB-NSA can be used to diagnose the fault of ball bearings, and that there are comparatively clear boundaries among all kinds of faults. There is a clear boundary between inner race 0.014′′ fault and ball 0.014′′ fault. The boundary between ball 0.014′′ fault and outer race 0.014′′ fault is blurred, but the mean abnormal degree of ball 0.014′′ fault is lower than that of outer race 0.014′′ fault. Fig. 21 shows that the abnormal degree based on the CFB-NSA can be used to diagnose the ball fault of ball bearings with different fault degrees. There is a clear boundary between ball 0.007′′ fault and ball 0.021′′ fault. The boundary between ball 0.014′′ fault and ball 0.021′′ fault is blurred, but the mean abnormal degree of ball 0.021′′ fault is lower than that of ball 0.014′′ fault.

@&#CONCLUSIONS@&#
In this paper, we proposed two negative selection algorithms with constant detectors for anomaly detection: Boundary-Fixed Negative Selection Algorithm (FB-NSA) and Fine Boundary-Fixed Negative Selection Algorithm (FFB-NSA). FB-NSA and FFB-NSA generate a layer of detectors, which are around the self space. Self samples are on one side of the detectors, and non-self samples are on the other side of detectors or within detectors. The detectors of FB-NSA and FFB-NSA are generated in nonrandom ways and have constant position, size and quantity, when the training samples and m are constant.We carried out the experiments on 2-dimensional data and Fisher's Iris data to demonstrate the performances of FB-NSA and FFB-NSA. FFB-NSA with a reasonable m, has the higher detection rate and fewer detectors compared to other anomaly detection algorithms in which the detectors are randomly generated.CFB-NSA can describe the abnormal degree of non-self samples. The experiment result of ball bearing shows that CFB-NSA can be used to effectively identify the abnormal state of mechanical equipment. CFB-NSA is an effective method to detect the abnormal degree of mechanical equipment.It is noteworthy that the FB-NSA and FFB-NSA are incomplete. It is necessary to develop other algorithms to reduce the time and space complexities and extend their application scopes. It is possible to further study on online adaptive learning of NSA, because the constant detectors can adjust in local area and require no retraining.