@&#MAIN-TITLE@&#
A robust optimization approach to energy and reserve dispatch in electricity markets

@&#HIGHLIGHTS@&#
We determine electrical energy and reserve dispatch via adaptive robust optimization.A novel reformulation is proposed to account for general polyhedral uncertainty sets.We compare robust optimization, stochastic programming and deterministic approaches.The proposed model gradually trades off optimality in expectation with risk aversion.The robust optimization approach scales well with the size of the power system.

@&#KEYPHRASES@&#
OR in energy,Robust optimization,Decomposition,Electricity market,Renewable energy,

@&#ABSTRACT@&#
To a large extent, electricity markets worldwide still rely on deterministic procedures for clearing energy and reserve auctions. However, increasing shares of the production mix consist of renewable sources whose nature is stochastic and non-dispatchable, as their output is uncertain and cannot be controlled by the operators of the production units. Stochastic programming models allow the joint determination of the day-ahead energy and reserve dispatch accounting for the uncertainty in the output from these sources. However, the size of these models gets quickly out of hand as a large number of scenarios are needed to properly represent the uncertainty. In this work, we take an alternative approach and cast the problem as an adaptive robust optimization problem. The resulting day-ahead energy and reserve schedules yield the minimum system cost, accounting for the cost of the redispatch decisions at the balancing (real-time) stage, in the worst-case realization of the stochastic production within a specified uncertainty set. We propose a novel reformulation of the problem that allows considering general polyhedral uncertainty sets. In a case-study, we show that, in comparison to a risk-averse stochastic programming model, the robust optimization approach progressively trades off optimality in expectation with improved performance in terms of risk. These differences, however, gradually taper off as the level of risk-aversion increases for the stochastic programming approach. Computational studies show that the robust optimization model scales well with the size of the power system, which is promising in view of real-world applications of this approach.

@&#INTRODUCTION@&#
In recent years, renewable electricity production sources have experienced an unprecedented growth in installed capacity worldwide. Such a development is explained both by technological advance, which has made production from sources like wind and solar cheaper, and by governmental support aimed at promoting sustainability. Sources of this type are fundamentally different from conventional means of electricity generation. Indeed, they are stochastic, i.e., their production is not known with certainty in advance, and non-dispatchable, i.e., the power plant operators have partial or no control on the output level.Owing to the features described above, an increasing penetration of renewables challenges the traditional way electricity markets are operated. In particular, deterministic schemes have been employed for years to assess the amount of reserve capacity, the availability of which is needed in order to cope with unforeseen events in the system. Typically, mechanisms for reserve determination are based on deterministicn−1orn−kcriteria, which guarantee the functioning of an n-unit system in the event of loss of the largest unit, or of the k largest units in the system, respectively. As the penetration of stochastic generation sources in power system grows, reserves are increasingly used to cover the fluctuations of the power output from renewables, thus calling for stochastic decision-making tools.In parallel, market-clearing procedures for energy markets are also challenged by the growth of stochastic production capacity. For example, the day-ahead market is cleared according to a deterministic least-cost dispatch principle based on the offers and bids submitted by suppliers and consumers. Stochastic production is normally dispatched at a point forecast of its output distribution. However, this procedure does not account for the projected cost of the dispatch at the balancing stage, and is therefore suboptimal, see Pritchard, Zakeri, and Philpott (2010).The existing literature on the subject, see Morales, Conejo, and Pérez-Ruiz (2009), shows that system cost can be significantly reduced in expectation by jointly optimizing the day-ahead dispatch and the reserve in a stochastic programming framework (Birge & Louveaux, 2011). However, models of this type exhibit two important drawbacks. Firstly, to represent the uncertain parameters, e.g., the uncertain production at different locations in the grid, a number of scenarios need to be fabricated, usually by fitting distribution functions to historical data. This is a complex process that may result in a distorted representation of the uncertainty, especially if many dependent uncertain parameters need to be represented. Secondly, the number of scenarios required to achieve an accurate representation of the uncertain parameters is large, which generally involves high computational burden and eventual intractability.An alternative framework to stochastic programming for dealing with problems under uncertainty is robust optimization, see Bertsimas, Brown, and Caramanis (2011). This framework for decision-making under uncertainty does not require scenarios. Indeed, the uncertain parameters are represented through uncertainty sets, directly derived from the historical data without resorting to scenarios. This generally results in computationally tractable models with appropriate flexibility in terms of conservatism. A robust solution must be feasible for any realization of the uncertainty, and optimal in the worst-case choice of the stochastic parameters in the uncertainty set. The equivalent of stochastic programming with recourse in robust optimization is adaptive robust optimization. This framework aims at minimizing the total cost in the worst-case realization of the stochastic parameters, assuming that recourse actions can be taken as a response to the uncertainty.The modeling effort is reduced in robust optimization to a description of a meaningful set over which the uncertain parameters may take values in, i.e., the support of the density function rather than the full probability distribution required by the stochastic programming approach. As the number of stochastic production facilities grows in an electric energy system, the level of uncertain dependent parameters dramatically increases, which, unless drastic simplifications are implemented, leads to intractable stochastic programming models. On the contrary, the difficulty in solving robust optimization models does not increase significantly with the number of uncertain dependent parameters, and thus robust optimization is particularly suited to attack the considered problem in this paper: the development of a market clearing algorithm under a highly uncertain production.Recent applications of adaptive robust optimization focusing on unit commitment in electricity markets are presented in Bertsimas, Litvinov, Sun, Zhao, and Zheng (2012), Furini, Laguna, and Samorani (2012), Jiang, Wang, and Guan (2012), Jiang, Zhang, Li, and Guan (2014), Zhao and Zeng (2012) , which study the problem under uncertain load or production from stochastic sources. In all these works, a cutting-plane approach is employed to exploit the convex dependence of the objective function on the first-stage decision, see Thiele, Terry, and Epelman (2010). Then, the max-min problem resulting from the sequential enforcement of the worst-case (maximum-cost or maximum-regret in the case of Furini et al. (2012)) parameter realization and decision on the optimal recourse action is cast as a single-level bilinear program. This problem is then solved either with an heuristic (outer-approximation in Bertsimas et al. (2012)), or as a Mixed Integer Linear Program (MILP) after linearization through binary expansion (Jiang et al., 2012; Zhao & Zeng, 2012). Both approaches are considered and compared in Jiang et al. (2014). Different, though related, applications of two-stage robust optimization in electricity markets include unit commitment considering contingencies (Guan & Wang, 2014) and the self-scheduling and trading for a virtual power plant (Lima, Novais, & Conejo, 2015).Considering the above framework, the main features of the model presented in this paper are threefold:1.We apply adaptive robust optimization to the problem of determining the optimal day-ahead energy and reserve dispatch in a single time-period, rather than to unit commitment. The problem we consider is relevant since, as Section 2 clarifies, it resembles the current design of electricity markets in Europe, where decisions on unit commitment are left to the power producers, and the market operator determines sequentially the amount of reserves needed and the optimal day-ahead energy dispatch. Note that the extension of the proposed model to a multi-period setting does not entail any conceptual complication but only computational ones. We propose the joint determination of day-ahead energy and reserve dispatch akin to the one in Morales et al. (2009), though in a robust optimization framework.We propose a reformulation of the inner max–min problem for the determination of the uncertainty and recourse decision that can accommodate general polyhedral sets for the uncertainty and converges to an exact solution. Our approach is more flexible than the binary reformulation in Jiang et al. (2012, 2014); Zhao and Zeng (2012) in that, differently from those models, it allows to model any polyhedral uncertainty set rather than a budget uncertainty set, still using a comparable number of binary variables. Note that this additional flexibility allows the modeler to design uncertainty sets of smaller size, though still able to encompass all the relevant realizations of the uncertainty. In turn, the reduced size of the uncertainty set may decrease the conservativeness of the solution, and thus its suboptimality in expectation, see Guan and Wang (2014). In comparison to the heuristic approach in Bertsimas et al. (2012), Jiang et al. (2014), which is more flexible with respect to the choice of the uncertainty set, our reformulation guarantees convergence to an optimal solution.We compare the results obtained from the robust optimization approach with the ones from corresponding deterministic and stochastic programming versions of the model, considering for the latter both the risk-neutral and the risk-averse cases. Another original feature of this work is that these comparisons are based on a battery of case-studies where real-world data for wind power production are employed within standard IEEE power system models.The structure of the paper is the following. Section 2 briefly describes the design of American and European electricity markets, and relates them to the market framework considered in this paper. In Section 3, we introduce the formulation of the problem. Algorithms for solving this problem are then described in Section 4. Section 5 presents results from a simple illustrative example and from a larger case study based on the 24-node IEEE Reliability Test System in Grigg et al. (1999), as well as computational results based on case-studies involving networks of different sizes. Finally, conclusions are presented in Section 6.Electricity markets throughout the world generally operate as pools or exchanges, and include two trading floors: the day-ahead market and the real-time or balancing market. The day-ahead market clears 12–36 hours in advance of electrical energy delivery, and involves firm financial obligations. The output of the day-ahead market clearing is the energy production and consumption schedules as well as the electricity prices. The real-time market clears minutes prior to electrical energy delivery and makes it possible to balance supply and demand. The real-time market is particularly relevant because electrical energy cannot be stored in significant quantities, and for a number of important technical reasons, supply and demand should be balanced at any time. In addition to energy, an important commodity is also traded in the day-ahead market: reserve. Reserve involves the ability by certain facilities to increase or reduce production to guarantee energy balance at any time. Reserve of the former type, i.e., for production increase, is referred to as upward reserve, while the latter one, i.e., for production reduction, as downward reserve.In most American markets, reserve and electrical energy are cleared in the day-ahead market, once producers and consumers submit production offers and demand bids. The market is cleared using an appropriate market clearing algorithm, and clearing prices are fabricated disregarding non-convexities, notoriously those pertaining to the start-up and shut-down costs of the production units. Ad-hoc, heuristic procedures are then used to compensate producers for start-up and shut-down cost. As part of clearing the market, the operator – denoted as Independent Systems Operator or ISO – decides on the start-up and shut-down of the production units. Production offers by producers are supposed to be close to actual marginal costs and the regulator has the obligation to monitor the market to verify that this is the case.Most European markets work as their American counterparts, but with a fundamental difference: producers keep the right to start-up and shut-down their own production facilities at their will, provided that they comply with their market clearing obligations. Since these producers do not receive out-of-the-market compensation for start-up and shut-down costs, they are allowed (by the regulator) to submit production offers above marginal costs. Such production offers should internalize start-up and shut-down costs.Another fundamental difference among American and European markets is that most American markets include in the market clearing algorithms a detailed representation of the transmission network, which renders market clearing solutions that comply with transmission limits. On the contrary, most European markets, pursuing simplicity, do not represent the transmission networks in their market clearing algorithms. This generally results in market clearing outcomes that violate network limits, which require ad-hoc heuristic adjustments outside the market, and necessarily renders suboptimal solutions.Considering the above framework, the market clearing algorithm proposed in this paper relies on the following hypothesis:1.As in most currently operating electric energy markets, the considered market is based on a pool that includes a day-ahead auction and a real time one.The reserve market is cleared jointly with the day-ahead market. This practice is common in many American markets, and will be paramount for the large-scale integration of stochastic renewable sources, as it can improve significantly the efficiency of power system operations, see Morales et al. (2009).As in most American markets, the proposed market clearing algorithm incorporates a detailed representation on the transmission network.As in most European markets, the proposed market clearing algorithm gives producers the right to start-up and shut-down their production facilities at their will, provided that they comply with their market obligations.In short, the proposed clearing algorithm applies to most European markets if transmission constraints are disregarded, and to most American markets if the right to start-up and shut-down production facilities is transferred from the owners of such facilities to the ISO.When an electric energy system includes stochastic production sources, the joint determination of the optimal day-ahead energy and reserve dispatch can be formulated as the following optimization problem under uncertainty:(1a)minp,r+,r−,δ0∑kCkpk+Ck+rk++Ck−rk−+QW(p,r+,r−,δ0)(1b)s.t.∑k∈Gipk=∑j∈NiBij(δi0−δj0)+ds(i)−w^q(i),∀i,(1c)δ10=0,(1d)pk+rk+≤Pkmax,∀k,(1e)pk−rk−≥0,∀k,(1f)Bij(δi0−δj0)≤Tijmax,∀i,j∈Ni,(1g)pk,rk+,rk−≥0,∀k,where pk,rk+andrk−are the dispatch of electricity, upward and downward reserve, respectively, for unit k, whileδi0is the state variable (voltage angle) at node i of the network. Constraints (1d) and (1e) ensure that the combination of energy and reserve dispatch neither exceeds the production capacity,Pkmax,nor is negative, respectively. Inequalities (1f) enforce that the flow of electricity from node i to j in the left-hand-side is not larger than the transmission capacityTijmax. Non-negativity of dispatch is imposed in (1g), while (1c) sets node 1 as the reference by forcing its state variable to 0. Nodal power balance is enforced by (1b), which guarantees that the total electricity dispatch of the units Gilocated at node i is equal to the sum of planned net power flow from i to all the neighboring nodes Ni, the consumption from the demand located at the node (indexed by s(i), possibly an empty set) minus the forecast stochastic power production from the production site located at the node (indexed by q(i), possibly an empty set). The first three terms in the objective function represent the dispatch costs of electricity as well as upward and downward reserve (with linear cost coefficients Ck,Ck+andCk−,respectively). The last termQW(p,r+,r−,δ0)is a measure of the cost of redispatch at the balancing market, which in turn is a function of the day-ahead schedule as indicated by the dependence onp,r+,r−,δ0. Such a measure is also parameterized on the distributionWof the uncertainty, in this case, stochastic power generation.At the balancing market, the actual deviations, Δwq(i), of stochastic power production from the forecasts,w^q(i),become known and the system operator must redispatch the system accordingly. The optimal redispatch cost is the objective function value of the following optimization problem:(2a)minp+,p−,lsh,wsp,δ∑kCk(pk+−pk−)+∑sVshlssh(2b)s.t.∑k∈Gi(pk+−pk−)+ls(i)sh+Δwq(i)−wq(i)sp=∑j∈NiBij(δi−δi0−δj+δj0),∀i,(2c)δ1=0,(2d)pk+≤rk+,∀k,(2e)pk−≤rk−,∀k,(2f)lssh≤ds,∀s,(2g)wqsp≤w^q+Δwq,∀q,(2h)Bij(δi−δj)≤Tijmax∀i,j∈Ni,(2i)pk+,pk−≥0,∀k,lssh≥0,∀s,wqsp≥0,∀q.Constraints (2d) and (2e) impose that the upward and downward deviations,pk+andpk−,from the day-ahead electricity dispatch, pk, are not larger than the respective reserves allocated at the day-ahead stage. According to (2f), load-shedding (i.e., the forced disconnection of demand that cannot be supplied) for demand s,lssh,must be at most equal to the actual consumption. Similarly, stochastic power spillage,wqsp,from each production site q must be smaller than or equal to the actual production as a result of (2g). Transmission limits for real-time power flows resulting from the actual network states, δi, are enforced by (2h), while (2c) confirms node 1 as the reference node. Eq. (2b) ensures that the power redispatch at each node i is equal to the sum of the additional net flow out of the node with the error of stochastic power prediction. Combined with (1b), (2b) imposes the nodal power balance condition at the balancing market stage. The objective function (2a) is given by the cost or benefit of upward or downward redispatch, summed with a penalty for load-shedding.Within a stochastic programming approach (Birge & Louveaux, 2011),QW(p,r+,r−,δ0)would be determined as the expectation or the conditional value at risk (or a combination of these) over a discrete set of scenarios approximating the actual distribution of the uncertain deviation of stochastic power production Δwq(i) from the forecast. In a robust optimization framework, instead, we seek to minimize the recourse cost in the worst-case realization of the stochastic parameters within an uncertainty set. As we shall see later in this section, this requires the solution of a three-level min-max-min optimization problem, where the top- and the bottom-level problems correspond to the minimization of dispatch and redispatch cost, respectively, and the maximization problem to the search of the worst-case realization of the uncertainty. We refer the reader to Morales, Conejo, Madsen, Pinson, and Zugno (2014) for more detail on the problem of dispatching energy and reserve.Indicating all the first-stage (i.e., day-ahead) decision variablesp,r+,r−,δ0with the vectorx,we can write (1) compactly as(3a)minxcxTx+QW(x)(3b)s.t.Fx=d−w^,(3c)Gx≥g,where (3b) includes Eqs. (1b) and (1c), while (3c) group the inequality constraints (1d)–(1g).Let the vectoryinclude the recourse variablesp+,p−,lsh,wsp,δ(i.e., pertaining to the balancing market stage). The determination of the worst-case recourse cost, or redispatch cost, writes as the following max–min programming problem, parameterized on the first-stage decisionx:(4a)QW(x)=maxΔwminycyTy(4b)s.t.Py=−Δw−Qx,:λ,(4c)Ly≥l−Mx−NΔw,:μ,(4d)s.t.HΔw≤h.Model (4) has a max-min structure that allows the determination of the minimum recourse cost in the worst-case realization of the uncertainty. Indeed, the maximization problem chooses the worst-case realization of deviationΔwof stochastic power production from its conditional mean forecast within the polyhedral uncertainty set defined by the set (4d) of linear inequalities. After the worst-case realization of the uncertainty is chosen, the recourse cost is minimized in the min problem in (4a), that corresponds to (2a). The set of equations (4b) includes (2b) and (2c), while (4c) group inequalities (2d)–(2i).The formulation in the above section cannot be immediately employed in practice. Indeed, the direct substitution ofQW(x)as defined in (4) into (3) results in a min-max-min problem, for which a general-purpose solution algorithm is not available. However, following the derivations in Bertsimas et al. (2012), Jiang et al. (2012) and Zhao and Zeng (2012), it is possible to reformulate it as a min-max-max problem by substituting the right-hand side max problem with its dual. This results in the following formulation:(5a)minxcxTx+maxΔwmaxλ,μ(−Δw−Qx)Tλ+(l−Mx−NΔw)Tμ(5b)s.t.PTλ+LTμ=cy,(5c)μ≥0,(5d)s.t.HΔw≤h,(5e)s.t.Fx=d−w^,(5f)Gx≥g.It should be noticed that model (5) is in fact a min–max programming problem. Indeed, the mid- and right-hand-side maximization problems can be merged into a single maximization problem in the optimization variablesΔw,λandμ. Furthermore, we point out that the optimization problem resulting from this merging is a bilinear one, as it involves cross-products betweenΔwand the lower-level decision variablesλandμin the objective function (5a).We conclude this section with the following two observations, which will turn out to be useful in Section 4.1.The problem resulting from the merging of the mid and the right-hand-side maximization problems (5a)–(5d) is bilinear and defined over a polyhedral set. As a consequence, its optimal solution is one of the vertices of this set.Since the vectorxof day-ahead decision variables only appears in the objective function and not in the constraints, the polyhedral feasible region is independent of the day-ahead decision, and hence it has a finite number of vertices.We consider again formulation (5). We notice that it is possible to swap the order of the mid and right-hand-side maximization problems, thus first optimizing over the variablesλ, μ, and then overΔw. Furthermore, not all the terms of the objective function depend onΔw,and the constraints are separable for the two sets of variables. As a result, we can reformulate (5) as follows:(6a)minxcxTx+maxλ,μ−(Qx)Tλ+(l−Mx)Tμ+maxΔw−(λT+μTN)Δw(6b)s.t.HΔw≤h,:ξ,(6c)s.t.PTλ+LTμ=cy,(6d)μ≥0,(6e)s.t.Fx=d−w^,(6f)Gx≥g,where we indicate withξthe set of dual variables relative to constraints (6b) for the right-hand-side maximization problem.The max-max problem comprising the mid and the right-hand-side optimization problems in (6) can be cast as a Mathematical Program with Equilibrium Constraints (MPEC), see Gabriel, Conejo, Fuller, Hobbs, and Ruiz (2012). However, before doing so, we point out that since the right-hand-side maximization problem is linear, the strong duality theorem holds. Therefore, the following relationship holds at optimality:(7)−(λT+μTN)Δw=hTξ.Differently from the term on the left-hand side of (7), the one on the right-hand side is linear, as it does not involve cross-products between optimization variables. Therefore, considering (6) and (7) renders the problem below whose objective function is linear in the optimization variables:(8a)minxcxTx+maxλ,μ,Δw,ξ−(Qx)Tλ+(l−Mx)Tμ+hTξ(8b)s.t.0≤ξ⊥h−HΔw≥0,(8c)HTξ=−λ−NTμ,(8d)PTλ+LTμ=cy,(8e)μ≥0,(8f)s.t.Fx=d−w^,(8g)Gx≥g.Finally, notice that formulations (3)–(4), (5) and (8) are equivalent.Reformulation (8) as a min-max problem with equilibrium constraints allows us to solve the energy and reserve dispatch problem (3)–(4) under any definition of the uncertainty set for stochastic power production as a polyhedron, defined by a set of linear inequalities HΔw ≤ h. Without loss of generality, uncertainty sets of the following type will be considered in the following:(9a)Δwq=Δwq+−Δwq−,∀q,(9b)0≤Δwq+≤Δwqmax,∀q,(9c)0≤Δwq−≤Δwqmax,∀q,(9d)∑qΔwq++Δwq−Δwqmax≤Γ,(9e)ΔwqΔwqmax−ΔwuΔwumax≤ρqu,∀q,u∈Wq.The set defined by (9) is a refined version of the budget uncertainty set, which is a well known concept in robust optimization (Bertsimas et al., 2011). The deviation of stochastic power production is split into its positive and negative parts by (9a). Inequalities (9b)–(9c) enforce upper and lower bounds, assumed symmetric here without loss of generality, for this deviation. Constraint (9d) defines the so-called budget of uncertainty, Γ. This constraint ensures that the sum of the absolute values of deviations of stochastic power production, after normalization to their maximum value, across all locations q does not exceed the budget, Γ. This assumption makes particular sense in this application, as unforeseen deviations of stochastic power production from a day-ahead forecast are largely due to weather phenomena that occur on a local scale, and therefore have a limited effect on the overall production in a large power system.Constraints (9e) are a way to enforce spatial correlation between stochastic production facilities at nodes q and u, for each u within the set Wqof neighboring sites to q. Such constraints limit the normalized deviation of actual production from these sites to ρqu. Intuitively, owing to the local scale of the weather phenomena driving the deviation of the actual stochastic power production from the considered day-ahead point forecast, one may expect that such deviations be in the same direction and of similar size for neighboring sites. Note that a similar approach to defining uncertainty sets that account for spatial correlation of stochastic production sources is proposed in Guan and Wang (2014).We remark that the standard bilinear formulation (5) of the inner problem would not allow for an exact solution under definition (9) of the uncertainty set. Indeed, the exact solution schemes in Jiang et al. (2012) and Zhao and Zeng (2012) are based on a binary expansion of the deviations that relies on the uncertainty set being of the budget type, i.e., they do not allow for imposing more general constraints such as (9e). Within our formulation, convergence to an exact solution is guaranteed.In this section, we report the extended formulation of the inner maximization problem with equilibrium constraints (8) corresponding to the max–min problem (4), with the definition of the uncertainty set (9) and of the recourse problem as (2). Let us define the following set of optimization variables :(10)Θ={λ,ν,μ+,μ−,ϵsh,ϵsp,σ,Δw,Δw+,Δw−,×γ,ξ+,ξ−,η,ω,i},whereλ,ν,μ+,μ−,ϵsh,ϵsp,σrepresent the dual variables of (2b), (2c), (2d), (2e), (2f), (2g) and (2h), respectively, whileγ,ξ+,ξ−,η,ωthe dual variables of (9a), of the upper bounds in (9b) and (9c), as well as of (9d) and (9e), respectively. The vector i is a collection of binary variables needed to linearize the complementarity conditions according to the reformulation proposed in Fortuny-Amat and McCarl (1981). After performing the appropriate transformations, the following MILP model is obtained:(11a)maxΘ∑i−λi∑j∈NiBij(δi0−δj0)+∑k(μk+rk++μk−rk−)(11b)+∑sdsϵssh+∑qw^qϵqsp+∑i,j∈NiTijmaxσij(11c)+∑qΔwqmax(ξq++ξq−)+Γη+∑q,u∈Wqρquωqu(11d)s.t.Δwq=Δwq+−Δwq−,∀q,(11e)0≤ξq+≤Mq1diq1,0≤Δwqmax−Δwq+≤Mq1p(1−iq1),∀q,(11f)0≤ξq−≤Mq2diq2,0≤Δwqmax−Δwq−≤Mq2p(1−iq2),∀q,(11g)0≤η≤M3di3,0≤Γ−∑qΔwq++Δwq−Δwqmax≤M3p(1−i3),(11h)0≤ωqu≤Mqu4diqu4,0≤ρqu−ΔwqΔwqmax+ΔwuΔwumax≤Mqu4p(1−iqu4),∀q,u∈Wq,(11i)γq+∑u∈Wqωqu−ωuqΔwqmax+λq(i)−ϵqsp=0∀q,(11j)0≤Δwq+≤Mq5piq5,0≤ξq+−γq+ηΔwqmax≤Mq5d(1−iq5),∀q,(11k)0≤Δwq−≤Mq6piq6,0≤γq+ξq−+ηΔwqmax≤Mq6d(1−iq6),∀q,(11l)λi(k)+μk+≤Ck,∀k,(11m)−λi(k)+μk−≤−Ck,∀k,(11n)λi(s)+ϵssh≤Vsh,∀s,(11o)−λi(q)+ϵqsp≤0,∀q,(11p)ν−(∑j∈N1B1j)λ1+(∑j∈N1B1jλj)+∑j∈N1B1j(σ1j−σj1)=0,(11q)−(∑j∈NiBij)λi+(∑j∈NiBijλj)+∑j∈NiBij(σij−σji)=0,∀i≠1,(11r)μk+,μk−≤0,∀k,ϵssh≤0,∀s,ϵqsp≤0,∀q,σij≤0,∀i,j∈Ni,(11s)iq1,iq2,iq5,iq6∈{0,1},∀q,i3∈{0,1},iqu4,∀q,u∈Wq.Note that (11e)–(11h), (11j) and (11k) represent the complementarity conditions (8b) as a set of linear constraints involving both continuous and binary variables. The parameters in these constraints denoted by M with relevant indices and superscripts are “big-M” constants. Their value should be set large enough so that the optimal solution of the innermost maximization problem in (6) is not cut out of the feasible region of (11e)–(11h), (11j)–(11k). However, the choice on their value should be made with care, since too high values for the “big-M” constants would worsen the computational performance of the MILP solver (Gabriel et al., 2012).In this section, we present two iterative schemes to solve the min–max–min problem (3)–(4), both of which are based on the cutting-plane algorithm in Kelley (1960) within a Benders’ decomposition scheme (Conejo, Castillo, Mínguez, & García-Bertrand, 2006).We consider reformulation (5). Due to the observations in the last paragraph of Section 3.1, the solution to the inner level bilinear maximization problem belongs to a set of finite cardinality K, which does not depend on the first-stage decisions. Indicating the elements of this set as (Δwk,λk,μk), withk=1,⋯,K,we can reformulate problem (3) and (4) as follows:(12a)minx,βcxTx+β(12b)s.t.β≥−ΔwkTλk+(l−NΔwk)Tμk−(λkQ+μkM)x,∀k,(12c)Fx=d−w^,(12d)Gx≥g.As one can see, the term β in the objective function is bounded from below by the pointwise maximum of a finite set of linear functions in the first-stage decision variablesx. This implies that the optimal objective function value of (12) is a convex, piecewise linear function inx. The following cutting-plane algorithm, proposed for robust optimization problems with recourse by Thiele et al. (2010), is guaranteed to converge to the optimal solution in a finite number of steps.1.Set upper and lower boundsUB=+∞andLB=−∞,and initialize the iteration index i ← 1.Define the relaxed master problem (MP) as the minimization of (12a), subject to (12c) and (12d), and fix a reasonable lower bound for β, i.e., lower than the expected objective value of the inner problem. Fix a feasible solution(x1*,β1*)to the relaxed MP.Solve either the following subproblem(13a)SP1:maxΔw,λ,μ(−Δw−Qxi*)Tλ+(l−Mxi*−NΔw)Tμ(13b)s.t.PTλ+LTμ=cy,(13c)μ≥0,(13d)HΔw≤h,or(14a)SP2:maxλ,μ,Δw,ξ−(Qxi*)Tλ+(l−Mxi*)Tμ+hTξ(14b)s.t.0≤ξ⊥h−HΔw≥0,(14c)HTξ=−λ−NTμ,(14d)PTλ+LTμ=cy,(14e)μ≥0.Notice that (13a) and (14a) correspond to the merging of the mid and right-hand-side optimization problems in (5), and to the right-hand-side problem in (8), respectively, where the first-stage variables are fixed. Let us indicate the optimal SP objective function value asziSP*. Update the upper boundUB=min{UB,cxxi*+ziSP*}. Add to the relaxed MP the Benders cut (12b) corresponding to the SP solution(Δwi*,λi*,μi*)determined at this stage.Solve the relaxed MP, fixxi+1*at the solution andzi+1MP*at the objective function value. UpdateLB=zi+1MP*.IfUB−LB<τ,where τ is a small tolerance value, then stop. Otherwise, updatei←i+1and go back to 3.The above approach is named Benders-dual cutting plane algorithm in Zeng and Zhao (2013), since the cuts generated in step 3 of the algorithm above are based on the optimal dual solution of the lower-level problem in (4).It should be remarked that subproblem (13a), i.e., SP1, is bilinear, which makes it particularly hard to solve to optimality for a generic polyhedral uncertainty set. In the literature, this approach has been followed either considering specific types of uncertainty sets, i.e., the budget uncertainty set used by Jiang et al. (2012); Zhao and Zeng (2012), Jiang et al. (2014), or by employing methods converging to a local optimum (Bertsimas et al., 2012; Jiang et al., 2014). In contrast to these references, we propose the use of subproblem (14a), i.e., SP2, within the described cutting-plane algorithm. This allows us to solve the subproblem to optimality without having to make any further assumption on the structure of the uncertainty set (besides the fact that it must be polyhedral).Finally, observe that there is another way to achieve the same degree of flexibility of formulation (14a) in the definition of the uncertainty set: by formulating problem (4) directly as an MPEC, and casting it as an MILP through the big-M reformulation. However, this would result in a much larger number of binary variables than the approach considered through formulation (14a). Indeed, (4c) includes a large number of inequality constraints (e.g., unit minimum and maximum power outputs and transmission capacity limits), which would generate an equally large number of complementarity conditions to be linearized by using binary variables. Thus, the proposed formulation (14a) reconciles flexibility in the definition of the uncertainty set with tractability of the resulting MILP subproblem, which has a moderate size in terms of binary variables.Similarly to the previous approach, the primal cut algorithm (Zeng & Zhao, 2013) is based on the fact that the solution to the lower-level optimization problem in (5) is at one of the vertices of the feasibility set. Because the feasibility set forΔwis completely decoupled from the feasibility set of the variables (λ, μ), the worst-case realization of the uncertaintyΔwis at a vertex of its feasibility set defined byHΔw≤h.We indicate withΔwkthe vertices of the feasibility set for the uncertain stochastic power productionΔw,and assign a copyykof the vector of recourse decision variables to each of these vertices. Hence, one can reformulate problem (3) and (4) in the following way:(15a)minx,yk,βcxTx+β(15b)s.t.β≥cyTyk,∀k,(15c)Pyk=−Δwk−Qx,∀k,(15d)Lyk≥l−Mx−NΔwk,∀k,(15e)Fx=d−w^,(15f)Gx≥g.Notice that cuts (15b) are affine in the primal recourse variablesyk,as opposed to cuts (12b), which depend on the dual variables. Besides, we remark that there is a copy ykof the recourse variables and of constraints (15b), (15c) and (15d) for each vertexΔwk.The following comments are in order:1.Differently from (12), model (15) includes energy redispatch, load shedding, stochastic power spillage, and network state variables at the balancing stage as decision variables. Furthermore, there is one such set of decisions for each vertex of the uncertainty set.The number of vertices, and therefore of Benders cuts, in (15) is smaller than that in (12). This is because in (15) there is one Benders cut per vertex of the uncertainty set, and not per vertex of the joint feasibility set of (Δw, λ, μ), which has higher dimensionality.The increase in size of the relaxed MP in a Benders scheme is significant every time a vertex is added to the MP. Indeed, this entails adding a set of balancing market variables (recourse for a specific realization of the uncertainty), as well as a Benders cut (15b) and a set of feasibility constraints (15c)–(15d) for the balancing stage.The primal cut algorithm is akin to the one described in Section 4.1, with the following differences:•The master problem used in step 2 of every iteration of the algorithm is a relaxation of (15), i.e., it has a reduced set of recourse variablesykand of constraints (15b)–(15d). At the first iteration, the master problem consists exclusively of (15a), (15e) and (15f) and a lower bound for β.At the end of step 3, we add a setykof recourse variables and a set of constraints (15b)–(15d), where we fixΔwat the current solutionΔwi*of the subproblem.As documented in Zeng and Zhao (2013) and Zhao and Zeng (2012), the primal cut algorithm, which is the one used in this work, generally guarantees a faster convergence to the optimal solution than the Benders-dual cutting plane one.To our knowledge, the existing literature exclusively considers subproblem (13a) within the cutting-plane algorithms described in Sections 4.1 and 4.2. The solution of this optimization problem is far from being trivial, since the presence of bilinear terms in the objective function (5a) renders the problem non-convex. In Bertsimas et al. (2012), an outer-approximation algorithm is proposed to solve this problem with general uncertainty sets. However, since the subproblem is non-convex, only local convergence is guaranteed for this method. As an alternative, exact linearization methods based on the use of integer variables are proposed in Jiang et al. (2012) and Zhao and Zeng (2012). However, the uncertainty set is restricted to the particular case of polyhedral budget sets.In this work, we propose the use of subproblem (14a). The only nonlinearity in this problem is the presence of complementarity conditions (14b), where the ⊥ operator implies thatξ(h−HΔw)=0. In (11), we linearized these complementarity conditions by making use of binary variables as proposed by Fortuny-Amat and McCarl (1981). Alternatively, one could employ the approach of Siddiqui and Gabriel (2013), which is based on SOS-1 variables.In comparison to the models in Jiang et al. (2012), Zhao and Zeng (2012) and Bertsimas et al. (2012), the proposed model has the following characteristics. As compared to the method in Bertsimas et al. (2012), our approach converges to the global optimal solution. However, the model in Bertsimas et al. (2012) considers general convex uncertainty set, while our model is valid for any type of polyhedral set.In comparison to the approach in Jiang et al. (2012) and Zhao and Zeng (2012), our approach retains the convergence to the global optimum while allowing us to consider any type of polyhedral sets. Indeed, note that the reformulation of the complementarity constraints as linear inequalities involving continuous and binary variables performed in (11) is valid for any polyhedral uncertainty set. The approach in Jiang et al. (2012) and Zhao and Zeng (2012) is based on a discretization of the deviation of stochastic power production, which is redefined as the product of binary variables with the maximum/minimum allowed deviation. Contrary to our approach, such a discretization only holds for budget uncertainty sets defined by (9a)–(9d). Other types of constraints, e.g., the correlation constraints (9e), may imply that the worst-case realization of the stochastic production be “fractional” in the sense that it is neither 0 nor the maximum/minimum value at some locations of the network. Hence, such constraints cannot be considered within that binary expansion scheme.We conclude with a remark on the number of binary variables of (11), which ultimately drives the computational properties of the model. If correlation constraints (9e) are not considered, (11h) is not needed in (11). This results in4×Nq+1binary variables, where Nqis the number of locations with stochastic production. A linear dependence is also true for the discretization approach in Jiang et al. (2012) and Zhao and Zeng (2012), which results in 2 × Nqbinary variables, representing maximum and minimum deviation at each location q, respectively. For general polyhedral uncertainty sets, the number of binary variables in our approach would be linearly dependent on the number of constraints, which in turn is related to the number of stochastic production sites. Typically, such a number is limited for a power system.

@&#CONCLUSIONS@&#
In this work, we consider the problem of jointly determining day-ahead energy dispatch and reserve capacity in an electricity market with large penetration of stochastic generation sources. The problem is cast as an adaptive robust optimization model, the solution of which minimizes the system cost in terms of energy dispatch, reserve and energy redispatch in the worst-case realization of the uncertain production.We propose a novel reformulation of the problem that allows us to consider polyhedral sets of any type to model the support of the uncertainty distribution. Such a reformulation is employed as the subproblem within a well-known cutting-plane algorithm for adaptive robust optimization problems with right-hand side uncertainty. The proposed scheme, besides providing more flexibility in modeling uncertainty with general polyhedral sets, e.g., by accounting for correlation between stochastic variables, retains properties of convergence to the global optimum as well as of tractability of the methods proposed in the literature on the subject.Through a case-study based on the 24-node IEEE Reliability Test System, we assess the degree of suboptimality of the robust solution with respect to the stochastic programming approach. System cost increases in expectation by about 7.3 percent. However, part of this figure can be explained by the fact that, differently from models based on stochastic programming, no downward reserve is scheduled using the robust optimization approach. Compared to a stochastic programming model where only upward reserve can be dispatched, the gap in expectation reduces to 5.2 percent. This indicates that there is potential to improve the performance in expectation of the robust optimization approach by devising strategies to allocate downward reserve ex-post. This is left as a direction for future research. In turn, the robust optimization solution performs better both in terms of Conditional Value at Risk (CVaR) and of cost in the worst-case scenario, where the savings obtained reach about one fourth of the total worst-case cost for the stochastic programming solution. Furthermore, the case-study shows that robust optimization is a more suitable framework to account for the stochasticity related to production from renewable sources than deterministic models, where the amount of reserve is fixed in advance by heuristic criteria.Further comparisons with risk-averse models based on stochastic programming show that the robust optimization approach has comparable performance in terms of expected value of the cost. However, the latter approach is characterized by a higher degree of conservatism that hedges the solution and, in the considered case-study, guarantees a better out-of-sample performance in terms of risk measures such as CVaR and the worst-case cost.Finally, we show that the robust optimization approach has better computational properties than a reasonably sized equivalent stochastic programming model, and that it scales well with the size of the power system model. Indeed, the computation time in the cases considered in this paper is not highly affected by the number of nodes in the power system. These results are promising in view of the practical application of robust optimization approaches in electricity markets.Future research on the topic may be carried out in different directions. Firstly, the complementary problem of modeling uncertainty sets from real-world data for spatially distributed stochastic production, which is considered in a simplified manner here, should be studied. In parallel, dynamic properties could also be considered in terms of modeling uncertainty sets in a multi-period setting. Note that there is no methodological difficulty involved in extending the proposed approach to the multi-period case, although there are computational challenges stemming from the consequent increase in model size. Finally, reformulations of the robust optimization problem should be thought of in order to account for uncertainty sets with different structure, e.g., ellipsoidal sets.