@&#MAIN-TITLE@&#
A comparison of linear reformulations for multinomial logit choice probabilities in facility location models

@&#HIGHLIGHTS@&#
Comparison of linear reformulations.Unified notation.Evaluation in terms of solvability.

@&#KEYPHRASES@&#
Multinomial logit model,Facility location,Linear reformulations,

@&#ABSTRACT@&#
In the last decade several papers appeared on facility location problems that incorporate customer demand by the multinomial logit model. Three linear reformulations of the original non-linear model have been proposed so far. In this paper, we discuss these models in terms of solvability. We present empirical findings based on synthetic data.

@&#INTRODUCTION@&#
When customer choice behavior is considered in facility location planning we generally assume utility maximizing behavior. Probabilistic demand based on utility maximization implies that only the probability of a customer choosing a given facility is known. Traditionally, in facility location literature, gravity-type demand models are used to consider probabilistic demand (Serra, Eiselt, Laporte, & ReVelle, 1999). More recently, there is a growing body of literature that considers the multinomial logit model (MNL) in facility location models (see for example Aros-Vera, Marianov, & Mitchell, 2013; Benati & Hansen, 2002; Haase, 2009; Haase & Müller, 2013; Müller, Haase, & Kless, 2009; Zhang, Berman, & Verter, 2012). The MNL is a well-known discrete choice model (random utility model) to describe (spatial) customer choice behavior (Ben-Akiva et al., 2002; McFadden, 2001; Müller, Haase, & Seidel, 2012). Using MNL within a mathematical program for locational decision making probably yields a non-linear model formulation (see Benati, 1999; Marianov, Rfos, & Icaza, 2008, for example). If we consider only locational decisions, then there exist three different linear reformulations of the MNL yielding mixed-integer linear programs. Benati and Hansen (2002) where the first who proposed a linear reformulation based on variable substitution. Haase (2009) has proposed to employ the constant substitution pattern of the MNL in order to enable a linear integer formulation (see also Aros-Vera et al., 2013). Finally, Zhang et al. (2012) presented an alternative approach based on variable substitution.As the three model formulations are discussed independently so far, we compare them in this contribution. Therefore, we first give a brief discussion of the MNL and its incorporation into the maximum capture problem (Section 2). Based on this, we discuss the three linear reformulations using a unified notation in order to make them more comparable (Sections 2.1, 2.2, 2.3). In Section 3 we compare the models in a numerical study using synthetic data. Our conclusions can be found in Section 4.Consider a firm that wishes to enter a market where customers are located in zones denoted by nodes I. Potential facilities of the firm and facilities of competitors are located in nodes M. Now, the problem of the firm is to select r facilities from all potential facilities J with J⊂M such that the patronage of the facilities of the firm is maximized. In order to determine the patronage of a located facility we assume the customers located in i∈I to be homogeneous in their observable characteristics like income and so on. We further assume that the customers located in i∈I maximize their utility(1)uij=vij+∊ij,when choosing a facility located in j∈M.2M might contain a dummy facility denoting a so-called “no-choice” alternative indicating that customers might patronize no facility at all.2vijis the deterministic part of utility containing measures of distance, cost, and other attributes. ∊ijis assumed to be a random term that is independent identically extreme value distributed. Then, according to McFadden (1973), the probability of customers located in i∈I choosing a facility located in j∈M is given by the MNL(2)pij=evij∑k∈Mevik.Let us further denote the locational decision variable yj, taking value 1 if a new facility is located in j and 0 otherwise. For simplicity reasons we assume the demand (number of customers, for example) in node i to be 1 for all nodes i∈I. Then, the problem of the firm can be formalized as a mixed-integer non-linear program(3)maxF=∑i∈I∑j∈Jevijyj∑j∈M⧹Jevij+∑j∈Jevijyj,(4)s.t.∑j∈Jyj=r,(5)yj∈{0,1}∀j∈J.It has been discussed by Benati (1999) that (3)–(5) is NP-hard. In the following we present three different, exact linear reformulations to this problem known from literature (Aros-Vera et al., 2013; Benati & Hansen, 2002; Haase, 2009; Zhang et al., 2012). For comparison reasons we use a unified notation. Thus, the three models appear here in a different fashion compared to the original contributions. We provide the corresponding algebraic transformations in the Appendix. For a detailed discussion of the model formulations we refer to the corresponding references.Let us consider the parameter(6)φij=evij∑k∈M⧹Jevik.Of course, this parameter is only defined if {M⧹J}≠∅. This assumption is quite reasonable because customers usually face at least the choice alternative of “non-consumption” (i.e., the no-choice alternative). In all four references {M⧹J}≠∅. Further, let xijbe a non-negative variable. Applying variable substitution, Benati and Hansen (2002) show that the problem (3)–(5) can be reformulated as(7)maxF=∑i∈I∑j∈Jφij(yj-xij).s.t. (4), (5), and(8)yj-xij+∑k∈Jφik(yk-xik)⩽1∀i∈I,j∈J(9)xij⩾0∀i∈I,j∈J.We further introduce the non-negative variablex̃i. Then, (3)–(5) can be reformulated as(10)maxF=∑i∈I∑j∈Jxij.s.t. (4), (5), (9), and(11)x̃i+∑j∈Jxij⩽1∀i∈I,(12)xij-φij1+φijyj⩽0∀i∈I,j∈J,(13)xij-φijx̃i⩽0∀i∈I,j∈J,(14)x̃i⩾0∀i∈I.The model of Haase (2009) has been analogously presented by Aros-Vera et al. (2013).Finally, we consider the non-negative variable zijkand reformulate (3)–(5) as (10) subject to (4), (5), (9), and(15)xij-φijyj+∑k∈Jφikzijk=0∀i∈I,j∈J,(16)zijk-xij⩽0∀i∈I,j,k∈J,(17)zijk-yk⩽0∀i∈I,j,k∈J,(18)xij+yk-zijk⩽1∀i∈I,j,k∈J,(19)zijk⩾0∀i∈I,j,k∈J.We compare the models using artificially generated data. Therefore, we have implemented the three models in GAMS (23.7) and use CPLEX 12 on a 64-bit Windows Server 2008 with 1 Intel Xeon 2.4gigahertz processor and 24gigabyte RAM to solve the problems. The Cartesian coordinates of the nodes I and M are randomly generated by a uniform distribution in the interval [0,30]. We consider the rectangular distances between i∈I and j∈M denoted by dij. The deterministic part of utility of (1) is defined as vij=−0.2·dij. Further, we consider ∣{M⧹J}∣=10 and r=⌈ α∣J∣⌉ with 0<α<1. Table 1in the appendix displays the computational results for different problem sizes (∣I∣×∣J∣) and α. For each problem set we have computed ten random instances. The maximal computational time is set to one hour. The table reports the average values of the objective function value F∗, the computational effort in seconds CPU and the gap reported by CPLEX (denoted by GAP) as well as the deviation from the optimal solution (denoted by DEV) over ten instances for each model. The objective function value of the model proposed by Zhang et al. (2012) is 20% below the optimal value for some instances. In contrast, using the model of Haase (2009) enables CPLEX to find the optimal solution for all instances within 30min. For the model by Benati and Hansen (2002) CPLEX usually finds the optimal solution within one hour. However, the computational effort is remarkably higher compared to the model of Haase (2009).

@&#CONCLUSIONS@&#
