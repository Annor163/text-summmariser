@&#MAIN-TITLE@&#
Automatic segmentation of coronary arteries using Gabor filters and thresholding based on multiobjective optimization

@&#HIGHLIGHTS@&#
A new method for automatic segmentation of coronary arteries is proposed.The high detection rate achieved is represented by an area under ROC curve of Az=0.961 with a training set of 40 images.The multiscale Gabor filters demonstrated high detection accuracy with Az=0.952 with a test set of 40 angiograms.The multiobjective thresholding method provided the best average accuracy (0.881).

@&#KEYPHRASES@&#
Automatic segmentation,Coronary angiograms,Gabor filters,Medical imaging,Multiobjective optimization,Vessel detection,

@&#ABSTRACT@&#
This paper presents a new method consisting of two stages for automatic detection and segmentation of coronary arteries in X-ray angiograms. In the first stage, multiscale Gabor filters are used to detect vessel structures in the angiograms. The results of multiscale Gabor filtering are compared with those obtained by applying multiscale methods based on the top-hat operator, Hessian matrix, and Gaussian matched filters. The performance of the vessel-detection methods is evaluated through the area (Az) under the receiver operating characteristic (ROC) curve. In the second stage, coronary arteries are segmented by binarizing the magnitude response of Gabor filters using a new thresholding method based on multiobjective optimization, which is compared with seven thresholding methods. Measures of sensitivity, specificity, accuracy, and positive predictive value are used to analyze the segmentation methods, by comparing the results to the ground-truth markings of the vessels drawn by a specialist. Finally, the proposed method is compared with seven state-of-the-art vessel segmentation methods. The result of vessel detection using multiscale Gabor filters demonstrated high accuracy with Az=0.961 with a training set of 40 angiograms and Az=0.952 with an independent test set of 40 angiograms. The results of vessel segmentation with the multiobjective thresholding method provided an average accuracy of 0.881 with the test set of angiograms.

@&#INTRODUCTION@&#
Automatic segmentation of coronary arteries in X-ray angiograms has become essential for systems that perform computer-aided diagnosis (CAD), as it can help cardiologists in diagnosing and treating vascular abnormalities. The key challenges in computer-aided analysis of X-ray coronary angiograms are nonuniform exposure and low contrast between the vessels and the image background. In Fig. 1, the difficulties in coronary vessel segmentation are illustrated. The presence of multiple shaded bands along vessel segments produces histograms with several peaks and valleys; as a result, the coronary artery segmentation problem has been commonly addressed in two stages. The first stage is vessel detection, also known as enhancement, which is used to emphasize the presence of vessel-like structures and also to remove noise from the angiograms. In the second stage, a classification technique for the identification of vessel and nonvessel pixels is applied to the enhanced-angiogram image, the performance of which is evaluated using hand-labeled images (ground-truth) provided by a specialist.In recent years, several methods have been proposed for automatic detection and segmentation of blood vessels in different types of medical images. Some of the proposed methods are based on mathematical morphology. The method of Eiho and Qian [1] is one of the commonly used interactive vessel segmentation strategies, because of its robustness and ease of implementation. This method uses the single-scale top-hat operator to enhance the shape of arteries, followed by the morphological erosion, thinning, and watershed operators for segmentation of coronary arteries in angiograms. This method was later improved by Qian et al. [2], by introducing a linear combination of multiple predefined scales of the top-hat operator in order to capture blood vessels of different calibers. Another morphology-based method proposed by Maglaveras et al. [3] uses the skeleton, high thresholding, and connected-component operators for automatic detection of coronary arteries in single-view angiograms. Bouraoui et al. [4] proposed a fully automatic method for coronary vessel extraction in X-ray images, in two steps; first, the gray-level hit-or-miss transform is used to obtain two seed points on the arteries, and in the second step, a region-growing algorithm is used to detect coronary arteries. Lara et al. [5] combined a region-growing algorithm with a differential-geometry approach for semiautomatic segmentation of the coronary artery tree in angiograms. In general, the morphology-based methods reviewed in the present paragraph provide satisfactory results when vessels have high contrast; however, they do not perform well in the presence of noise and in capturing small vessels.In order to overcome the main disadvantages of the morphology-based methods for automatic segmentation, a number of vessel detection methods have been proposed. The Gaussian matched filters (GMF) of Chaudhuri et al. [6] approximate the vessels in the spatial image domain by applying a Gaussian curve as the matching template at different orientations, and the maximum response from the filter bank is taken to obtain the final enhanced image. This method has been used in different automatic segmentation methods as a preprocessing step. Chanwimaluang and Fan [7] used matched filters to enhance blood vessels in the original image, and then used the local entropy thresholding method of Pal and Pal [8] to segment the vessels. As a postprocessing step, they applied a length filtering method to remove isolated nonvessel pixels. This method has been applied successfully in retinal vessel registration [9]. Kang et al. [10] used a fusion strategy consisting of two different procedures. These procedures use the morphological top-hat operator and matched filters, separately on the original image, and then the entropy maximizing threshold method is applied on both images. The segmentation result is obtained by pixel-wise multiplication of the two images. This enhancement method was also applied by Kang et al. [11] using the degree segmentation method instead of the entropy criterion. The method of Wang et al. [12] is designed to detect blood vessels via matched filtering with multiwavelet kernels followed by the application of a multiscale hierarchical decomposition step. Finally, a binary vessel map is obtained through an adaptive local thresholding method. The Gaussian template matching methods tend to perform poorly when applied to images that contain occlusions or a large number of vessels to be detected.Another type of vessel detection methods are based on the properties of the Hessian matrix [13–15]. These methods are capable of detecting vessels of different caliber with higher efficiency as compared to the previously mentioned methods. However, due to the use of the second-order derivative, the Hessian matrix is highly sensitive to noise. The method of Frangi et al. [15] computes the Hessian matrix by convolving the second-order derivatives of a Gaussian kernel with the original image and uses its eigenvalues to compute a measure of vesselness. This measure is used to classify vessel and nonvessel pixels from the dominant eigenvalues at different vessel width scales. Using similar procedures as Frangi et al. [15], different vesselness measures have been proposed [16–18]. Li et al. [19] developed a region-growing procedure using the pixels with the maximum feature response obtained from a vesselness measure. Wink et al. [20] employed a vesselness measure with an extension of the minimum-cost path search method, which propagates a wave front through the vessel map for a range of scales to determine the central axis of vessels in angiograms. Wang et al. [21] proposed a vesselness measure, which is then used in a segmentation step with a region-growing procedure. In general, the methods based on the Hessian matrix have the ability of detecting vessels of different caliber although they are highly sensitive to noise because of use of the second-order derivative.More recently, Radon transformation [22], the complex continuous wavelet transform [23], and Gabor filters [24,25] have been applied for the detection of blood vessels in different clinical studies. Sang et al. [26] applied multiscale Gabor filters to extract vessel centerlines in 2-D angiography images of the brain with poor contrast and noisy background. They applied a hysteresis thresholding procedure to the maximum response map computed over several orientations and scales of the Gabor filter. Soares et al. [27] used 2-D complex Gabor filters for vessel detection, followed by the application of a Bayesian classifier to discriminate vessel pixels against background pixels. Rangayyan et al. [28] employed multiscale Gabor filters for the detection of blood vessels in fundus images of the retina and obtained high detection rates represented by the area (Az) under the receiver operating characteristic (ROC) curve. Shoujun et al. [29] developed a vessel tracking framework based on multiscale Gabor filters and a vesselness measure to enhance vessel-like structures in order to extract vessel centerlines and edge points of the coronary artery tree in angiograms.Thresholding techniques play an essential role to classify vessel and nonvessel pixels from the response obtained by the detection methods. In the literature, several thresholding techniques have been used to segment blood vessels in different types of medical images, such as retinal fundus images and coronary angiograms. Entropy-based methods were proposed by Kapur et al. [30], and Pal and Pal [8], in which two probability density functions are obtained from the gray-level distribution of the original image. The two distributions represent the foreground (A) and background (B) classes, where the histogram of class A is from gray-level 1 to t and the rest is in class B. The optimal threshold value is acquired by optimizing the location of t between the two distributions. The moment-preserving method, introduced by Tsai [31], assumes two pixel classes in the image. The method computes the first three moments of the image to be thresholded, which are assumed to be preserved in the resulting binarized image. The optimal threshold is obtained by using these three moments to solve four predefined equations. Otsu's method [32] assumes that the pixels of the given image have a bimodal distribution. The optimal threshold value is computed by maximizing a measure related to the variance of the two classes of pixels. The thresholding method of Ridler and Calvard (RC) [33] assumes the presence of two Gaussian distributions in the gray-level histogram of the given image. The method starts by selecting an initial global threshold computed from the average gray-level of the image to obtain two classes of pixels. Then, it calculates the means of the two classes to obtain a new threshold value as their average. This process is iteratively performed until the threshold value does not change. The Rutherford–Appleton Threshold Selection (RATS) method [34,35] uses the derivatives of the given image in the x and y directions to obtain an image of the maximum gradient. The threshold value is obtained by dividing the dot product of the original and maximum gradient images by the sum of the image of maximum gradients. The histogram-concavity-analysis method [36] uses the difference between the convex hull [37] of the histogram of the given image and the histogram itself to find the local maximum that could lead to a suitable threshold value. However, spurious concavities can appear as local maxima due to noise. To eliminate spurious concavities, a balance measure is used to reduce the number of potential threshold values [38]. Cruz and Hernandez [39] introduced an evolutionary thresholding method based on the optimization of two criteria; the inter-class variance and two-dimensional entropy. The method of Cruz and Hernandez uses the population-based technique of differential evolution to maximize a normalized composite-objective function in order to obtain an optimal threshold value. This method was applied to classify vessel and nonvessel pixels obtained from the vesselness measure in 20 angiograms.In the present paper, a new method for automatic segmentation of coronary arteries in X-ray angiograms is proposed. The method consists of two stages of detection and segmentation of vessels. In the detection stage, multiscale Gabor filters are used to enhance vessel-like structures. Gabor filters are compared with vessel enhancement methods based on multiscale mathematical morphology operators, GMF, and multiscale Hessian-based methods; the results are evaluated by performing ROC analysis and obtaining the corresponding Azvalues. In the second stage, the Gabor magnitude response is thresholded using a new global thresholding method based on multiobjective optimization (MOO) through the weighted sum method [40] to obtain the segmentation result as a binary image. The multiobjective method consisting of the evaluation of three weighted single-objective functions simultaneously is compared with seven thresholding methods using the measures of sensitivity, specificity, accuracy, and positive predictive value (PPV). Finally, the results of the proposed coronary artery segmentation method are compared and analyzed with those obtained with seven, previously mentioned, state-of-the-art vessel segmentation methods.The remainder of this paper is organized as follows. In Section 2, the fundamentals of the proposed vessel segmentation method along with a set of evaluation measures are introduced. The database of coronary angiograms and the experimental results are presented and discussed in Section 3, and conclusions are given in Section 4.

@&#CONCLUSIONS@&#
