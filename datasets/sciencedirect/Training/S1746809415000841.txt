@&#MAIN-TITLE@&#
Measuring synchronization in coupled simulation and coupled cardiovascular time series: A comparison of different cross entropy measures

@&#HIGHLIGHTS@&#
A new cross entropy measure, named cross fuzzy measure entropy (C-FuzzyMEn) was proposed to detect the synchronization of bivariate time series.Its performances were tested using both coupled simulation models and clinical cardiovascular coupled signals, and were also compared with two existing cross entropy measures: cross sample entropy (C-SampEn) and cross fuzzy entropy (C-FuzzyEn).Results showed that compared with C-SampEn, C-FuzzyEn and C-FuzzyMEn had better statistical stability and compared with C-FuzzyEn, C-FuzzyMEn had better discrimination ability.

@&#KEYPHRASES@&#
Cross entropy measure,Cardiovascular time series,Synchronization,Fuzzy measure entropy,RR interval,Pulse transit time,

@&#ABSTRACT@&#
Synchronization provides an insight into underlying the interaction mechanisms among the bivariate time series and has recently become an increasing focus of interest. In this study, we proposed a new cross entropy measure, named cross fuzzy measure entropy (C-FuzzyMEn), to detect the synchronization of the bivariate time series. The performances of C-FuzzyMEn, as well as two existing cross entropy measures, i.e., cross sample entropy (C-SampEn) and cross fuzzy entropy (C-FuzzyEn), were first tested and compared using three coupled simulation models (i.e., coupled Gaussian noise, coupled MIX(p) and coupled Henon model) by changing the time series length, the threshold value for entropy and the coupling degree. The results from the simulation models showed that compared with C-SampEn, C-FuzzyEn and C-FuzzyMEn had better statistical stability and compared with C-FuzzyEn, C-FuzzyMEn had better discrimination ability. These three measures were then applied to a cardiovascular coupling problem, synchronization analysis for RR and pulse transit time (PTT) series in both the normal subjects and heart failure patients. The results showed that the heart failure group had lower cross entropy values than the normal group for all three cross entropy measures, indicating that the synchronization between RR and PTT time series increases in the heart failure group. Further analysis showed that there was no significant difference between the normal and heart failure groups for C-SampEn (normal 2.13±0.37 vs. heart failure 2.07±0.16, P=0.36). However, C-FuzzyEn had significant difference between two groups (normal 1.42±0.25 vs. heart failure 1.31±0.12, P<0.05). The statistical difference was larger for two groups when performing C-FuzzyMEn analysis (normal 2.40±0.26 vs. heart failure 2.15±0.13, P<0.01).

@&#INTRODUCTION@&#
Measuring the coupling relationship between two cardiovascular time series, as well as named synchronization measurement, has been an increasing focus of interest in clinical research [1–3]. It is a prerequisite for the understanding of the complexity of underlying signal generating mechanisms and thus for the detection of cardiovascular disorders and ongoing perturbations to the circulation system [4]. Traditionally, the cross-correlation in the time domain as well as the cross-spectrum or coherency in the frequency domain has been used for synchronization measurement [5]. These techniques are able to give the linear relationship between two systems. However, they are not suitable for characterizing the real cardiovascular signals, which are non-stationary and inherently nonlinear [6].In recent years, entropy-based measures, such as the typical approximate entropy (ApEn) and sample entropy (SampEn), have been widely used for the physiological time series analysis to explore their inherent complexity. And their generalized forms, cross-approximate entropy (C-ApEn) [7] and cross-sample entropy (C-SampEn) [8], were used for the synchronization test [9–12]. For fixed bivariate time series x(i) and y(i)(1≤i≤N), C-ApEn measures the conditional regularity or frequency of y-patterns similar to a given x-pattern of embedding dimension m within the threshold value r. When coupling in two time series is tight, patterns in one time series cause predictable patterns in the other one, inducing the low C-ApEn value [8,10]. In the calculating process of C-ApEn, each vector must match at least one vector when embedding dimension comes from m to m+1 [6,13]. However, there is no self-matching in C-ApEn, and thus there is no assurance that the probability will be defined. Moreover, C-ApEn is not direction independent, i.e., C-ApEn(m, r, N)(y|x) does not equal to C-ApEn(m, r, N)(x|y), which brings difficulties to the practical application. In order to handle these potential difficulties, Richman and Moorman [14] proposed the SampEn method instead of counting the self-matching of the vectors and generalized it to C-SampEn for bivariate time series. Compared with the fact that C-ApEn was a biased evaluation and was sensitive to noisy, C-SampEn could reduce the bias and showed better relative consistency than C-ApEn. Meanwhile, C-SampEn is direction independent, i.e., C-SampEn(m, r, N)(y|x) equals to C-SampEn(m, r, N)(x|y). Thus it has been used as an alternative nonlinear statistic to analyze physiological time series [8,10].Similar to ApEn and SampEn, in both C-ApEn and C-SampEn, the similarity of two vectors is judged using the Heaviside function, i.e., binary classification, which makes the boundary very rigid. Only the vectors within the threshold r are treated equally, whereas the vectors outside of this threshold r are ignored. This rigid boundary may induce to the abrupt changes of entropy values when the threshold r changes slightly, and it may even fail to define the entropy if no vector-matching could be found for this very small threshold r[14]. To enhance the statistical stability, a new entropy measure, named fuzzy entropy (FuzzyEn), has been proposed for univariate time series analysis by emerging the notion of entropy with the fuzzy theory [15,16]. FuzzyEn employed a fuzzy function to replace the Heaviside function to make a gradually varied entropy value when the threshold r monotonously changes. Its generalized form, cross fuzzy entropy (C-FuzzyEn), has also been developed for the bivariate time series analysis [6,10].However, no matter for FuzzyEn or C-FuzzyEn, the local vector similarity is overemphasized. Thus both of them might give inaccurate results for some slow signals since they both neglected the signal global characteristics. In our previous work, we developed a novel fuzzy measure entropy (i.e., FuzzyMEn) that combined both the local and global similarity, and FuzzyMEn has shown better algorithm discrimination ability than FuzzyEn [17,18]. In this study, we generalized the FuzzyMEn method for the bivariate time series analysis and compared its performance with C-SampEn and C-FuzzyEn for quantifying the synchronization in both coupled simulation and coupled cardiovascular time series. We defined this new synchronization measure as cross fuzzy measure entropy (i.e., C-FuzzyMEn).The rest of the paper is organized as follows: Section 2 gives the definition of C-SampEn, C-FuzzyEn and C-FuzzyMEn to allow the detailed comparison and inspection of these three cross entropy measures to be observed. Section 3 discusses the experimental design where three coupled simulation models (i.e., coupled Gaussian noise, coupled MIX(p) and coupled Henon signals) and two cardiovascular time series (RR interval and pulse transit time (PTT) time series) from both the normal and heart failure subjects were constructed for the cross entropy analysis. In Section 4, the results of cross entropy measures from both coupled simulation and coupled cardiovascular time series are provided. Finally, Section 5 draws the discussions and identifies the future work.In this section, we first give a brief introduction for C-SampEn and C-FuzzyEn, and then describe the definition of C-FuzzyMEn.The calculation process of C-SampEn was summarized as follows [8,14]:The time series x(i) and y(i)(1≤i≤N) were first normalized to have a mean value of 0 and standard deviation of 1. Then given the input parameters m and r, the vector sequencesXimandYjmwere formed as follows:(1)Xim=xi,xi+1,…,xi+m−1Yjm=yj,yj+1,…,yj+m−11≤i,⁡j≤N−mThese vectors represent m consecutive x and y values, respectively. Then the distance betweenXimandYjmbased on the maximum absolute difference is defined as:(2)di,jm=dXim,Yjm=maxk=0m−1xi+k−yj+kFor eachXim, denoteBimras (N−m)−1 times the number ofYjm(1≤j≤N−m) that meetsdi,jm≤r. Similarly, setAimris (N−m)−1 times the number ofYjm+1that meetsdi,jm+1≤rfor all 1≤j≤N−m.Finally C-SampEn is defined as(3)C-SampEnm,r,N=−ln∑i=1N−mAimr∑i=1N−mBimrIn both C-ApEn and C-SampEn, the decision rule for vector similarity is very rigid becauseXimandYjmare considered as similar vectors only whenmaxk=0m−1xi+k−yj+k≤r. In the definition of C-FuzzyEn, the vectorsXimandYjmare formed as follows:(4)Xim=xi,xi+1,…,xi+m−1−x¯(i)Yjm=yj,yj+1,…,yj+m−1−y¯(j)1≤i,j≤N−mThese vectorsXimandYjmalso represent m consecutive x and y values respectively but removing the local baselinex¯(i)andy¯(j), which are defined as:(5)x¯(i)=1m∑k=0m−1x(i+k)y¯(j)=1m∑k=0m−1y(j+k)1≤i,j≤N−mCalculate the distance betweenXimandYjmalso using the maximum absolute difference:(6)di,jm=dXim,Yjm=maxk=0m−1(xi+k−x¯(i))−(yj+k−y¯(j))Given vector similarity weight n and threshold r, calculate the similarity degreeDi,jm(n,r)betweenXimandYjmby a fuzzy functionμ(di,jm,n,r):(7)Di,jm(n,r)=μ(di,jm,n,r)=exp−(di,jm)nrDefine the function ϕm(n, r) as:(8)ϕm(n,r)=1N−m∑i=1N−m1N−m∑j=1N−mDi,jm(n,r)Similarly, define the function ϕm+1(n, r) for m+1 vectorsXim+1andYjm+1(1≤i, j≤N−m):(9)ϕm+1(n,r)=1N−m∑i=1N−m1N−m∑j=1N−mDi,jm+1(n,r)Then C-FuzzyEn is finally defined by:(10)C-FuzzyEnm,n,r,N=−lnϕm+1(n,r)/ϕm(n,r)In our previous work [17,18], we reported that the FuzzyEn only focuses on the local waveform characteristics of the time series by removing the local baselinex¯(i)andy¯(j), without considering any global signal characteristics. So we proposed the FuzzyMEn method to integrate both the local and global signal characteristics. Herein, we generalized the FuzzyMEn to C-FuzzyMEn for the bivariate time series analysis.For two normalized time series x(i) and y(i)(1≤i≤N), given the input parameters m and r, first form the local vector sequencesXLimandYLjmand the global vector sequencesXGimandYGjm:(11)XLim=xi,xi+1,…,xi+m−1−x¯(i)YLjm=yj,yj+1,…,yj+m−1−y¯(j)XGim=xi,xi+1,…,xi+m−1−x¯YGjm=yj,yj+1,…,yj+m−1−y¯1≤i,j≤N−mwherex¯(i)andy¯(j)are the local baseline with the same definition as illustrated in Formula (5) andx¯andy¯are the global mean values of time series x(i) and y(i):x¯=1/N∑i=1Nx(i)andy¯=1/N∑i=1Ny(i).Then the distance between the local vector sequencesXLimandYLjmand the distance between the global vector sequencesXGimandYGjmare defined respectively as follows:(12)dLi,jm=dXLim,YLjm=maxk=0m−1(xi+k−x¯(i))−(yj+k−y¯(j))dGi,jm=dXGim,YGjm=maxk=0m−1(xi+k−x¯)−(yj+k−y¯)Given the local vector similarity weight nLand the local threshold rL, as well as the global vector similarity weight nGand the global threshold rG, calculate the similarity degreeDLi,jm(nL,rL)between the local vectorsXLimandYLjmby the fuzzy functionμLdLi,jm,nL,rL, as well as calculate the similarity degreeDGi,jmnG,rGbetween the global vectorsXGimandYGjmby the fuzzy functionμGdGi,jm,nG,rG:(13)DLi,jm(nL,rL)=μL(dLi,jm,nL,rL)=exp−(dLi,jm)nLrLDGi,jm(nG,rG)=μG(dGi,jm,nG,rG)=exp−(dGi,jm)nGrGDefine the function ϕLm(nL, rL) and ϕGm(nG, rG) as:(14)ϕLmnL,rL=1N−m∑i=1N−m1N−m∑j=1N−mDLi,jmnL,rLϕGmnG,rG=1N−m∑i=1N−m1N−m∑j=1N−mDGi,jmnG,rGSimilarly, define the function ϕLm+1(nL, rL) for m+1 vectorsXLim+1andYLjm+1and the function ϕGm+1(nG, rG) for m+1 vectorsXGim+1andYGjm+1:(15)ϕLm+1nL,rL=1N−m∑i=1N−m1N−m∑j=1N−mDLi,jm+1nL,rLϕGm+1nL,rL=1N−m∑i=1N−m1N−m∑j=1N−mDGi,jm+1nG,rGThen the cross fuzzy local measure entropy (C-FuzzyLMEn) and the cross fuzzy global measure entropy (C-FuzzyGMEn) are defined by:(16)C-FuzzyLMEnm,nL,rL,N=−lnϕLm+1nL,rLϕLmnL,rLC-FuzzyGMEnm,nG,rG,N=−lnϕGm+1nG,rGϕGmnG,rGFinally, the C-FuzzyMEn of the time series x(i) and y(i) is calculated as follows:(17)C-FuzzyMEnm,nL,rL,nG,rG,N=C-FuzzyLMEnm,nL,rL,N+C-FuzzyGMEnm,nG,rG,NCoupled Gaussian noise, coupled MIX(p) and coupled Henon models are used as the simulation signals for testing the performances of the three cross entropy measures. The coupled Gaussian noise model could produce the pure white noise. The coupled MIX(p) model is regarded as a composite signal composing of noise and certain signals. The coupled Henon model could generate the typical nonlinear signals [19].The coupled Gaussian noise signals, x and y, were generated by mixing the common Gaussian noise n1 with two independent white noises n2 and n3[1],(18)x=cn1+1−cn2y=cn1+1−cn3where c is the coupling degree.The MIX(p) model is a sinusoid signal of N points, where N×p (p is the probability parameter whose value is between 0 and 1) random chosen points are replaced with the random noise. The detail description for MIX(p) model is summarized in [20]. The coupled MIX(p) signals, x and y, were generated by mixing one MIX(p) process with the other two so as to simulate the real world systems which contain a large proportion of low-frequency trend defined as:(19)x=cMIX(p1)+1−cMIX(p2)y=cMIX(p1)+1−cMIX(p3)where c is the coupling degree, p1, p2 and p3 are probability parameters with a value of 0.3, 0.5 and 0.7, respectively.Mathematically, the coupled Henon signals, x and y, can be generated by the following iterations [19]:(20)Forxxn+1=1.4−xn2+bxunun+1=xnForyyn+1=1.4−cxnyn+1−cyn2+byvnvn+1=ynwhere c is the coupling degree, bxand byare both set as 0.3 to yield the identical systems.For the above three coupled simulation signals, the time series length N and coupling degree c were used as the control parameters to test the performances of the three measures. In addition, previous research has shown that the threshold value r for entropy calculation could have a great impact on entropy values [9,13]. So the threshold value r was also selected as a control parameter.We used the time series length N as the first control parameter to test what extent the different cross entropy measures are influenced by this parameter and then to select a suitable length for the following analysis. Entropy methods are suitable to analyze the short-term time series and are usually applied to several hundreds of sequences [7,13,14,20]. Herein, the time series length N was set from 50 to 800 with a step of 50. The threshold value r was set as the second control parameter to investigate whether the results of different cross entropy measures have consistency for distinguishing the different coupled signals under the setting of different threshold r values. For the normalized time series, the recommended r value is usually between 0.1 and 0.25 [13,14,16,20]. Herein, the threshold r was set from 0.05 to 0.8 with a step of 0.05. It is worth to note that for C-FuzzyMEn, the values of the local threshold rLand the global threshold rGare always set equal to the r. In addition, the most common choice for the embedding dimension parameter is m=2, as it was recommended by Pincus and Goldberger for ApEn [21], by Yentes et al. for SampEn [22], and confirmed by [23]. Recently, Aktaruzzaman and Sassi suggested that m=1 could also get the good performance for very short series (N=75) when employing the autoregressive parametric estimation method for SampEn [24]. We also perform the comparison between m=1 and m=2 to explore the effect of the threshold parameter r on different cross entropies. Finally, the coupling degree c was set as the third parameter to test what extent the different cross entropy measures are able to distinguish different degrees of coupling. This is essential in most of synchronization tests since rarely is the absolute value of synchronization of interest, but rather the change of synchronization between different states. It is believed that the synchronization of the two coupled systems increases with the increase of the coupling degree c. Simultaneously, similar patterns are prone to occur and the cross-predictability also increases; hence the three cross entropy measures are expected to monotonously decrease [2,9,10]. Herein, the coupling degree c was set from 0 to 1 with a step of 0.05. Two time series are totally independent when c=0 and become identical when c=1. Fig. 1gives the examples of the coupled model maps for the three coupled signals with different coupling degree values c. It clearly shows that with the increase of the coupled degree, two time series x and y become more and more synchronous. Fig. 2shows the typical examples of the time series for the three coupled signals when setting coupling degree c=0.4.To eliminate the influences of random factors on the coupled Gaussian noise and MIX(p) signals, for each control parameter of N, r or c, 20 realizations were generated and the mean values were used as the final cross entropy results. For coupled Henon signals, for each control parameter of N, r or c, totally 60,000 points were first generated and 20 pairs of episodes (i.e., 20 realizations) were selected with no overlap from the last 50,000 points for the analysis. The mean entropy values of the 20 realizations were also used as the final cross entropy results.For calculating the three cross entropy measures, other fixed parameters are set as: the embedding dimension m=2 for testing the effects of time series length N and coupling degree c, m=1 and 2 for testing the effect of threshold value r, the vector similarity weight n=2 for C-FuzzyEn, the local vector similarity weight nL=3 and the global vector similarity weight nG=2 for C-FuzzyMEn.To test the practical applications for the three cross entropy measures, we compared the performances of them on the coupled cardiovascular signals: RR interval and PTT time series. Thirty normal subjects and 30 heart failure patients were enrolled in this study. All subjects gave their written informed consent to participate in the study, and confirmed that they had not participated in any other ‘clinical trial’ within the previous three months. The study obtained a full approval from the Clinical Ethics Committee of the Qilu Hospitals of Shandong University and all clinical investigation was conducted according to the principles of expressed in the Declaration of Helsinki. The demographic information is given in Table 1. Two groups were matched by age, gender, height, weight, heart rate and blood pressure. The heart failure subjects were in classes II–III of the New York Heart Association with functional classification confirmed by an ultrasonic cardiogram and has a left ventricular ejection fraction (LVEF) less than 50%. The normal subjects had a LVEF between 58 and 81%.Each subject was asked to lay supine on a measurement bed for a 5min rest period to allow cardiovascular system stabilization before the signal recording. Subjects were told to breathe regularly and gently during the measurements. For each subject, electrocardiograms (ECG) and radial pulses were simultaneously recorded for more than 5min with a sample rate of 1kHz. The R-wave peaks of the ECG were detected using the wavelet transform modulus maxima method [25]. Ectopic beats and false detection beats were identified [26] and excluded with the visual comfirmation. After the location of R-wave peaks, their corresponding pulse feet (starts of pulse) were identified [27]. RR time series were obtained from the adjacent R-wave peaks and PTT time series were obtained from the R wave peaks to the corresponding pulse feet. The time resolutions of RR and PTT time series were 1ms. Fig. 3shows the examples of RR and PTT time series from a normal subject and a heart failure subject and their corresponding coupled maps.For both RR and PTT time series, the initial 300 points were used for the cross entropy calculation. We named the length of 300 as short time series due to the recommendation from The Task Force of The European Society of Cardiology and The North American Society of Pacing and Electrophysiology [28]—“a duration of 5min ECG recording for short time recordings, which would result in 300 data points at an average heart rate of 60 beats per second.” Threshold value r was set as 0.2 and embedding dimension m was set as 2 for all three cross entropy measures. Vector similarity weight n was set as 2 for C-FuzzyEn while local vector similarity weight nLwas set as 3 with global vector similarity weight nGset as 2 for C-FuzzyMEn.Mean±standard deviation (SD) of the three cross entropy measures were obtained across all subjects (30 normal and 30 heart failure subjects). All cross entropy measures were first test for normal distribution by the Kolmogorov–Smirnov test. Then they were tested using the Student t-test to compare the statistical differences between normal and heart failure groups if they met the normal distribution or were tested using the non-parametric tests if they did not meet the normal distribution. Statistical significance was set a priori at P<0.05.

@&#CONCLUSIONS@&#
