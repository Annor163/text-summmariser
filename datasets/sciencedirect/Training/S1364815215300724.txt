@&#MAIN-TITLE@&#
Incorporation of extended neighborhood mechanisms and its impact on urban land-use cellular automata simulations

@&#HIGHLIGHTS@&#
Extended neighborhood effects and their influence on urban dynamics were addressed in this study.A logistic regression urban CA model incorporating the extracted neighborhood rules, Logistic-LNCA, was developed.The Logistic-LNCA model achieved higher simulation accuracy than the Logistic-CA model with a 3 × 3 kernel.The simulation accuracy and the Kappa coefficient varied with window sizes and radius intervals.There is an optimal window size in cellular space and corresponding optimal parameter configurations.

@&#KEYPHRASES@&#
Urban expansion,Cellular automata,Extended enrichment factors,Neighborhood effects,Neighborhood rules,

@&#ABSTRACT@&#
Urban cellular automata (CA) models are broadly used in quantitative analyses and predictions of urban land-use dynamics. However, most urban CA developed with neighborhood rules consider only a small neighborhood scope under a specific spatial resolution. Here, we quantify neighborhood effects in a relatively large cellular space and analyze their role in the performance of an urban land use model. The extracted neighborhood rules were integrated into a commonly used logistic regression urban CA model (Logistic-CA), resulting in a large neighborhood urban land use model (Logistic-LNCA). Land-use simulations with both models were evaluated with urban expansion data in Xiamen City, China. Simulations with the Logistic-LNCA model raised the accuracies of built-up land by 3.0%–3.9% in two simulation periods compared with the Logistic-CA model with a 3 × 3 kernel. Parameter sensitivity analysis indicated that there was an optimal large window size in cellular space and a corresponding optimal parameter configuration.

@&#INTRODUCTION@&#
Land-use dynamics constitute an open and complex spatiotemporal evolution process that involves multi-element composite effects from natural, social, and economic factors (Arsanjani et al., 2013; Fuglsang et al., 2013; Hewitt et al., 2014). Environmental modeling can support scientific decision-making processes, and thus contribute to sustainable development associated with land-use changes. Spatial simulations and quantitative analyses of urban land-use dynamics are effective ways to improve the understanding of the evolution of urban landscapes. Cellular automata (CA) have drawn increasingly more attention in the field of land-use and land-cover analysis and simulation. The ‘bottom–up’ approach of CA fully reflects the concept that complex global patterns emerge from interactions governed by local rules. In addition, CA are ideal for simulating and predicting complex geographic phenomena (Liu et al., 2008a).Based on the pioneering work by Tobler (1979) and Couclelis (1988), many researchers have developed urban land-use CA models over the last three decades, resulting in significant achievements (Batty and Xie, 1994; Clarke et al., 1997; Li and Yeh, 2000; Liu et al., 2007; Stevens et al., 2007; Takeyama and Couclelis, 1997; Verburg et al., 2004b; Wu, 2002). These models generally included a combination of drivers and spatiotemporal interactions among land uses in neighborhoods.Identifying transition rules is a key issue in urban CA. Typically, a variety of biophysical and socioeconomic factors are included in transition rules as driving forces of urban development. Researchers have proposed various methods to determine the contributions of different spatial variables and to calibrate urban CA models (Al-Ahmadi et al., 2009; Dai et al., 2005; Feng and Liu, 2013; Feng et al., 2011; Kocabas and Dragicevic, 2007; Li and Yeh, 2002, 2004; Liao et al., 2014; Liu et al., 2008a; Verstegen et al., 2014; Wang et al., 2013; Wu, 2002; Wu and Webster, 1998; Yang et al., 2008). The binary logistic regression method developed by Wu (2002) has been widely used in urban land-use modeling because of its strict theoretical basis of statistical learning and empirical characteristics, and it has become a classic calibration method for urban CA (Cheng and Masser, 2003; Dendoncker et al., 2007; Hu and Lo, 2007; Verburg et al., 2004a). More recently, new socioeconomic factors such as per-capita gross domestic product (GDP), land price, employment potential, and population density have been incorporated into the driving forces of urban CA models and integrated with logistic regression and Markov chain analysis to predict future scenarios of urban development (Arsanjani et al., 2013; Guan et al., 2011; Mas et al., 2014). However, these models mainly considered a 3 × 3 kernel, which is a relatively small neighborhood, though studies have noted that the logistic regression urban CA model is sensitive to scale (Pan et al., 2010).Neighborhood interaction rules are an important subset of transition rules and play a key role in the calculation of cellular conversion probabilities. To quantify and analyze the neighborhood effects generated by surrounding cells at different distances from a central cell, Verburg et al. (2004b) defined an enrichment factor formula for measuring the over- and under-representation of specific land uses in cellular space. More recently, other studies have achieved better simulation results by applying this enrichment factor to determine the neighborhood parameters of urban cellular models or as empirical data for calibrating neighborhood interaction rules (Hansen, 2008; Van Vliet et al., 2013). However, these models generally considered a small neighborhood scope with a relatively short distance from the central cell under a specific resolution during the application. For example, Van Vliet et al. (2013) used a neighborhood radius covering 0–4 unit distances (the discrete ring of a cell with a width of 500 m) to simulate urban land-use dynamics at a country scale in Germany.The external effects generated by concentrative and dispersive forces play an important role in urban dynamics and are seen as the organizing forces of urban patterns (Harrop, 1973; Krugman, 1999; Rodrigue, 2004). Hagoort et al. (2008) pointed out that neighborhood interaction rules specify how the combined effects of spatial externalities work over distance in cellular space. Spatial externalities are considered to represent the aggregated effects of a specific land-use type on another in the neighborhood (Hagoort et al., 2008; Hansen, 2008). Research on neighborhood effects has shown that a neighborhood scope greater than a relatively small window size (i.e., a large neighborhood window) still has a significant influence on the development of the center cell (Hagoort et al., 2008; White and Engelen, 2003). In fundamental urban CA, the decay coefficient of a small neighborhood function will eventually approach zero as the radius of the neighborhood increases (Van Vliet et al., 2013). Thus a small neighborhood function cannot effectively express the impact of spatial externalities existing in a relatively large neighborhood window on the development of the central cell.In summary, neighborhood interactions in urban CA models have mainly been limited to a 3 × 3 kernel or relatively small moving window, partially due to the aim of simplifying the models (White and Engelen, 2000). The neighborhood rules established in this case are unsuitable for detecting complex neighborhood effects over a larger scope. This problem is not prominent when the spatial resolution of geospatial data is low. However, high-spatial resolution remote sensing data have become readily available and increasingly popular. Thus, interaction rules designed for complex neighborhood effects in urban CA models are encountering unprecedented challenges. The goal of this paper is to characterize the role of complex neighborhood effects over a relatively large scope associated with urban sprawl simulation and prediction. A modeling exercise was designed to answer the following questions: 1) do large neighborhood effects exist on urban sprawl processes? 2) if yes, how can large neighborhood rules in urban CA modeling be calibrated? and 3) what is the expected increase in locational accuracy of the urban CA when large neighborhoods are incorporated?This study addresses extended neighborhood effects on urban dynamics by using an extended neighborhood structure that is composed with cells with various influence weights based on their distances from the central cell. We used the extended neighborhood structure and calibrated parameter values to establish a large-window neighborhood function. Based on this, we developed an extended neighborhood model of urban land-use change, Logistic-LNCA, and applied it to simulate land-use changes in Xiamen City of China from 1990 to 2000. We then validated this method by using independent data acquired between 2000 and 2010.The methodology for this study is given in the next section, together with a concise flowchart of the Logistic-LNCA model. Simulation experiments and result evaluations are presented in section three. Results are discussed in section four, and conclusions and further research directions are provided in section five.Urban models simulate urban morphology evolution under various scenarios by characterizing a series of development profiles, which include physical attributes, socioeconomic status, planning and zoning constraints, and the effects of complex neighborhood interactions. Spatiotemporal models based on CA can reveal the agglomeration effects of land use at a local scale or the level of development through the iterative calculation of local and simple rules. Thus, the two interrelated processes of urban land development—spontaneous growth and self-organized growth—can be reproduced in urban cellular lattices (Wu, 2002). However, calibrating the contributions of the various aforementioned attributes to land development is a critical step to achieve more realistic and reliable urban CA simulations. Logistic regression or the multinomial logit model can be used to estimate the relationship between urban land-use changes and corresponding locational features (Bishop, 2006; McCullagh and Nelder, 1989; McMillen, 1989). More specifically, logistic regression can be seen as a process to extract the coefficients of the empirical relationships between observed land-use changes and driving forces in the integration with urban CA simulation (Wu, 2002).Sample size and sampling strategy are two basic issues that affect the results of logistic regressions (Hirzel and Guisan, 2002; Huang et al., 2009; Munroe et al., 2004; Xie et al., 2005). Because sample size and resultant errors have an inverse relationship, a large sample size can better represent the characteristics of the study area but requires greater computing resources.The sampling methods used in logistic regression models generally include systematic and random sampling. Systematic sampling can reduce spatial autocorrelation but may lose detailed information on some relatively isolated cells. Random sampling may better represent the population, but cannot effectively reduce spatial autocorrelation, especially local spatial dependence (Xie et al., 2005). A reasonable sampling scheme should maintain a balance between spatial autocorrelation and effective population representation (Huang et al., 2009). Considering the multiple characteristics of urban land-use modeling, we integrated systematic and random sampling, namely, proportional random-stratified sampling and extracted adequate samples to eliminate the spatial dependence of the population (Xie et al., 2005).Generally, urban land-use change models quantify the local transition suitability of each cell from a set of demographic, econometric, and physical factors (Arsanjani et al., 2013; Fuglsang et al., 2013; Lauf et al., 2012). Cells with higher suitability are given higher probabilities in transition rules. In urban expansion simulations, the cellular space can be classified into two types, developed cells (built-up land) and undeveloped cells (non built-up land). The local development suitability at a location can be considered a function of various independent spatial variables, including elevation, slope, distance to the city center, distance to the town center, distance to the main road, distance to the railway, distance to the coast, and so on. Thus, because of the binary features of the dependent variable, it is suitable to evaluate the contributions of different driving forces to urban development using the binary logistic regression approach (Wu, 2002). The regression equation used to calculate local development suitability is as follows:(1)P(y=1|X)=11+e−(α0+∑αX)where P is the probability of the dependent variable, representing the assessed value of local development suitability; X is the vector of the independent variables, representing a set of development factors [spatial variables, X= (x1,x2,⋯,xk)]; and α is the vector of estimated parameters [α =(α1,α2,⋯,αk)].In general, a CA primarily consists of cells, states, neighborhoods, and transition rules. From the perspective of model runs, various transition rules and their combinations form the core engine that drives the changes in system state over time. The key of this engine is the identification of various model parameters contained in the transition rules, which define the characteristics of the process represented by the transition rules. Therefore, a general urban CA can be defined as (Verstegen et al., 2014):(2)Sijt=f(Sijt−1,It,At),foreacht=1,2,…,TwhereSijtandSijt−1represent the state of cell (i, j) at moment t and t−1, respectively, including built-up land, non built-up land, and water in this paper; the vector Itrepresents all inputs, which usually include spatial attributes and boundary conditions; the vector Atis a collection of all parameters, which constrains the contributions of various model inputs to a great extent; and f is a series of transition rules that lead to change in the system state over time.Given the uncertainty of urban systems, it is feasible to express the conversion potential of a location with probability rules rather than deterministic rules. If model inputs are further divided into local development factors, neighborhood conditions, constraints and stochastic disturbance factors, the probability of converting the cell (i, j) from the undeveloped state to the developed state at moment t can be expressed as follows (Feng et al., 2011; White and Engelen, 1993; Wu, 2002):(3)Pijt=(Pl)ij·(PΩ)ij·con()·PrwherePijtis the total development probability of cell (i,j) at moment t; (Pl)ijis the assessed value of local development suitability based on a variety of spatial distance variables such as the slope or distance to the city center (in a logistic-based urban CA (Logistic-CA), parameters for obtaining (Pl)ijare calibrated using the method mentioned in Section 2.1 and the value of (Pl)ijis computed with Eq. (1) (Arsanjani et al., 2013; Feng et al., 2011)); (PΩ)ijis the development density of a relative small cellular neighborhood; con() is the constraint conditions of land development in this region; and Pris the stochastic disturbance factor of urban evolution.It must be noted that probabilistic transition rules can be expressed in forms other than Eq. (3) (Lagarias, 2012; Liu et al., 2012; Van Vliet et al., 2013). However, this research mainly refers to the logistic regression model proposed by Wu (2002), and Eq. (3) defines the Logistic-CA model in this paper.Neighborhoods are important factors affecting the simulation of urban evolution. To generate a more compact space layout for land-use change simulations, a neighborhood window (3 × 3 Moore) is generally used to calculate interactions among different land-use types. The neighborhood function can be defined as (Liu et al., 2008b, 2014):(4)(PΩ)ij=∑3×3con(sijt=dev)3×3−1where (PΩ)ijis the development density of the neighborhood and∑3×3con(sijt=dev)is the number of developed cells in the neighborhood window.Numerous objective development constraints such as water, woodland, and farmland protection zones and limited planning areas must be considered in the model, and the probability of converting these areas to urban land is generally low. The termcon(sijt=suitable)can be used to represent the development constraints of the center cell. In order to simplify the calculation, the value of con() is usually 0 or 1.Urban expansion is influenced by various forces such as natural and geographic factors, political factors, socioeconomic factors, and accidental events, and it can become even more complex due to human interventions. Therefore, to make the simulation results better represent actual development, a stochastic disturbance factor is introduced into the model (White and Engelen, 1993).(5)Pr=(1+(−lnγ)α)where (1+(−lnγ)α) is the stochastic factor; γ is a random number in the range of [0, 1]; and α is an integer ranging from 1 to 10 that controls the effect of the stochastic factor (White and Engelen, 1993).After calculating the development probability of the center cell according to Eq. (3), a threshold value in the range of [0, 1] is generally predefined. The model can decide whether a particular cell is converted by comparing the development probability with the threshold value in each iteration.(6)Sijt={Developed,Pijt≥PthresholdUndeveloped,Pijt<PthresholdwhereSijtis the state of cell at moment t;Pijtis the value of development probability; and Pthreshold is the threshold value of cellular conversion.A key task of land-use change modeling involves identifying the most important driving forces of urban expansion and determining how to express these factors in the model (Hansen, 2008). Previous research has indicated that a large neighborhood significantly influences the development of the central cell (Hagoort et al., 2008; Hansen, 2008; Van Vliet et al., 2013). Verburg et al. (2004b) defined a spatial indicator or enrichment factor to quantify and analyze neighborhood characteristics. The enrichment factor is defined as an over- or under-representation of a certain land-use type in the neighborhood of a specific location compared with the overall average level of this land use in the entire study area. It can be used to calculate the neighborhood effects of all land-use types for each neighborhood radius.To measure the large neighborhood effect in a specific location, we followed Verburg et al. (2004b) and modified the formula for the enrichment factor. The extended formula was designed to measure the over- or under-representation of a specific land-use type in various sub-neighborhoods with different distances to the central cell in a relatively large neighborhood. The formula for this extended enrichment factor is as follows:Fi,l,⋃dj=ni,l,⋃dj/ni,⋃dj|Nl|/|N|(7)⋃dj={⋃rr+Δrdj|r<dj≤r+Δr,r∈(Rmin,Rmin+Δr,Rmin+2Δr,…,Rmax)}where (Rmin, Rmax) is the scope of the large neighborhood, which is divided into several sub-neighborhoods with a separation distance Δr;⋃djis sub-neighborhood with a specific distance to location i and a distance range in the interval (r, r+Δr); distance djis the Euclidean distance between two cells; (0, Rmin) represents a relatively small neighborhood scope around the central cell (e.g., the value of Rmin might be 1, 4, or 7; Fig. 1shows the shape of the large neighborhood used in this study);Fi,l,⋃djis the enrichment of land use l on location i in the distance set⋃dj;ni,l,⋃djis the number of cells of land use l located in the sub-neighborhood⋃djof location i;ni,⋃djis the total number of cells located in the sub-neighborhood⋃djof location i; and|Nl|and|N|are the number of cells with land use l and the total number of cells in the study area, respectively.An enrichment factor for a certain land-use type between 0 and 1 indicates an under-representation of this land-use type in the neighborhood. For example, when the neighborhood of a particular location contains 10% agricultural land, but the average proportion of agricultural land in the study area is 40%, the neighborhood model under-represents this land-use type and the enrichment factor is 0.25, which is between 0 and 1. If the ratio of a certain land-use type in the neighborhood is equal to the average ratio of the study area, the value of the enrichment factor for this land-use type in the neighborhood is equal to 1. The over-representation of a certain land use type results in an enrichment factor greater than 1 (Verburg et al., 2004b).Eq. (7) has been applied in several European-based studies, which demonstrated that the location relationships of some land-use combinations have strong correlations (Van Vliet et al., 2013; Verburg et al., 2004a). Enrichment factors can be computed for different land uses and specific subsets (Hansen, 2012; Van Vliet et al., 2013). For example, Hagoort et al. (2008) calculated the average enrichment factor for a certain land-use type over an area at a particular moment T. To express the effects of various land-use types on observed land-use changes during a specific period, we assume that the set of all locations of a new land-use type k during this period isK. Thus, the average extended enrichment factor for the land-use setKcan be calculated as follows (Van Vliet et al., 2013; Verburg et al., 2004b):(8)F¯k,l,⋃dj=1|Nk|∑i∈KFi,l,⋃djwhere|Nk|is the number of cells that are changed into land use k between T1 and T2;F¯k,l,⋃djis the average enrichment of land use l on all cells that are changed into land use k at a distance range⋃dj; i is a location in land use setK; andFi,l,⋃djis the extended enrichment factor measured by the land use map at T1. The average extended enrichment factor can be expressed in logarithmic form and used to compare the over- or under-representations of different land-use types in different subsets of a large neighborhood.Eq. (8) was used to test the existence of large neighborhood effects of land-use types on the central cell i. However, characterizing the extent of this influence requires further investigation. For different study areas and corresponding spatial resolutions, configurations of a large neighborhood may differ in size and shape. A large neighborhood generally extends over a relatively large spatial area, in which various attractive and repulsive effects among land-use combinations exist. The large neighborhood can be divided into multiple subsets via Eq. (7), and the neighborhood effects of land use l on location i in these subsets can then be estimated. For the purpose of investigating urban expansion dynamics in this paper, the proposed model primarily expresses the influence of neighborhood effects on central cell through neighborhood development distributions. Therefore, the extended enrichment factor defined in Eq. (7) is mainly used to measure the influences of built-up land on the central cell during the model calibration stage. Thus, land use l in Eq. (7) is limited to built-up land in Section 2.3, and the corresponding subscript in the extended enrichment factor is expressed as dev. By treating land-use changes during T1 and T2 as dependent variable and extended enrichment factors of different neighborhoods of the⋃djdistance sets as independent variables, the logistic regression method descripted in Section 2.1 can be used to calibrate the large neighborhood effects:(9)P(y=1|F)=11+e−(β0+β1Fi,dev,⋃d1+β2Fi,dev,⋃d2+…+βnFi,dev,⋃dn)where P is development probability of cell i considering only large neighborhood effects; F is the vector of extended enrichment factors [spatial attributes, F = (Fi,dev,⋃d1,Fi,dev,⋃d2,⋯,Fi,dev,⋃dn)]; βnis the coefficient of a different subset of the large neighborhood;Fi,dev,⋃dnis the enrichment factor calculated with Eq. (7), especially for measuring the over- or under-representation of built-up land in the extended neighborhood scope; and⋃dnis a subset of the extended neighborhood.Eq. (9) can be extended to include the effects of different land-use types. With the increase in the spatial extent of the moving window of the large neighborhood, there will be many independent variables in the formula, which can be adjusted by setting the neighborhood subset interval Δr. Thus, the large neighborhood function can be constructed and the development probability affected by the large neighborhood can be calculated as follows:(10)Pln=(11+e−(β0+β1Fi,dev,⋃d1+β2Fi,dev,⋃d2+…+βnFi,dev,⋃dn))δwhere Plnis the value of the large neighborhood function;Fi,dev,⋃dnis the same extended enrichment factor input used in Eq. (9); βnis the parameter value in the large neighborhood module estimated by Eq. (9); and δ is a control factor used to adjust for the effect of the large neighborhood in the urban model.Eq. (3) is a fundamental form of constrained CA, a commonly used model in the field of urban simulation. Conceptually, this type of model includes the components of development suitability, neighborhood effects, constraints, and stochastic perturbations (White et al., 1997). Adding a large neighborhood as a moving window to an urban CA model allows Eq. (3) to be adjusted as follows (García et al., 2012; Li et al., 2014):(11)Pijt=(Pl)ij·(PΩ)ij·(Pln)ij·con()·PrwherePijtis the total development probability of cell (i, j) at moment t in the new urban CA model; (Pl)ijis the local development suitability of cell (i, j), which is calculated with the method proposed in Section 2.1 and has the same inputs and parameters as the Logistic-CA model proposed in Section 2.2; (PΩ)ijis the impact of the 3 × 3 kernel neighborhood at moment t−1; con() is the constraints on urban growth at moment t−1; (Pln)ijrepresents large neighborhood effects at moment t−1; and Pris the stochastic perturbation term. The model presented here is called Logistic-LNCA, which considers extended neighborhood effects. The Logistic-CA model proposed in Section 2.2 does not have such considerations.The components/procedures of the urban CA considering large neighborhood effects are illustrated in Fig. 2.

@&#CONCLUSIONS@&#
We developed a logistic regression urban CA model by considering the effects of a relatively large surrounding cellular space or neighborhood (Logistic-LNCA). We extended the definition of the enrichment factor to characterize the neighborhood effects of various sub-neighborhoods at different distances within a large neighborhood. The curves based on the extended enrichment factors and land-use changes during the simulation period demonstrated a strong neighborhood effect at relatively long distances (1–3 km, equal to 30–100 cells in the neighborhood radius) from the center. Both the Logistic-LNCA model and the traditional urban CA model (Logistic-CA) were used to simulate the spatio-temporal processes of urban expansion in Xiamen City, China for two periods of time: 1990–2000 and 2000–2010. The data from the first period were used for model calibration whereas the data from the second period were used for model validation. The simulation results showed that the Logistic-LNCA model could achieve higher accuracy values and Kappa coefficients than the Logistic-CA model during both the calibration and validation periods. A source budget analysis of the error budget method also supported the fact that the large neighborhood model could reconstruct historical spatial patterns with higher agreement with the reference land-use map.This simulation exercise indicated that the window size and radius interval values in the large neighborhood module have important effects on the performance of the Logistic-LNCA model. The values of these two parameters were determined through a trial-and-error method after setting parameter boundaries. The simulation results varied with window sizes and radius intervals, and their accuracies were generally better than the accuracy of the 3 × 3 kernel neighborhood model according to parameter sensitivity analysis. Over- and under-representation of built-up land in the neighborhood of new built-up land for observed and simulated land-use changes during the calibration and validation periods were further investigated. Results showed that the enrichment factors measured from simulated maps of the Logistic-LNCA model were more agreeable to the enrichment factors of observed land-use changes. The execution of the large neighborhood model required up to as twice computation power as that of the Logistic-CA model.As the large neighborhood method is suitable for logistic-based CA modeling, it is reasonable to believe that such an approach may be also be useful for other types of urban CA models such as the CLUE-S model (Verburg et al., 2002), LUCIA model (Hansen, 2007), or SLEUTH model (Clarke and Gaydos, 1998). It would be interesting to investigate the large neighborhood effects associated with various urban CA models based on artificial intelligence and evolutionary computation. Because the study area in this research was a typical coastal city, the large neighborhood model needs to be tested in other geographical areas to further investigate the performance and application of the Logistic-LNCA model. It would also be useful to incorporate the large neighborhood method into urban simulation models to examine multiple land-use changes and predict their future states.