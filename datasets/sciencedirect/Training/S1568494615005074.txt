@&#MAIN-TITLE@&#
Representing and processing lineages over uncertain data based on the Bayesian network

@&#HIGHLIGHTS@&#
We propose a method to transform the lineage expression into directed acyclic graphs (DAGs) equivalently starting from the lineage expressed as Boolean formulas for SPJ queries over uncertain data. Specifically, we discuss the corresponding probabilistic semantics and properties to guarantee that the graphical model can support effective probabilistic inferences in lineage processing theoretically.We propose the function-based method to compute the conditional probability table (CPT) for each node in the DAG. Therefore, the BN for representing the lineage expression over uncertain data, called LBN, can be constructed while generally suitable for both safe and unsafe query plans.We give the variable-elimination-based algorithm for LBN's exact inferences to obtain the probabilities of query results, called LBN-based query processing. Then, we focus on obtaining the probabilities of inputs or intermediate tuples conditioned on query results, called LBN-based inference query processing, and give the Gibbs-sampling-based algorithm for LBN's approximate inferences.

@&#KEYPHRASES@&#
Uncertain data,Lineage,Inference query,Probabilistic graphical model,Bayesian network,Approximate inference,

@&#ABSTRACT@&#
Processing lineages (also called provenances) over uncertain data consists in tracing the origin of uncertainty based on the process of data production and evolution. In this paper, we focus on the representation and processing of lineages over uncertain data, where we adopt Bayesian network (BN), one of the popular and important probabilistic graphical models (PGMs), as the framework of uncertainty representation and inferences. Starting from the lineage expressed as Boolean formulae for SPJ (Selection–Projection–Join) queries over uncertain data, we propose a method to transform the lineage expression into directed acyclic graphs (DAGs) equivalently. Specifically, we discuss the corresponding probabilistic semantics and properties to guarantee that the graphical model can support effective probabilistic inferences in lineage processing theoretically. Then, we propose the function-based method to compute the conditional probability table (CPT) for each node in the DAG. The BN for representing lineage expressions over uncertain data, called lineage BN and abbreviated as LBN, can be constructed while generally suitable for both safe and unsafe query plans. Therefore, we give the variable-elimination-based algorithm for LBN's exact inferences to obtain the probabilities of query results, called LBN-based query processing. Then, we focus on obtaining the probabilities of inputs or intermediate tuples conditioned on query results, called LBN-based inference query processing, and give the Gibbs-sampling-based algorithm for LBN's approximate inferences. Experimental results show the efficiency and effectiveness of our methods.

@&#INTRODUCTION@&#
With the increase of data volume, sharing scope and format, more and more uncertain data are generated in economy, military, logistic, finance, telecommunication, etc. Real-world data often exhibit uncertainty and impreciseness due to the imperfect nature of data-acquiring devices in many applications, such as sensor data analysis, RFID networks, multimedia databases, location-based services, object identification, data integration, and so on. Uncertain data management is the subject of great interest, concerning modeling, analysis and optimization [2,10,43]. In recent years, integration [3], query evaluation [11,22], analysis and knowledge discovery [16,20,41] of uncertain data were widely studied. It is pointed out that [10] probabilistic inference is the most challenging issue in the paradigm of uncertain data management.Lineage (also called provenance) processing over uncertain data consists in tracing the origin of uncertainties based on the process of data production and evolution. It is an important research issue in the paradigm of uncertain data, and useful for cleansing and quality management, query processing, optimization, integration, assessment and recovery [5,15]. From the database query point of view, lineages can help users understand where data come from and how they are derived [4,39]. In particular, lineages over uncertain data can be used to selectively compute confidence values for tuples of query results of interest [11].Lineages in uncertain data facilitate the correlation and coordination of uncertainty in query results with uncertainty in the input data [5]. The probabilities (i.e., confidence values) of the query results can be computed upon lineage expressions. For example, the confidence of tuple 31 in Example 1 can be easily obtained by its lineage λ(31)=11∧21 and the probabilities of the input tuple 11 and 21.Example 1Fig. 1shows an example of uncertain data and lineages [36], where prob represents tuple t's probability under the assumption of tuple independence, and λ(t) represents the lineage expression of t.In the methods of lineage processing [33,36] based on ULDB (Uncertainty-Lineage Database) [5], Boolean formulae were adopted to represent lineages, such as λ(31)=11∧21 in Example 1, as the basis for computing desired probabilities. However, Boolean formulae, as the logical representation of knowledge, cannot be used to well describe the complex correlations among data objects and the corresponding uncertainties. Furthermore, the logical inferences on Boolean formulae are always not equivalent to probabilistic inferences [12] that are really critical for lineage processing over uncertain data. Accordingly, the probabilities of query results were derived from the Boolean lineage expressions directly, but the correctness cannot be guaranteed theoretically.Moreover, lineage-based inference queries, such as P(11, 12, 23) and P(11|41) in Example 1, for obtaining the marginal probabilities on given uncertain data objects or posterior conditional probabilities conditioned on the result tuples cannot be answered, since the lineage expressions represented by Boolean formulae cannot provide a general mechanism for probabilistic inferences. Seemingly for the inference queries of conditional probability computation like P(11|41), Koch et al. [23] proposed the method to compute exact confidences and evaluate Boolean condition queries on probabilistic databases by looking upon some prior knowledge (e.g., functional dependencies) as constraints and introducing some heuristics. But the conditional probabilities are computed dependent on prior knowledge, and the constraints are actually different from lineages. This makes the inference query like P(11|41) still not solved, since the conditions are specific results of data evolution instead of predefined constraints. This means that the lineage-based inference queries still cannot be answered effectively based on the method in Ref. [23]. Therefore, it is desirable to establish an underlying model to support the equivalently probabilistic representation of Boolean lineage expressions for SPJ queries over uncertain data and the effective probabilistic inferences. Correspondingly, it is also necessary to develop an efficient and general method for lineage processing concerted on probabilistic inferences, especially for the lineage-based inference queries. These two are exactly the problems that we will address in this paper.To represent the complex correlations among uncertain objects globally, graphical models were naturally adopted for uncertain data management and mining [7,12]. Further focusing on uncertainty other than the representation of qualitative correlations, a special graphical model, called probabilistic graphical model (PGM) can provide a framework for both correlation representation and uncertainty inferences. As one of the popular and important PGMs, Bayesian network (BN) is the effective and widely used framework for uncertainty representation and inferences by means of qualitative and quantitative manners [31,32,35]. BN is a directed acyclic graph (DAG) of random variables as nodes, each of which has a conditional probability table (CPT) to describe the quantitative dependencies among the variables. BN has solid theoretical basis on the probability theory and there have been many effective algorithms for probabilistic inferences with BNs. Actually, lineages describe the causalities between input and output [6], which exactly can be represented by a BN. This establishes an effective mechanism for probabilistic inferences and lineage processing intuitively, and exactly the basis of our work in this paper.Recently, BN has been adopted in uncertain data management to describe the correlations among uncertain data objects [14,26,37,40]. Meanwhile, the graphical model has also been applied to the management of lineages of workflow and uncertain data [1,6,19,21,31,34]. But in these methods on BN-based query evaluation [26,37] and lineage processing [6,19,21,34], correlations among uncertain data objects or lineage expressions are described or modeled by BNs, and probability computations are simplified by the conditional independencies and implemented by BN's inference algorithms. On the other hand, Pearl [31] has concluded that a DAG model can be regarded as a PGM for uncertainty inferences only if this DAG is also a probability model that satisfies the necessary conditions that a graphical model can be looked upon as a probabilistic model. This means that the above methods focus on the BN-based correlation representation and probability computation over uncertain data, but the probabilistic-model-satisfied BN construction and its corresponding probabilistic semantics have not been addressed, that is, the theoretical equivalence between the correlations among uncertain objects concerned in Boolean lineage expressions and those in the corresponding BN cannot be guaranteed. Then, the effectiveness of probabilistic inferences and the correctness of inference query processing results cannot be guaranteed as well.Consequently, we [42] previously explored the PGM-based representation of lineages in uncertain data focusing on safe relational SPJ queries. However, the PGM-based representation of lineage expressions of unsafe query plans has not been addressed. From the perspective of lineage representation, it is necessary to extend this method to develop a general PGM-based representation of lineages without regard for the safety of the corresponding SPJ queries. BN's probabilistic inferences were mentioned (e.g., the method in Ref. [31]), but the effective and general algorithm for lineage-based probability computation of SPJ query results or the evaluation of inference queries has not been developed. Therefore, it is also desirable to develop general probabilistic inference algorithms by incorporating the characteristics of lineages in uncertain data.The above discussions motivate our study on effective and general PGM-based lineage representation for both safe and unsafe SPJ query plans, while basically focusing on the DAG's semantic equivalence with the Boolean lineage expressions and its correctness as a probabilistic model theoretically. Meanwhile, the above discussions also motivate our study on efficient and general lineage processing centered on probabilistic inferences. Targeting these two aspects, we will have to address the following two problems:(1)How to construct a probabilistic-model-satisfied graphical model and ultimately obtain the BN from the given Boolean lineage expressions for SPJ queries over uncertain data?How to process inference queries of lineages over uncertain data generally and efficiently?For the problem (1) as the basis of this paper, we also consider the relational SPJ queries over the given uncertain data as the representative of lineages that will be discussed later. To construct a BN, a DAG and the corresponding CPT for each node will be achieved respectively, for which our ideas are given as follows: To obtain the DAG as the desired BN's graphical structure, we consider transforming the given lineage expressions into the DAG by preserving the conditional independencies implied in the Boolean formulae. This is challenging since the knowledge representation in logical scenario is always not equivalent to that in probabilistic one [31]. The integration of logical and probabilistic knowledge was discussed in Refs. [18,25,27] generally, but the equivalent transformation from relational operations on databases into PGM still cannot be made effectively from both theoretical and technical perspectives.It is well known that in mathematical logic, a Horn clause is a disjunction of literals with at most one positive literal. The unique conclusion can be obtained in the Horn-clause-based logical inferences, and Horn clauses can be transformed into equivalent logical implications conveniently [32,35]. For example, the Horn clause11¯∨21¯∨31is equivalent to the implication 11∧21→31. In line with this basic idea and the equivalent logical transformations of Horn clauses, we are inspired by the proposal in Ref. [27], and mainly give the algorithm for transforming the equivalent Horn clauses of the Boolean lineage expression into a DAG as the dependency model, called lineage graph (LG). LG is constructed generally for the lineages corresponding to both safe and unsafe SPJ query plans. Further, we discuss the properties of conditional independency of an LG, and prove that LG satisfies the necessary conditions that a graphical dependency model can be looked upon as a probabilistic model. Therefore, the correlations among uncertain tuples concerned in the lineage expression for either a safe or unsafe SPJ query plan can be described by a PGM, and thus the feasibility of probabilistic inferences in processing lineages can be guaranteed theoretically.To obtain the CPT for each node in an LG, we consider the idea of function parameters [37,42], LG's inherent properties and the characteristics of BN's probabilistic inferences. For the nodes without parents, we obtain the CPTs from the given uncertain data directly. For those with parents, we define functions that satisfy the Boolean formulae of lineage expressions based on the graphical characteristics and conditional independencies implied in an LG. Accordingly, the BN, called lineage BN (LBN) can be constructed to represent the lineage expressions over the given uncertain data.For the problem (2), we are to generalize the current methods for both computing the probabilities of query results based on the lineage expressions (case 1), and answering inference queries for computing the marginal probabilities on given uncertain data objects or posterior conditional probabilities conditioned on the result tuple (case 2).It is known that to compute the probabilities of the query results is frequently #P hard [11,36]. From the BN-based probabilistic inference point of view, case 1 is the special situation of the case 2. Actually, the execution time of BN's exact inferences is exponential to BN's size (i.e., number of nodes in the BN or that of concerned tuples in the lineage expression) [31,35]. This motivates us to develop an approximate algorithm of LBN inferences for processing lineages efficiently. Fortunately, Markov Chain Monte Carlo (MCMC) is an effective idea for Bayes computation widely used in recent years, among which Gibbs sampling is a Monte Carlo probabilistic algorithm as the simplest and the most widely used [17,30]. By this algorithm, sampling is conducted while satisfying a certain conditional probabilistic distribution, and the samples that come from posterior or marginal distributions can be obtained when the iteration times are large enough. Therefore, based on the basic idea of Gibbs sampling and the specialties of lineage processing over uncertain data, we give an algorithm for approximate inferences of the LBN.Generally, we establish a BN-based framework for representing and processing lineages over uncertain data in this paper. The main contributions can be summarized as follows:•To represent the lineage effectively for probabilistic inferences, we give the algorithm for constructing LBN from the Boolean lineage expressions and uncertain data without regard for the safety of SPJ query plans, where we focus on the algorithm for transform the lineage expression into DAGs equivalently and emphasize the theoretical properties and correctness of the LBN as a probabilistic modelare emphasized specifically. By providing a general and theoretically correct model, we establish the basis for our LBN-based lineage processing and make it be suitable for both safe and unsafe queries.To process the lineage over uncertain data generally and efficiently, we give an algorithm for exact inferences of LBNs based on variable elimination to obtain the probabilities of query results. Then, we give an algorithm for approximate inferences of the LBN based on Gibbs sampling to obtain the probabilities of inputs or intermediate results conditioned on result tuples.To test and verify the methods proposed in this paper, we made experiments on benchmark and manual data. Experimental results show the efficiency and effectiveness of our methods.The remainder of this paper is organized as follows: In Section 2, we introduce related work. In Section 3, we propose the PGM-based representation of lineages by focusing on the DAG construction and CPT computation of LBNs. In Section 4, we give the methods for LBN-based query processing and inference query processing by exact and approximate probabilistic inference algorithms respectively. In Section 5, we present experimental results and performance studies. In Section 6, we conclude and discuss future work.

@&#CONCLUSIONS@&#
In this paper, we established a general and theoretically correct framework for lineage representation and processing over uncertain data. We gave the algorithm for constructing the lineage Bayesian network from the Boolean lineage expressions and the given uncertain tuples, where we specifically proposed the algorithm for transforming lineage expressions into probabilistic graphical models equivalently, and discussed the semantics that the LBN satisfies as a dependency model and also as a probabilistic model to guarantee the effectiveness of probabilistic inferences. Consequently, we proposed the algorithms of exact and approximate LBN inferences for lineage processing over uncertain data. Experimental results verify the efficiency and effectiveness of our methods.From both theoretic and practical perspectives, LBN can provide a uniform computational model to obtain the probabilities of lineage-based query results and trace the origin of uncertainties in data evolution. By providing the effective graphical representation and probabilistic inferences, our methods can establish the basis for error detection, experiment reproduction, data integration, etc. From the perspective of practical applications, the methods proposed in this paper can be used for tracing errors during the data generation or evolution process (such as sensor network data integration and scientific experiments), and criminal suspect evaluation upon the witness and factual records. Our methods can also establish the basis for simplifying uncertainty computation, guaranteeing the quality of uncertain data, and supporting assessment, reference description and recovery of uncertain data.However, the storage of LBNs should be studied further, since large LBNs will result in inefficiency in inferences for query processing, and the efficiency is still a problem. Then, the BN-based mechanisms for consistent combination of multiple relative lineage expressions and corresponding probabilistic inferences should be considered, since the realistic process of data evolution always includes several subtasks with inherent dependencies. Thus, the proposed methods as our initial exploration in this paper are still worth improving further for more practical and wider lineage-based applications on uncertain data. Meanwhile, further experimental evaluations on different real uncertain data sets with lineages need to be conducted.From another hand, the ideas and methods in this paper also leave open some other interesting research issues. The representation of lineages with finer granularities to reflect the whole process of data processing or evolution can be established, that is, the intermediate BNs for intermediate uncertain data processing results can be constructed based on the method for LBN construction. The lineage analysis of integrated data can also be considered further, since probabilistic inferences can be fulfilled efficiently for any query tasks. Furthermore, the quality of uncertain data can be explored by incorporating lineages and BNs, including representation and inferences of the influence or coverage of problematic data. These are exactly our future work.