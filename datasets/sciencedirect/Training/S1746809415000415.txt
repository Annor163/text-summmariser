@&#MAIN-TITLE@&#
Scalable real-time energy-efficient EEG compression scheme for wireless body area sensor network

@&#HIGHLIGHTS@&#
We propose two adaptive compression paradigms for the discrete wavelet transform (DWT) and compressive sensing (CS) compression techniques.Two optimization schemes have been developed for minimizing the total residual distortion for different channel conditions and encoder settings.Using the developed framework, the encoder can adaptively reconfigure the encoding parameters in order to match the energy constraint without performance degradation.The results demonstrate that the proposed method is superior to the previously reported methods with different implementation choices and channel conditions.

@&#KEYPHRASES@&#
Electroencephalography,Wireless body area sensor network,Compression,Convex optimization,

@&#ABSTRACT@&#
Recent technological advances in wireless body sensor networks have made it possible for the development of innovative medical applications to improve health care and the quality of life. By using miniaturized wireless electroencephalography (EEG) sensors, it is possible to perform ambulatory EEG recording and real-time healthcare applications. One master consideration in using such battery-powered wireless EEG monitoring system is energy constraint at the sensor side. The traditional EEG streaming approach imposes an excessive power consumption, as it transmits the entire EEG signals wirelessly. Therefore, innovative solutions to alleviate the total power consumption at the receiver are highly desired. This work introduces the use of the discrete wavelet transform and compressive sensing algorithms for scalable EEG data compression in wireless sensors in order to address the power and distortion constraints. Encoding and transmission power models of both systems are presented which enable analysis of power and performance costs. We then present a theoretical analysis of the obtained distortion caused by source encoding and channel errors. Based on this analysis, we develop an optimization scheme that minimizes the total distortion for different channel conditions and encoder settings. Using the developed framework, the encoder can adaptively tune the encoding parameters to match the energy constraint without performance degradation.

@&#INTRODUCTION@&#
Wireless body area sensor network (WBASN) is emerging as a promising technology for a wide variety of applications in the fields of remote healthcare monitoring, multimedia, sports, entertainment and brain computer interface (BCI) applications. WBASN consist of tiny and lightweight sensors which, have limited energy and processing resources [1]. In healthcare applications, WBASN makes use of the tiny sensors for acquisition and recording different physiological signs (PSs) (e.g., heart activity, brain activity, movements, blood pressure, and oxygen saturation). A wireless electroencephalography (EEG) sensor unit is a miniaturized, battery-powered device that has the capabilities of measuring, encoding and streaming EEG signals wirelessly to a data server, where further analysis and diagnosis are carried out [2].Because of transmission power is the dominant parameter affecting the lifetime of the portable EEG devices, streaming the entire EEG signals to the server side will be infeasible. The authors in [3] have found that the wireless transmitter consumes approximately 70% of the total power of a wireless EEG system; therefore, the size of the transmitted data has to be decreased. Several compression approaches have been reported in literatures [4–10], most of which do not address the effect of encoding parameters and wireless channel errors on both of the total system power consumption and the residual distortion at the server side. A lossy EEG compression algorithm based on the wavelet packet (WP) transform was developed in [4], which addressed the trade-off between the compression rate (CR) and the residual distortion for different WP bases, however, its computation complexity was high enough to hinder real-time operation. Another possible approach is to perform thresholding-based discrete wavelet transform compression paradigm as in [5, 6]. The authors tried to estimate the low power potential of the DWT for portable EEG units using an adaptive encoding architecture which is scalable in power consumption. The work in [7] studied, in details, the performance evaluation of 18 different compressive sensing implementations using different bases and reconstruction methods. In [8], the authors have provided an exhaustive system level comparison between compressive sensing (CS)-based and DWT-based compression techniques. They have quantified the potential of CS for low-complexity energy-efficient compression. While the computational complexity of the compression on the portable EEG unit is low, solving an optimization scheme of high computational complexity at the CS decoder might hinder real time analysis and diagnosis processes. The study proposed in [9] investigates the use of a new ensemble classifier to detect an epileptic seizure from compressed and noisy EEG signals. The authors utilize a combination of four classifier models to enhance the classification accuracy for the noise-corrupted EEG data. Moreover, a novel compression technique has been developed in [10] to achieve low distortion compared to other traditional compression methods such as 1-D set partitioning in hierarchical trees (SPIHT) [11,12]. This technique exploits both of intra-channel redundancy present within each channel and inter-channel redundancy present between different EEG channels. It uses the DWT and SPIHT in 2-D to encode the EEG channels. Nevertheless, this technique cannot be generalized to be applied on different patients since the statistical features of the patients’ recordings vary a lot between different subjects.From the total power consumption and residual distortion viewpoints, the effect of EEG encoding is twofold. First, modest EEG compression results in low distortion at the expense of high processing power. Second, more efficient EEG compression considerably reduces the amount of data to be transmitted, which in turn reduces the power consumption but at the expense of higher distortion. So, there is always a trade-off between power consumption and distortion. This work addresses how to obtain the desired reconstruction performance subject to constraints on the power budget on the sensor nodes.The contribution of this paper can be summarized as follows. First, based on the complexity analysis of the DWT and CS-based EEG encoding architecture, we have developed a flexible power model where the power can be obtained in terms of the complexity control parameters of the encoder. Second, we have successfully extended the conventional distortion–compression ratio (D–CR) analysis by considering another dimension, the power consumption, and established the power–distortion–compression ratio (P–D–CR) analysis framework for energy-constrained portable EEG devices. Third and more interestingly, for real-time monitoring, we have developed an optimization scheme that enables the encoder to reconfigure the encoding parameters based on the channel state in order to maintain the optimal reconstruction accuracy.The rest of the paper is organized as follows: Section 2 describes the system model and explains the most common compression approaches. The encoding complexity and its accompanied power consumption of a typical EEG encoder are explained in Section 3; it also addresses the analytical distortion model and dynamics. Section 4 introduces the proposed optimization schemes for both the DWT and CS approaches and explains how they achieve the optimal performance. Section 5 presents the simulation setup and results. Finally, Section 6 concludes the paper.Fig. 1shows the detailed architecture of the proposed EEG encoding system. In particular, it includes amplifier [13,14], sampling, DWT/CS compression, quantization, encoding for the quantized coefficients [15] and transmission modules [16]. In order to quantify the compression quality of the compressed EEG records using both the DWT and CS, two performance metrics are utilized, namely, compression ratio (CR) and residual distortion (D); CR is defined as(1)CR=1−MN×100where M and N represent the length of the compressed and the original signal, respectively. The distortion, D, is defined as the percentage root-mean-square difference between the original signal, x, and the reconstructed one, xr:(2)D=∥x−xr∥∥x∥×100In this work, the EEG database in [17] is utilized; it consists of five sets (denoted A–E), each containing 100 single-channel EEG segments; each segment consists of 4096 samples, while the time frame is 23.6s and the sampling rate is 173.6sample/s. Sets A and B represent healthy subjects, with eyes open and closed, respectively. Sets C and D represent non-active subjects diagnosed with epileptic disorder. Set E is taken from patients currently experiencing the epileptic seizure. It should be noted that simulation experiments are conducted and have been averaged on the five data sets.Given a great amount of existing literature on the DWT, one of the applications is relevant to the work reported here, EEG data compression. For threshold-based DWT [18], the procedure of compression starts with wavelet decomposition, while the EEG signals are analyzed using one of the mother wavelets, filter lengths and decomposition levels. Then, the wavelet coefficients are shrunk using one of the existing threshold selection rules (e.g., sqtwolog, rigsure, heursure, and minmax) [19]. Such rules are utilized to determine the threshold value at each wavelet sub-band, whereas it processes the data in such a way that only the coefficients greater than the threshold are considered. It should be noted that the coefficients in the wavelet domain are obtained as follows:(3)Wϕ(j,k)=1N∑xf(x)ϕj,k(x)(4)Wψ(j,k)=1N∑xf(x)ψj,k(x)where Wϕ(j, k) and Wψ(j, k) are the approximation and detail coefficients, respectively. The scaling function ϕ(x) is used to provide an approximation of f(x) at a scale j; where j is an arbitrary scale. The wavelet function, ψ(x), is used in the computation of the details of f(x).In order to illustrate the CS compression and reconstruction [20–22], consider the N×1 EEG signal, x, that can be represented by projection onto the basis set Ψ:(5)x=Ψswhere s is a N×1 basis function vector and Ψ is a N×N basis matrix. In compressive sensing, Ψ is chosen such that s is sparse. In particular, the vector s is K-sparse if it has K non-zero entries and the remaining N−K entries are all zeros. The vector s can be computed from the inner product of x and Ψ as(6)si=〈x,Ψi〉where siis the ith element of s and Ψiis the ith column of Ψ. It is also assumed that x is related to the observation signal y as(7)y=Φxwhere Φ is the M×N measurement matrix. The M×1 vector y is the compressively sensed version of x. Thus,(8)y=ΦΨsCompression is achieved if M<N. It can be shown that this is possible if Φ and Ψ are incoherent [20]. One way to achieve this condition is to choose Ψ as a random matrix [20]. Given a compressed measurement, y, at the receiver side, the sparse signal s can be reconstructed by solving the optimization problem [20](9)min∥s∥1s.t.y=ΦΨsFor power scalable DWT-based EEG encoder, encoding and transmission power are obtained in terms of the encoding complexity control parameters.With the aid of the diagram shown in Fig. 1, the encoding power for DWT-based compression,PEDWT, can be represented as(10)PEDWT=PAmp+PDSPDWT+PSQEwhere PAmpis fixed power consumed by the amplifier [13],PDSPDWTis the consumed power during the DWT compression module, and PSQEis the consumed power in the sampling, quantization and encoding processes. The computational complexity (measured in number of instructions) of the DWT module, denoted by CDWT, can be obtained as a function of the wavelet filter length, F, number of decomposition levels, L, and the signal length, N, as follows:(11)CDWT=F·N·∑l=0L12lthen,(12)PDSPDWT=CDWT·Pinstwhere Pinstis the power consumed per instruction to perform the DWT.For the ADC, the power consumed in sampling, quantization and encoding processes, PSQE, depends on the number of conversion steps (from samples to bits), which in turn depends on the input rate of the quantization and encoding modules, fs·(1−CR)sample/s, and the energy consumed for each conversion step, ECS. Therefore, PSQEcan be computed as(13)PSQE=fs·(1−CR)·ECSwhere fsis the sampling rate and ECSis the consumed energy at each conversion step. It should be noted that the signal length, N, can be represented as a function of the sampling rate, fs, as follows:(14)N=fs·Twhere T is the signal duration (e.g., T=23.6s) [17].From (10) and substituting with (12)–(14), the encoding power for the DWT,PEDWTis(15)PEDWT=PAmp+F·fs·T·∑l=0L12l·Pinst+fs·(1−CR)·ECSThe transmission power, PT, can be computed directly as(16)PT=fs·(1−CR)·n·Etbwhere (fs·(1−CR)·n) is the transmission rate, denoted by R, n is the ADC resolution in bits/sample, and Etbis the energy consumed to transmit one bit.Since real-time monitoring for patients with epileptic seizure is crucial for preventing complications, the EEG dataset “E” is selected for simulation in order to obtain the DWT-based source encoding distortion(DEDWT)in terms of the encoding parameters (CR, fs, F). Through polynomial regression analysis, the linear least square fitting method is utilized to obtainDEDWTin the form:(17)DEDWT=C1·CR2+C2·fs2+C3·F2−C4·CR−C5·fs−C6·F−C7·CR·fs−C8·CR·F+C9·fs·F+C10where C1, C2, C3, …, C10 are constants.Similar to the DWT-based encoder, power components and residual distortion can be obtained in terms of the encoding parameters in the context of CS-based encoding paradigm as shown below.The encoding power for CS-based compression,PECS, can be represented as(18)PECS=PAmp+PDSPCS+PSQEwhere PSQEhas the same representation as in (13) andPDSPCSis the consumed power during the CS compression module. The random number generator, RNG, is mainly utilized to generate the random measurement matrix Φ. The power consumption of such module, PRNG=2.9μW [23]. In order to carry out the compressive sensing, the signal should be multiplied by the measurement matrix Φ. The overall power,PDSPCS, depends strongly on the RNG and matrix multiplication modules as follows:(19)PDSPCS=PRNG+CMM(M,N)·Pinstwhere CMM(M, N) is the computational complexity of the matrix multiplication [24].(20)CMM(M,N)=O(M1.594·N)=([(1−CR)·N]1.594·N)=([(1−CR)1.594]·N2.594)From (18) and substituting with (13), (19) and (20), the encoding power for the CS is(21)PECS=PAmp+PRNG+CMM(M,N)·Pinst+fs·(1−CR)·ECSTransmission power for the CS-based encoder, PT, has the same expression as the DWT in (16).After surface fitting, the CS-based source encoding distortionDECScan be represented in an exponential form of the compression ratio and sampling rate as follows:(22)DECS=C11·eC12·CR−C13·e−C14·fs+C15where C11, C12, …, C15 are constants.Transmission impairments, such as attenuation, free space loss, slow fading, fast fading, refraction, noise and atmospheric absorption, affect the line of sight (LOS) transmissions. Given a distance, d, between the transmitter and the receiver, a deterministic path loss model is used [25],(23)PR=gt·gr·λ2·PT(4πd)2where PRand PTare the received and transmitted powers, gtand grare the transmit and receive antenna gains respectively, λ is the wavelength. The channel state can be characterized by the received SNR[25] which is defined as(24)SNR=α·PTN0·BWwhere N0 is the noise power spectral density and BW is the noise bandwidth. Hence,(25)SNR=α·ET·Rl·N0·BWwhere ETis the transmission energy and l is the data length in bits. From (16)(26)ET=N·(1−CR)·n·ETBThus,(27)SNR=N·n2·ETB·α·fs·(1−CR)2l·N0·BWFrom [8, 5], the channel distortion, Dch, can be measured in terms of the SNR as follows:(28)Dch=100×10(−1/20)(SNR)Substituting with (27) in (28), the channel distortion has been obtained in terms of the encoding parameters as follows:(29)Dch=100×10(−1/20)((N·n2·Etb·α·fs·(1−CR)2)/(l·N0·BW))where α=(gt·gr·λ2)/(4πd)2 is the channel overall path loss [25].The conventional analysis for the trade-off between distortion and compression ratio does not address the power consumption of the encoder's processing and transmission modules, which in turn is not efficient for energy-constrained portable EEG units. In contrast, the proposed adaptive compression paradigms study the distortion and power consumption versus the dominant encoder's control parameters for both DWT and CS-based methods.As illustrated in our previous work [26], the total power consumption for a typical DWT-based encoder, denoted by PDWT, can be obtained by the summation of the encoding and transmission powers in (15) and (16), respectively,(30)PDWT=C16+C17·F·fs+C18·fs·(1−CR)where C17=PAmp,C18=T·∑l=0L12l·Pinstand C18=ECS+n·Etb. Furthermore, the total residual distortion at the server side for the DWT-based compression approach, DDWT, is represented by the summation of both source encoding and channel distortions in (17) and (29) as,(31)DDWT=DEDWT+DchIt is worthwhile mentioning that obtaining the total distortion and total power consumption for a DWT approach in terms of the encoding complexity control parameters enables us to propose an optimization scheme, which in turn frequently reconfigures those parameters in real-time operation to obtain the optimal reconstruction accuracy. Given the reduced wavelet coefficients, the inverse discrete wavelet transform, IDWT, is used to reconstruct the EEG signals. The root mean square difference between the original and reconstructed signals is used to assess the reconstruction accuracy. The objective of the proposed optimization problem is to minimize the total distortion at the server side based on channel dynamics and under constraints that the total power consumption does not exceed a typical power budget at the sensor side, the transmission rate, R, is less than the maximum-allowable rate, and the sampling rate is below the Nyquist rate. Therefore, the problem of minimizing the total distortion can be formulated as(32)minDDWT(CR,fs,F)s.t.PDWT≤PthrR≤Rthrfs≤fsNwhere Pthris the threshold power budget and it mainly depends on the computational power of the utilized platform. Rthris the threshold transmission rate andfsNis the Nyquist sampling rate. In order to check the convexity of the optimization in (32), the Hessian matrix, H, has to be obtained [27].(33)H=∂2(D)∂(CR)2∂2(D)∂(CR)∂fs∂2(D)∂(CR)∂F∂2(D)∂fS∂(CR)∂2(D)∂fs2∂2(D)∂fs∂F∂2(D)∂F∂(CR)∂2(D)∂F∂fs∂2(D)∂F2=0.0194−0.0008−0.0041−0.00080.00040.0005−0.00410.00050.092Cholesky factorization is used in order to check if the Hessian matrix is positive-definite or not. Cholesky factorization is the decomposition of a positive-definite matrix into the product of a lower triangular matrix and its conjugate transpose [28](34)H=LL*where L is a lower triangular matrix with real positive diagonal entries, and L* denotes the conjugate transpose of L. It should be noted that L that corresponds to H is,(35)L=0.139300−0.00570.01920−0.02940.01730.3014Thus, H is positive definite matrix and the optimization scheme in (32) is convex since both the constraints and the objective are convex. It should be noted that the optimization problem in (32) was solved using typical convex optimization techniques [29].It should be noted that the general formula of the proposed optimization scheme is a three dimensional model; the resultant distortion in this case is called three dimensional optimal distortion (3D-OD). However, some applications have constraints on one or more of the encoding control parameters. Therefore, a special case of the optimization scheme is to assign a typical value for one of these parameters and tuning the others. In this case, the problem is converted into two dimensional one and the resultant distortion is called two dimensional optimal distortion (2D-OD), which represents a sub-optimal solution. In this case, one of the encoding parameters is assigned a typical value and the others two parameters are tuned such that obtaining the optimal distortion. On the other hand, another special case represents the traditional DWT compression approach, whereas no optimization schemes are proposed and a typical distortion is obtained regardless of the power constraints. Such approach represents the baseline algorithm against which the performance, computational complexity, and energy consumption of the proposed optimization-based compression technique are benchmarked. In this regard, the obtained distortion is called arbitrary distortion (AD).From (21) and (16), the total power consumption of the CS-based compression approach, PCS, can be obtained in terms of the encoding control parameters as follows:(36)PCS=C19+C20·(1−CR)1.594·fs2.594+C21·(1−CR)·fswhere C19=PAmp+PRNG, C20=T2.594·Pinstand C21=ECS+n·Etb.By considering the channel distortion in addition to the CS source encoding distortion, the total distortion for the CS-based compression approach, DCS, can be obtained by taking the sum of (22) and (29) as follows:(37)DCS=DECS+DchSimilar to (32), an optimization model has been formulated in order to minimize the total distortion of the CS-based compression approach.(38)minDCS(CR,fs)s.t.PCS≤PthrR≤Rthrfs≤fsNThe convexity of the CS-based optimization scheme in (38) is also verified using the Cholesky decomposition, while the Hessian matrix is found to be a positive-definite. The general form of the proposed CS-based optimization scheme is delineated by two dimensional optimization exemplar, where the residual distortion is obtained as a function of the parameters CR and fs. To obtain the CS-based optimal distortion, the encoding parameters CR and fsare updated frequently according to channel condition such that minimizing the total distortion subject to certain constraints on power and transmission rate.

@&#CONCLUSIONS@&#
We have developed an EEG encoding architecture which is fully scalable in power consumption. Specifically, we have introduced several control parameters into the EEG encoder in order to control the total consumption of the major encoding and transmission modules. Based on the proposed power and distortion models, we have developed an optimization scheme to determine the best configuration of the encoding control parameters under the constraint that total power consumption and transmission rate are below a typical threshold. In real time operation, the developed optimization scheme adaptively reconfigures the tuning parameters according to the channel variations. Simulation results have demonstrated that the proposed method is superior to the previously reported methods for different implementation choices and channel conditions.