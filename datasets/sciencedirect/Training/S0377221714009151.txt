@&#MAIN-TITLE@&#
Hedging Conditional Value at Risk with options

@&#HIGHLIGHTS@&#
We derive an analytic formula for CVaR of stock hedged with put options.The CVaR of such position can be optimised using linear programming.The work is a generalisation of Ahn et al. (1999), where VaR was used instead of CVaR.

@&#KEYPHRASES@&#
Conditional Value at Risk,Expected Shortfall,Measures of risk,Risk management,

@&#ABSTRACT@&#
We present a method of hedging Conditional Value at Risk of a position in stock using put options. The result leads to a linear programming problem that can be solved to optimise risk hedging.

@&#INTRODUCTION@&#
One of the natural ideas to reduce risk of a position in stock is to buy put options. By doing so one can cut off the undesirable scenarios, while leaving oneself open to the positive outcomes. A choice of a high strike price of the put option does cut off more of the unfavourable states, but at the same time produces higher hedging costs. The question of how to balance the two trends so that the level of risk measured by Value at Risk (VaR) is minimised was investigated by Ahn, Boudoukh, Richardson, and Whitelaw (1999).The Value at Risk, which is the worst case scenario of loss an investment might incur at a given confidence level, has established its position as one of the standard measures of risk, and is widely used throughout the field of finance and risk management. One of its shortcomings is that it neglects potential severity of unlikely events. Another, that it is not sub-additive, and is thus not a coherent risk measure (Artzner, Delbaen, Eber, and Heath, 1999). Its most common modification to achieve these goals is the Conditional Value at Risk (CVaR) (also referred to as ‘Expected Shortfall’), which takes into the account the average loss exceeding VaR. The CVaR is a coherent risk measure (the proof can be found in the work of Acerbi and Tasche, 2002).In this paper we show a mirror result to Ahn et al. (1999), using CVaR instead of VaR. It turns out that in such setting one can achieve closed form formulae for CVaR of stock hedged with puts. These can be used to optimise the position by solving a linear programming problem.We restrict our attention to the Black–Scholes model and consider investments in stock and put options. The optimisation of CVaR can be carried out under more general assumptions, using also other securities (as an example see Rockafellar and Uryasev, 2000; 2002). One can also hedge CVaR dynamically (as in the work of Melnikov and Smirnov, 2012), which provides slightly better results. Dynamic strategies though require constant rebalancing, which in practice can be costly. Advantages of our approach are as follows: its simplicity; closed form analytic formula for CVaR; protection against risk is very similar to the one attainable using dynamic strategies.The paper is organised as follows. Section 2 recalls the results of Ahn et al. (1999) for hedging of VaR with put options. This section serves also as preliminaries to the paper. In Section 3 we generalise the result to use CVaR instead of VaR. The main result of the paper is given in Theorem 4. The section ends with an example of its application. In Section 4 we compare our method to the results attainable using dynamic strategies. They turn out to be close. We finish the paper with a short conclusion in Section 5.In this section we set up our notations and recall the results of Ahn et al. (1999).Let X be a random variable, which represents a gain from an investment. For α in (0, 1), we define the Value at Risk of X, at confidence level 1 − α, as VaRα(X) = −qα(X), where qα(X) is the upper α-quantile of X.We consider the Black–Scholes model, where the stock price evolves according to dS(t) = μS(t)dt + σS(t)dW(t), with the money market account dA(t) = rA(t)dt. A European put option with strike price K and maturity T has payoff P(T) = (K − S(T))+ and costs(1)P(0)=P(r,T,K,S(0),σ)=Ke−rTN(−d−)−S(0)N(−d+),where(2)d+=d+(r,T,K,S(0),σ)=lnS(0)K+(r+12σ2)TσT,d−=d−(r,T,K,S(0),σ)=d+−σT,and N is the standard normal cumulative distribution function.Assume that we buy x shares of stock and ziput options with strikes Ki, which cost Pi(t) for i = 1, …, n and t = 0, T. Let z, 1 and P(t) be vectors inRndefined asz=[z1⋮zn],1=[1⋮1],P(t)=[P1(t)⋮Pn(t)].The value of our investment at time t is V(x, z)(t) = xS(t) + zTP(t). The following theorem can be used to compute VaR for the discounted gainX(x,z)=e−rTV(x,z)(T)−V(x,z)(0).Theorem 1Ahn et al., 1999If zi≥ 0, for i = 1, …, n, and zT1 ≤ x, then(3)VaRα(X(x,z))=V(x,z)(0)−e−rT(xqα(S(T))−zTqα(−P(T))),where(4)qα(−P(T))=−[(K1−qα(S(T)))+⋮(Kn−qα(S(T)))+].One of the shortcomings of VaR is that it neglects the tail of the loss distribution. An improvement in this respect is the Conditional Value at Risk, defined asCVaRα(X)=1α∫0αVaRβ(X)dβ=−1α∫0αqβ(X)dβ,with a well known equivalent form(5)CVaRα(X)=−1α[E(X1{X≤qα(X)})+qα(X)(α−P(X≤qα(X))].The CVaR also has the advantage of being a coherent risk measure (Acerbi and Tasche, 2002; Artzner et al., 1999).Our aim is to give a mirror result to Theorem 1, using CVaR as the risk measure. We start with a simple lemma.Lemma 2For anyq∈R,E(S(T)|W(T)≤qT)=1N(q)S(0)eμTN(q−σT).LetZ=W(T)/T. SinceP(Z≤q)=N(q)>0,E(S(T)|Z≤q)=1P(Z≤q)∫−∞qS(0)e((μ−σ22)T+σTx)12πe−x22dx=1N(q)S(0)eμT∫−∞q12πe−(x−σT)22dx=1N(q)S(0)eμTN(q−σT),as required.□Let Z be a random variable with standard normal distribution N(0, 1). To compute CVaRα(X(x, z)), we introduce notationsd−μ=d−(μ,T,K,S(0),σ),d+μ=d−μ+σT,d−μ,α=max(d−μ,−qα(Z)),d+μ,α=d−μ,α+σT,(6)Pα(K)=Ke−μTN(−d−μ,α)−S(0)N(−d+μ,α).We first consider the case when we invest in puts with a single strike K1 = K.Proposition 3If z = [z1], forz1=z∈[0,x],thenCVaRα(X(x,z))=V(x,z)(0)−1αe(μ−r)T[xS(0)N(qα(Z)−σT)+zPα(K)].We first observe that(7)X(x,z)=e−rT(xS(T)+z(K−S(T))+)−V(x,z)(0).Since z ≤ x, we see that(8)s→e−rT(xs+z(K−s)+)−V(x,z)(0)is a non-decreasing function of s. Alsoξ→S(0)exp((μ−σ2/2)T+σTξ)is increasing. Combining these two facts, takingZ=W(T)/T,(9){X(x,z)≤qα(X(x,z))}={S(T)≤qα(S(T))}={Z≤qα(Z)}.We first prove the claim for z < x. Then (8) is strictly increasing, thereforeP(X(x,z)≤qα(X(x,z)))=P(S(T)≤qα(S(T)))=α,and(10)CVaRα(X(x,z))=−E(X(x,z)|X(x,z)≤qα(X(x,z)))=−E(X(x,z)|Z≤qα(Z))(see(9))=V(x,z)(0)−e−rTxE(S(T)|Z≤qα(Z))(see(7))−e−rTzE((K−S(T))+|Z≤qα(Z)).We now compute the last term in (10). Since{S(T)≤K}={Z≤−d−μ},E((K−S(T))+|Z≤qα(Z))=1α∫−∞min(qα(Z),−d−μ)(K−S(0)e(μ−σ22)T+σTx)12πe−x2dx=1α∫−∞−d−μ,αK12πe−x2dx−1α∫−∞−d−μ,αS(0)e(μ−σ22)T+σTx×12πe−x2dx=1αKN(−d−μ,α)−1αP(Z≤−d−μ,α)E(S(T)|Z≤−d−μ,α)=1αKN(−d−μ,α)−1αS(0)eμTN(−d−μ,α−σT)(byLemma2)=1αeμT(Ke−μTN(−d−μ,α)−S(0)N(−d+μ,α)).Substituting the above into (10) and applying Lemma 2 gives the claim.We now need to consider the case when z = x. Since for any β ∈ (0, 1), limz↗xqβ(X(x, z)) = qβ(X(x, x)), we obtainlimz↗xCVaRα(X(x,z))=limz↗x−1α∫0αqβ(X(x,z))dβ=−1α∫0αqβ(X(x,x))dβ=CVaRα(X(x,x)).Hence the result follows from the fact that the formula for CVaRα(X(x, z)) in the claim is continuous with respect to z.□We can now formulate our main result.Theorem 4If zi≥ 0 for i = 1, …, n and z1 + ⋅⋅⋅ + zn≤ x, then(11)CVaRα(X(x,z))=V(x,z)(0)−1αe(μ−r)T[xS(0)N(qα(Z)−σT)+zTPα],where Pα= (Pα(K1), …, Pα(Kn)).The proof follows from mirror arguments to the proof of Proposition 3.□We show how Theorem 4 can be applied. Assume that x is fixed. We investigate how to minimise CVaRα(X(x, z)) by choosing z. Assume that we invest V0 and spend c = V0 − xS(0) on put options. By (11), minimising CVaRα(X(x, z)) is equivalent to the problem:(12)minzTPαsubjectto:zTP(0)=c,zT1≤x,z0,…,zn≥0.This is a linear programming problem, which can easily be solved numerically.The result can be complemented by computingE(X(x,z))to give risk/return type analysis. A direct computation givesE(X(x,z))=e−rT[xS(0)eμT+zTE(P(T))]−V(x,z)(0),whereE(P(T))=eμT[P(μ,T,K1,S(0),σ)⋮P(μ,T,Kn,S(0),σ)].Example 5Consider S(0) = 100, μ = 10 percent, σ = 0.2 and r = 3 percent. Assume that we spend V0 = 1000, investing in stock and put options with strike prices K1 = 80, K2 = 90, K3 = 100, K4 = 110, K5 = 120 and expiry T = 1. We shall solve (12) for α = 0.05, considering c ∈ [0, 160].The choice of x depends on c, since xS(0) + c = V0.We compute the vectors:P(0)=[0.8602.7696.45812.04219.220],Pα=[0.3660.8191.2711.7242.176],E(P(T))=[0.4201.5744.1488.52714.686].The solutions to the problem (12) are:cxz1z2z3z4z5CVaRαE01000000302.2472.51209.83.746.06000180.3561.84409.605.963.6400126.2453.35609.400.199.210089.6445.52809.2005.513.69071.4239.411009001.507.50053.8233.351208.80006.851.9541.6428.311408.60003.525.0832.7023.861608.40000.208.2023.7519.42From the table we observe that for larger c we can afford to buy options with higher strike prices, which provide better protection, but are at the same time more expensive.An alternative to hedging with put options is to engage in a self financing strategy that will reduce the risk. In this section we explore the differences between this approach and our method.Föllmer and Leukert (2000) developed a method for dynamic optimisation of VaR. Melnikov and Smirnov (2012), (by combining techniques from Föllmer and Leukert, 2000 with Rockafellar and Uryasev, 2000; 2002) extend the method to the setting of dynamic optimisation of CVaR. They consider a contingent claim with a time T payoff H, and solve the following problem:(13)minξCVaRα(e−rT(Vξ(T)−H)),subjecttoVξ(0)≤V0,where Vξ(t) is the time t value of a self financing strategy ξ, andV0≤E*(H).(HereE*stands for expectation with respect to the risk neutral measure.) Problem (13), in other words, is how to minimise the risk of a position in a contingent claim H, having available V0 for hedging, which is smaller than the cost of the replicating strategy of the claim.In our setting, we hedge a position in x shares of stock. We can take(14)H=erTV0−xS(T).The interpretation of such choice of H is as follows. We borrow V0 and buy x shares of stock. The remainingc=V0−xS(0),is spent on a self financing strategy ξ, which involves continuous time trading in stock and money market account. The combined position at time T is − erTV0 + xS(T) + Vξ(T). After discounting, this is−V0+e−rTxS(T)+e−rTVξ(T)=e−rT(Vξ(T)−H),which fits the framework of problem (13).The following theorem provides the solution to problem (13 ) for the payoff (14). It is a reformulation of Theorem 2.4 from Melnikov and Smirnov 2012 (adapted to our particular setting and notations).Theorem 6Melnikov and Smirnov, 2012LetK*∈Rbe a number satisfyingc=xE*(e−rT(K*−S(T))+).Let b(K) be a function implicitly defined by(15)c=xE*(e−rT(K−S(T))+1{ST>b(K)}),and let(16)c(K)={V0−xe−rTK+xe−rTαE((K−S(T))+1{ST≤b(K)})forK>K*V0−xe−rTKforK≤K*.Let H be defined by (14). Then the solution of problem (13) is(17)CVaRα(e−rT(Vξ(T)−H))=minKc(K),and the optimal strategy is the one replicating the contingent claim with the payoff(18)(K−S(T))+1{ST>b(K)}.Since(K−S(T))+1{ST≤b}=(b−S(T))++(K−b)1{S(T)≤b},the term involving expectation in (16) isE((K−S(T))+1{ST≤b})==eμTE(e−μT(b−S(T))+)+(K−b)E(1{S(T)≤b})=eμTP(μ,T,b,S(0),σ)+(K−b)N(−d−(μ,T,b,S(0),σ)).Similarly, since(K−S(T))+1{ST>b}=(K−S(T))+−(b−S(T))+−(K−b)1{S(T)≤b},the constraint (15) isc=xP(r,T,K,S(0),σ)−xP(r,T,b,S(0),σ)−x(K−b)e−rTN(−d−(r,T,b,S(0),σ)).This means that we have analytic formulae for all the ingredients of Theorem 6, and thus problem (17) can be solved numerically with relative ease.Example 7As in Example 5, consider S(0) = 100, μ = 10 percent, σ = 0.2, r = 3 percent and the hedging costs c = 20, 40, 60, …, 160. The K solving (17) and the resulting optimal CVaRα(e−rT(Vξ(T) − H)) are as follows:cxKCVaRα209.887.06172.06409.694.43120.23609.499.8489.25809.2104.4167.851009108.5352.101208.8112.4040.121408.6116.1230.841608.4119.7823.59By comparing the values from tables in Examples 5 and 7, we see that optimal CVaRαfrom dynamic hedging are close to CVaRαfor the static hedging with puts. Since the difference is small, an investor might prefer to buy a portfolio of puts and go for a static hedging position, rather than engage in a dynamic hedging strategy.

@&#CONCLUSIONS@&#
