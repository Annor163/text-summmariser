@&#MAIN-TITLE@&#
General triangular midpoint subdivision

@&#HIGHLIGHTS@&#
Smoothness of general triangular midpoint surfaces for arbitrary control meshes.C1analysis tools for infinite classes of triangular subdivision schemes.New spectral properties of subdivision matrices.Smoothness analysis of Loop subdivision surfaces.

@&#KEYPHRASES@&#
Subdivision surfaces,Loop subdivision algorithm,Midpoint subdivision algorithm,Difference schemes,Extraordinary points,Characteristic map,

@&#ABSTRACT@&#
In this paper, we introduce triangular subdivision operators which are composed of a refinement operator and several averaging operators, where the refinement operator splits each triangle uniformly into four congruent triangles and in each averaging operation, every vertex will be replaced by a convex combination of itself and its neighboring vertices. These operators form an infinite class of triangular subdivision schemes including Loop's algorithm with a restricted parameter range and the midpoint schemes for triangular meshes. We analyze the smoothness of the resulting subdivision surfaces at their regular and extraordinary points by generalizing an established technique for analyzing midpoint subdivision on quadrilateral meshes. General triangular midpoint subdivision surfaces are smooth at all regular points and they are also smooth at extraordinary points under certain conditions. We show some general triangular subdivision surfaces and compare them with Loop subdivision surfaces.

@&#INTRODUCTION@&#
Subdivision surfaces are valued in computer graphics and CAGD for their convenience and flexibility to represent free-form surfaces of arbitrary topology and for their intimate relation to multiresolution analysis. The papers by Catmull and Clark (1978) and by Doo and Sabin (1978) are the first on subdivision algorithms for arbitrary quadrilateral meshes with extraordinary vertices or faces. Loop's algorithm (Loop, 1987) generalizes the subdivision scheme for three-directional quartic box splines over regular triangular meshes. Stationary subdivision for regular meshes was intensively studied in Micchelli and Prautzsch (1987a, 1987b, 1989), Dyn et al. (1991), Cavaretta et al. (1991), Dyn (1992). The first smoothness analysis of stationary subdivision at extraordinary points was outlined by Sabin in 1978 (Doo and Sabin, 1978), but it took another 15 years until Reif established a rigorous proof (Reif, 1993). Reif's proof is based on an analysis of the subdivision matrix and requires computing or estimating its spectral properties. If done numerically, this approach is limited when it comes to analyzing infinite classes of subdivision schemes (Peters and Reif, 1997, 1998; Umlauf, 2000; Zorin and Schröder, 2001).The Lane–Riesenfeld subdivision algorithm (Lane and Riesenfeld, 1980) has been developed for rapidly computing cardinal tensor product splines of arbitrary degree and it can be applied only to regular (quadrilateral) meshes. Midpoint subdivision generalizes Lane–Riesenfeld subdivision in so far as it can be applied to arbitrary 2-dimensional manifold meshes. A midpoint subdivision scheme is determined by an operatorAn−1R□of degreen∈N, which is used successively to subdivide an input meshM. The refinement operatorR□mapsMto the quadrilateral meshR□M, where the edges ofR□Mconnect the center with all edge midpoints for each face ofMand any vertex ofMwith all adjacent edge midpoints as shown at the top of Fig. 1. The averaging operator A mapsMto the dual meshAMthat connects the centers of adjacent faces as shown at the bottom of Fig. 1.Using numerical computations, Zorin and Schröder were able to analyze the midpoint schemes up to degree 9 (Zorin and Schröder, 2001). Only recently, further arguments were developed that helped to show that all midpoint subdivision surfaces of any arbitrarily high degree areC1everywhere (Prautzsch and Chen, 2011). The results even apply to wave schemes which form a much wider infinite class of subdivision schemes (Chen and Prautzsch, 2013).In this paper, we further develop the aboveC1analysis technique to analyze a class of triangular subdivision schemes that operate on arbitrary 2-dimensional triangular manifold meshes. Although many arguments used in Prautzsch and Chen (2011), Chen and Prautzsch (2013) also apply to the new triangular subdivision schemes, we are challenged by new problems:•In a regular triangular mesh we have three edge directions versus two in regular quadrilateral meshes. Since the edge directions form smaller angles for triangular meshes, we need to adjust our tangent estimates to show regularity and injectivity.For extraordinary points of valence 3, the regularity and injectivity of the characteristic map cannot be checked as easily as for quadrilateral meshes.General triangular midpoint subdivision is defined in Section 2 and itsC1-property for regular meshes is shown in Section 3. For arbitrary meshes, the convergence under subdivision is shown in Section 4 andC1-smoothness is analyzed in Sections 5 and 6. Some examples of general triangular midpoint subdivision schemes are given in Section 7 and the paper ends with a few concluding remarks in Section 8.On regular triangular meshes a triangular midpoint subdivision scheme of order n is defined by the operatorA111nR, where R is the refinement operator that subdivides all triangles uniformly into four congruent triangles as shown in Fig. 2andA111is the symmetric averaging operator that is given by a single mask as shown in Fig. 3first introduced in Boehm (1983).The triangular midpoint scheme over regular triangular meshes generatesC2nthree-directional box splines of total degree3n+1(Prautzsch, 1984; Prautzsch and Boehm, 2002).The Loop scheme (Loop, 1987) generalizesA111RtoAαRsuch that it can be applied to arbitrary triangular meshes, where the (generalized) averaging operatorAαis defined on arbitrary triangular meshes with the mask shown in Fig. 4and the constraintα(6)=1/4.ReplacingA111byAαresults in the general triangular midpoint subdivision operator of order n, wheren≥1. More precisely, the general triangular midpoint operator of order n is defined byU=AαnAαn−1⋯Aα1Rwithαi(m)∈(0,1)andαi(6)∈[1/7,1)for all i and m.Ifα≡1/3, thenAα=A2on arbitrary triangular meshes, where A is defined at the bottom of Fig. 1 which is also applicable to arbitrary triangular meshes.U=A2nRis called the midpoint scheme of order n for triangular meshes and it has been analyzed in Umlauf (1999).We show that general triangular midpoint subdivision surfaces areC1at all their regular points and also at their extraordinary points for most general triangular midpoint subdivision schemes.To analyze the smoothness of general triangular midpoint subdivision for regular meshes, we introduce a second order difference scheme and analyze its norm.A regular triangular meshCcan be represented by the bi-infinite matrixC=[ci]i∈Z2of its verticesci, which are connected by the edgescjcj+ek,j∈Z2,k=1,2,3, as shown in Fig. 5.To analyze smoothness, we need the backward differences∇kci=ci−ci−ek,k=1,2,3,∇ci=[∇1ci∇2ci∇3ci],∇∇ci=∇(∇ci)=[∇1∇1ci∇1∇2ci⋯∇3∇3ci],and the meshC∇∇=[∇∇ci]i∈Z2of the second order differences∇∇ci.Let U beAα, R, or a general triangular midpoint subdivision operator. Since U maps a grid[l(i)]i∈Z2onto itself, wherel:R2→Ris any linear function, a second order difference schemeU∇∇exists such that(UC)∇∇=U∇∇C∇∇for all meshesC, see Kobbelt (2000, Eqs. (11) and (12)).Next, we restrictα(m)to the valencem=6and view α as a constant.Applying a general triangular midpoint subdivision operatorU=AαnAαn−1⋯Aα1Rto the gridZ2, we obtain the scaled gridZ2/2. Hence, according to Dyn (1992, Theorem 7.6), U is aC1-scheme if‖U∇∇k‖<1/2kfor some k, where‖C‖∞:=supi∈Z2⁡‖ci‖and‖T‖:=sup‖C‖∞=1⁡‖TC‖∞for any operator T and any regular meshC=[ci]i∈Z2. Since any vertex in⋃i,j=1,2,3∇i∇jRCis zero or a vertex in⋃i,j=1,2,312∇i∇jCand since there is at least one zero in any 1-ring of∇i∇jRC, we obtain‖(AαR)∇∇‖<12forα∈[0,1). Since(Aα)∇∇=Aαand‖Aα‖=1, we conclude‖U∇∇‖≤‖(Aαn)∇∇‖⋯‖(Aα2)∇∇‖‖(Aα1R)∇∇‖<12.Theorem 3.1C1-continuity for regular meshesAny general triangular midpoint schemeU=Aαn⋯Aα1Rwithα1,…,αn∈[0,1)is aC1-scheme for regular meshes.In this section, we consider general triangular midpoint subdivision for arbitrary triangular meshes with extraordinary vertices. We recall some results for wave schemes from Chen and Prautzsch (2013), which are also true for general triangular midpoint subdivision.Interior vertices of a mesh are called extraordinary if their valence does not equal 6. Subdividing by R andAαdoes not increase the number of extraordinary vertices and isolates these vertices. Therefore, it suffices to consider only (sub)meshes with one extraordinary vertex as illustrated in Fig. 6. These meshes are called ringnets.Given a ringnetNand a general triangular midpoint subdivision operator U of order n, we generate the sequenceN(l)=UlN,l=1,2,….Definition 4.1Ring and ringnetLetN0be the submesh ofNconsisting of the extraordinary vertex ofN. The k-th ring aroundN0is denoted byNk. For0≤i≤j, the submeshNi…jconsists of the ringsNi,Ni+1,…,Njand the edges ofNthat connect these.N0…kis called a k-ringnet or k-net for short.We say that a meshNinfluences another subdivided meshMif during subdivision every vertex inNhas an effect on some vertex inMand if additionally all vertices inMdepend on some vertex inN.Remark 4.2Core meshThe n-netN0…nofNconsists of all vertices influencingN0(l)for somel≥1. It is called the core (mesh) ofNwith respect to U.Depending on the context, we treat any mesh as the set of all vertices or as a matrix where each row represents a vertex.If we subdivide just the regular parts of anyN(k), we obtain for every k a limiting surfacesk. Sincesk+1containssk, we can consider the difference surfacerk=sk+1\skwhose control points are contained in a sufficiently large subnetN0…ρ(k)withρ≥nnot depending on k. SinceN0…n+ldeterminesN0…n+2l(1)forl≥0, the operator U restricted to ρ-nets can be represented by a matrix S called the subdivision matrix, i.e.,N0…ρ(k+1)=SN0…ρ(k).Since S is stochastic and sinceN0influencesN0…ρ(l)for sufficiently large l, the surfacesrkconverge to a point (Micchelli and Prautzsch, 1989, Theorem 2.1), which givesTheorem 4.3C0-property ofUThe subdivision surfaces generated by U withαi∈(0,1)areC0-continuous.For theC1analysis of general triangular midpoint subdivision, we need to investigate the eigenvectors and eigenvalues of the subdivision matrix S. As in Chen and Prautzsch (2013), we order any ρ-netNsuch thatN=[N0…nNbNaNn+2⋮Nρ],whereNaconsists of the convex corners andNbof all other points inNn+1(see Fig. 6 for an illustration of the convex corners). With this arrangement, the subdivision matrix S has the lower triangular form(5.1)S=[C⁎B⁎⁎A⁎⁎⁎0⋮⋱⋱⁎………⁎0],whereN0…n(1)=CN0…n,Nb(1)=[⁎B][N0…nNb],andNa(1)=[⁎⁎A][N0…nNbNa].Hence, the eigenvalues of S are zero or are the eigenvalues of the blocks C, B, and A.Lemma 5.2Spectral radii ofAandBThe spectral radiiγAandγBof A and B satisfyγA≤12βandγB≤2n−1βwithβ:=1−α1(6)6⋅⋯⋅1−αn(6)6.In particular, ifn≥1, thenγA,γB≤1/6.Since A is non-negative, we get (Horn and Johnson, 1985, Corollary 6.1.5)γA≤‖A‖∞=‖A1‖∞,where1:=[1…1]t.The vectorA1represents the convex corners ofNn+1(1)ifN0…n=0,Nb=0,Na=1, andNn+2…ρ=0. One can easily verify that the (scalar valued) vertices of these convex corners are12β, which concludes the proof of the first statement. The second statement can be proven similarly.  □Remark 5.3Lemma 5.2 even holds ifαi(6)∈[0,1].We are now going to consider the eigenvalues and eigenvectors of the matrix block C.Definition 5.4Grid meshA grid mesh of valence m and frequency f is a planar (primal) ringnet with the verticesgijl=[Re(gijl)Im(gijl)]∈R2,wheregijl=ieıˆ2πlf/m+jeıˆ2π(l+1)f/m∈Candi,j≥0,l∈Zm,ıˆ=−1(see Fig. 7). For fixed l, the verticesgijlwith(i,j)≠(0,0)of a grid meshNbuild the l-th segment ofN. The segment angle ofNisφ=2πf/m. The half-line from the centerg00lthroughg10lor throughg11lis called the l-th spoke or the(l+12)-th spoke, respectively, denoted bySl(N)andSl+12(N), orSlandSl+12for short.Topologically, any ringnetMis equivalent to a grid meshN. Therefore we use the same indices for equivalent vertices and denote the vertices ofMbypijl. Note thatp000,…,p00m−1all denote the same vertex.Definition 5.5Rotation symmetric ringnetA planar ringnet of valence m with the verticespijlinR2is called rotation symmetric with frequency f, ifpijl+1=[cos⁡φ−sin⁡φsin⁡φcos⁡φ]pijlwithφ=2πf/m.φ is called the segment angle of the ringnet.Next we construct and analyze a characteristic map of a general triangular midpoint subdivision schemeU=AαnAαn−1⋯Aα1Rand denote its subdivision matrix by S with the form of Eq. (5.1). We follow Chen and Prautzsch (2013) and use results stated there for wave schemes that are also valid for general triangular midpoint subdivision since their proofs are only based on the properties that the subdivision scheme preserves symmetry and generates convex combinations.Proceeding as for Theorem 5.3 and Lemma 5.4 from Chen and Prautzsch (2013), we can proveTheorem 5.6M∞andλφLetMbe the core mesh of a grid mesh with frequencyf>0and segment angleφ:=2πfm∈(0,π).LetMk:=(UkM)0…n‖(UkM)0…n‖be the subdivided and normalized meshes, where‖⋅‖denotes any matrix norm. Forα1,…,αn∈(0,1), we get(a)The sequence(Mk)k∈Nconverges to a rotation symmetric eigennetM∞with segment angle φ and a positive eigenvalueλφ, which depends only on φ but not on f and m.(M∞)0…1has at least one non-zero edge. Additionally, we defineλπ=|ξπ|, whereξπis the maximum eigenvalue associated with a rotation symmetric eigenvector with segment angle π.Restricting U to core meshes, the eigenvalueλφis the dominant eigenvalue of the eigenspaces of frequencies f andm−fand it has geometric and algebraic multiplicity 2.λα>λθ>λπfor0<α<θ<π.Form=6, the subdivision matrix S has the subdominant eigenvalue 1/2.λπ/3=1/2holds for any m and f such that2πf/m=π/3.Theorem 5.6 lets us compare all dominant eigenvalues of frequencies ≥1. To further compare these eigenvalues with the subdominant eigenvalueμ0of frequency 0, we consider two ringnets of frequency 0 with different valencesm1andm2. If their first segments and their extraordinary vertices are identical, then the generated first segments and the generated extraordinary vertices are also identical after an operation of R orAαifα(m1)=α(m2). Therefore and since for regular points the subdominant eigenvector of S has frequency 1, we obtain from Theorem 5.6(c, d, e), thatμ0, for a fixed valencem≥7and constant functionsα1,…,αnwithαi(m)=αi(6), satisfies|μ0|≤1/2=λπ/3<λ2π/m.With Lemma 5.2, we arrive atγA,γB<12<λ2π/m.Hence, for constantαiandm≥6,λ2π/mis a subdominant eigenvalue with geometric and algebraic multiplicity 2 not only of C but also for the entire matrix S and it is easy to deriveCorollary 5.7Characteristic meshLet C be the subdivision matrix for the core mesh. If C has a subdominant eigenvalue λ of geometric and algebraic multiplicity 2, ifγAandγB<λ, and if for any meshMthe sequence(CkMcore/‖CkMcore‖)kconverges to a subdominant eigenvector of S, then the meshesSkM0…ρ/‖SkM0…ρ‖converge to a subdominant eigenvector of S with eigenvalue λ having geometric and algebraic multiplicity 2. Such an eigenvector of S is called a characteristic mesh. It controls the characteristic map defined inReif (1995).Corollary 5.8Characteristic mesh for general midpoint schemesA general midpoint subdivision scheme for triangular meshes withαi(m)∈(0,1)has a characteristic mesh if(5.9)λ2π/m>max⁡{|μ0(m)|,γ(B),γ(A)},or ifm≥6andαi(m)=αi(6)for all i.LetCbe the characteristic mesh of valence m of the general triangular midpoint schemeU=AαnAαn−1⋯Aα1Rwithn≥1andαi(6)∈[1/7,1). It defines the control mesh of a characteristic map, which is a surface ring consisting of m segments.Theorem 6.1Characteristic mapThe characteristic map of U is regular and injective if(5.9)is satisfied or ifm≥7andαi(m)=αi(6),i=1,…,n.To simplify the notation, we identify the real planeR2with the complex planeCby the bijectionR2∋[xy]t↦x+ıˆy∈C. Letc(x,y):Ω→Cbe a segment of the characteristic map of U, where Ω is shown at the left of Fig. 8.First, we consider a grid meshMas shown at the right of Fig. 8 such that the subdivided and normalized meshesMk=(UkM)0…ρ/‖(UkM)0…ρ‖converge to the characteristic meshCdue to Corollaries 5.7 and 5.8. LetEk=∇2(Mk)andE=∇2(C), where the edge set of a ringnetK=[pijl]is defined by∇2(K):={pi,j0−pi,j−10|i≥0,j>0}∪{pi,j−1−pi+1,j−1−1|j>i≥0},as illustrated by the set of the edges with double arrows in Fig. 8. These and other edges control the directions of the partial derivativescy(Ω). Furthermore, we add bothu1andıˆu−0.5toEkandE, whereu1is the edge direction of the spokeS1andıˆu−0.5is the edge direction of the spokeS−0.5rotated by+π/2. Refining and averaging a mesh also means that its edges are averaged by the masks shown in Fig. 9. In particular, the edges inEkare either, due to symmetry, parallel tou1orıˆu−0.5, or obtained by iteratively averaging the edges inEk−1and multiplying these by positive numbers because of the normalization. This implies thatEklies in the cone spanned byEk−1, i.e., in the coneD0:={[0,∞)eıˆ[π/2−π/m,2π/m],ifm=3,4,5[0,∞)eıˆ[2π/m,π/2−π/m],ifm≥7.Therefore, by induction, allEkandElie inD0.Moreover, according to Theorem 5.6(a),C0…1is rotation symmetric and at least one of its edges is non-zero. SubdividingC, we see that every element ofEis a linear combination ofEwith non-negative weights and a positive weight for the non-zero element in the 1-ringnet. Hence,Edoes not have zero elements, i.e.,Cdoes not have zero edges.Second, we observe that for a ringnetN=2kUkCfor somek≥0, each element of∇2(2RN)and∇2(AαN)is a convex combination of elements in∇2(N), in∇2(N)reflected atS1, and in−∇2(N)reflected atS−0.5, where a reflected element has a weight that is not larger than the weight of its unreflected counterpart. In particular, this holds for the new edge directionspi−1,i+1−1−pi,i−1shown in Fig. 10, where the weight β of the reflected element is not larger than the weight α of its unreflected counterpart which follows fromβ=(1−α)/6andα≥1/7.Thus, by induction, we see that∇2(2kUkC)⊂D0fork≥0. Since every partial derivativecyover Ω is the limit of a sequence of vectors in∇2(2kUkC)within the 0-th segment and only the vectors in the(−1)-th segment may be parallel toıˆu−0.5form≠6, it follows thatcy(Ω)⊂D0\(0,∞)ıˆu−0.5=:D˜0.Next, we show0∉cy(Ω). Anycy(x),x∈Ω, is a convex combination ofFıˆS−0.5orFS1, whereFıˆS−0.5orFS1is the set of edges in∇2(2kUkC)and their reflected elements atıˆS−0.5or atS1for sufficiently large k, respectively. We observeFıˆS−0.5=eıˆ(π/2−3π/m)FS1⊆{(0,∞)eıˆ[π−4π/m,2π/m],ifm=3,4,5(0,∞)eıˆ[2π/m,π−4π/m],ifm≥7,which implies0∉cy(Ω)form≥4. Hence,cy(Ω)⊂D˜0\{0}=:D˜and similarlycx(Ω)⊂eıˆ(π/2−π/m)D˜=:D˜′form≥4.Since each pair inD˜×D˜′is linearly independent form≥4(see Fig. 11), c is regular over Ω and hence, the entire characteristic map of U is regular. Becausecy(Ω)⊂D˜, c does not map any line segment between two points in Ω to a closed curve, meaning that c is injective over Ω. Moreover, sinceMis a grid mesh whose zeroth segment lies in[0,∞)eıˆ[0,2π/m]=:Aand U preserves symmetry, this impliesc(Ω)⊂Aand c maps the interior of Ω into the interior ofA. Hence, the total characteristic map of U is injective.  □Finally, with Reif'sC1-criterion (Reif, 1995, Theorem 3.6) we obtainTheorem 6.2C1-property ofUThe general triangular midpoint scheme U of ordern≥1is aC1subdivision scheme for valencesm≥7ifαi(m)=αi(6),i=1,…,n, or if(5.9)is satisfied.In this section, we look at the general triangular midpoint scheme S of order 1, show examples and compare them with examples obtained by Loop's scheme.The subdivision matrix S for the general midpoint schemeU=AαRand an extraordinary vertex of valencem≥3has the subdominant eigenvalueμ0=μ0(m)=3α(m)−α(6)+16of frequency 0 and the dominant eigenvalueλ=λ2π/m=2(1−α(6))cm+2+α(6)6≥1+2α(6)6of frequency 1, wherecm:=cos⁡(2π/m)≥cos⁡(2π/3)=−1/2.Hence, according to Theorem 6.2, U is aC1-scheme if6μ0=3α(m)−α(6)+1<2(1−α(6))cm+2+α(6)=6λ,i.e., if(7.1)α(m)<13+23(α(6)+cm(1−α(6)))=:f(m).This result has first been derived by Umlauf (1999) form≥4. Form=3, inequality (7.1) is equivalent toα(m)<α(6).Note thatf(m)>α(m)forα(m)≡α(6)andm≥4, see also Fig. 12.Remark 7.2U=AαRwithα≡1/3Forα≡1/3, we obtain the (non-general) midpoint scheme already analyzed in Umlauf (1999). It generatesC1surfaces for extraordinary vertices of valence ≥4. However, it generates onlyC0surfaces for extraordinary vertices of valence 3.Remark 7.3U=AαRwithα(6)=1/4Forα(6)=1/4, we obtain Loop's scheme and inequality (7.1) turns into the conditionα(6)<12+cm2already analyzed by Loop (1987). Note that we consider only positiveα(m), while Loop allowsα(m)also to be negative. Regularity and injectivity of the characteristic map has first been proven by Umlauf (2000).Remark 7.4U=AαRThe schemeU=AαRhas been introduced in Ginkel and Umlauf (2007) in a different way and its smoothness property for valencesm≥4has been analyzed there using a technique from Umlauf (2003), which is based on the explicit representation of the subdominant eigenvector of the subdivision matrix. It has been shown thatAαRis aC1subdivision scheme for valencesm≥4ifα∈(0,1)and (7.1) is satisfied.Remark 7.5Valence 3According to Corollary 5.8, if (5.9) is satisfied for a general triangular midpoint scheme U, then the control net of the characteristic map of U for valence 3 can be obtained by subdividing and normalizing a grid mesh as described in Corollary 5.7. However, the Cartesian product of the direction conesD˜andD˜′has linearly independent elements for valence 3, which is illustrated in Fig. 11. Nevertheless, the iso-parameter lines shown in Fig. 13forU=AαRandα(3)=0.9α(6)indicate that the subdivision surfaces can be expected to beC1at their extraordinary points of valence 3.Several subdivision surfaces are shown in Figs. 14, 15, and 16. We observe that the subdivision surfaces lie closer to the control mesh for largerα(6)and thatAαAαRgenerates visually smoother surfaces thanAαR.

@&#CONCLUSIONS@&#
