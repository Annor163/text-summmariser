@&#MAIN-TITLE@&#
A multistage linear stochastic programming model for optimal corporate debt management

@&#HIGHLIGHTS@&#
Our model was implemented in practice by Petrobras to solve a realworld problem.Corporate debt management SP model to handle multiplicity of bond characteristics.Multi-criteria objective function: cost, risk and financial performances.We assume an approximated information structure due to the dimensionality curse.

@&#KEYPHRASES@&#
Risk management,Finance,Corporate bond issuance,Debt management,Stochastic programming,

@&#ABSTRACT@&#
Large corporations fund their capital and operational expenses by issuing bonds with a variety of indexations, denominations, maturities and amortization schedules. We propose a multistage linear stochastic programming model that optimizes bond issuance by minimizing the mean funding cost while keeping leverage under control and insolvency risk at an acceptable level. The funding requirements are determined by a fixed investment schedule with uncertain cash flows. Candidate bonds are described in a detailed and realistic manner. A specific scenario tree structure guarantees computational tractability even for long horizon problems. Based on a simplified example, we present a sensitivity analysis of the first stage solution and the stochastic efficient frontier of the mean-risk trade-off. A realistic exercise stresses the importance of controlling leverage. Based on the proposed model, a financial planning tool has been implemented and deployed for Brazilian oil company Petrobras.

@&#INTRODUCTION@&#
In large corporations, the goal of debt management is the dynamic bond issuance under uncertainty, with the purpose of optimally funding their capital and operational expenses. Debt portfolios are structured as a mix of securities with differing indexations, denominations, maturities and amortization schedules, in an attempt to balance the expected cost of servicing the debt with risks inherent to interest rates, corporate revenues and costs. In addition to corporate and regulatory operational constraints, debt management must take into account fluctuations in total debt, assets and cash savings, along with other financial performance measures affecting the company’s stock price and credit rating. In face of the required modeling flexibility, there is a firmly established literature with applications of Multistage Stochastic Programming (MSP) techniques to debt management and, more generally, to Asset Liability Management (ALM) problems. Starting with Bradley and Crane (1972), ALM models have been developed for several different applications including insurance companies Cariño and Ziemba (1998) and pension funds Kouwenberg (2001), Hilli, Koivu, Pennanen, and Ranne (2007), and Chiu and Wong (2012). More recently, similar techniques were especialized for optimal sovereign bond issuance, also dealing with the trade-off between minimum expected cost and minimum risk Balibek and Köksalan (2010), Consiglio and Staino (2010), and Date, Canepa, and Abdel-Jawad (2011). For the corporate case, Xu and Birge (2006) introduce a simplified model that maximizes shareholder value over production strategy and dividend distribution policy, considering a single short term debt instrument. However, their model requires the availability of known risk neutral probabilities, an unrealistic assumption especially for companies without a portfolio of tradable assets. To the best of our knowledge, the literature lacks models describing corporate bond issuance under uncertainty, dealing with both the complexity of the dynamic decision process and the trade-off among expected costs, risks and financial performance measures, as observed in practice.In this article, we present an MSP model for a corporation financing a predetermined set of projects, considering a universe of fixed and floating rates debt instruments. Uncertainty is represented by an event tree with a hybrid information structure, used to avoid exponential complexity with the number of stages. In the first part of the horizon, we build a detailed event tree with a full range of debt instruments available to the decision maker. For the other portion of the time horizon, the event tree is formed by a subsample approximation of uncertainty realizations, with a predetermined policy rule allowing only short-term debt. Our optimization model describes the dynamic decision process where, at every yearly stage, the state of the system is represented by the current cash holdings and the past debt portfolio. It takes into account the mean-risk trade-off between expected cost of debt service and expected value of corporation insolvency. Additional operational constraints express corporate debt valuation and the current asset value used to compute the leverage ratio at each stage. Lewellen and Emery (1986) asserts that most reasonable characterizations of corporate debt management policies adopt a borrowing strategy organized around leverage ratio targets. We integrate this performance measure into the objective function, modeling it as a convex piecewise linear penalty of the computed excess leverage.For an illustrative example with null cash returns and no intermediate penalties, we present a sensitivity analysis of the risk aversion level. Considering different scenario trees, we solve the problem for each risk aversion level and compute efficient frontiers and related solutions. For a realistic example with stochastic cash returns, we make a sensitivity analysis of the excess leverage penalties and show the importance of our multi-criteria objective function to obtain suitable policies. Computations were carried out with a financial planning software tool implemented for a financial and risk management group at Brazilian oil company Petrobras. In our illustration we consider a fictitious, although realistic, project data set.The remaining content of this article is organized as follows. Section 2 describes our multistage stochastic programming model, with a comprehensive presentation of all elements in the formulation. In Section 3, we perform a series of sensitivity analyses of the optimal solution considering an illustrative example. Section 4 we present the assumptions of a realistic application of our model to the oil industry and show the importance of the excess leverage penalties. Finally, Section 5 summarizes the contributions of this paper and outlines the directions of future research.Multistage stochastic programming is a natural framework for long-term financial planning problems, corporate debt management in particular. The model must describe a dynamic setting where, at a given stage, a decision is taken facing an unknown future. Once decisions are implemented, the next period information is revealed and the process is repeated for the next stage.A standard approach in MSP models is to represent uncertainty by a discrete event tree, where nodes indicate the state of the process at decision points and arcs the realizations of uncertainty before the next stage. Formally, the information structure given by an event tree can be understood as a filtered probability space Consiglio and Staino (2010) generating a deterministic equivalent of the MSP model. A complete path in the event tree is called a scenario and a policy is defined as the set of decisions for all stages and scenarios. This information structure requires that decisions be based solely on past information, expressed in the MSP model formulation by the non-anticipativity constraints, which stipulate decision variables at a given stage must be equal if their scenarios share the same node in the event tree.Given this tree structure, we can immediately observe that the size of the deterministic equivalent grows exponentially with the number of stages. Some authors have dealt with this curse of dimensionality applying large scale optimization techniques Pereira and Pinto (1991), Rockafellar and Wets (1991), Shapiro, Tekaya, da Costa, and Soares (2013), while others approximate the original multistage problem by reducing the number decision variables with the adopting single policy rule Rush, Mulvey, Mitchell, and Willemain (2000). A policy rule is a function of the uncertainty realization that generates a unique sequence of feasible decisions for each time of the planning horizon. This framework fits into the independent scenario structure as stated in Rush et al. (2000), however it usually leads to a suboptimal solution when compared to the original multistage one. Indeed, one could define a set of policy rules generally leading to a non-convex optimization problem.With the purpose of reducing the high dimensionality of our final formulation, we propose a hybrid approach comprising a traditional multistage model for the firstT∗periods and an independent-scenario structure with simple fixed-policy rule fort>T∗. For the latter, we represent uncertainty by independent scenarios generated from a subsample of the full event tree. In our model, a full set of securities is considered fort⩽T∗, while fort>T∗we allow only short term bonds to ensure the minimum cash threshold. This structure is motivated by the observation that, in practice, most investments take place at the early stages of the planning horizon where the decision process is described in more detail.Preparing a complete formal statement of the model, let us first define parameters, risk factors and decision variables used in the formulation. Observe that, by definition, the short term bond type is the first element of the set of fixed rate bondsX.Scalar parametersT: Planning horizonT∗: Detailed planning horizonS: Number of scenariosω: Weighted average cost of capitalc: Initial cashp: Risk aversion parameternX: Number of fixed rate bondsnY: Number of floating rate bondsK: Number of leverage targetsψ¯: Average risk premium for pre-existing floating rate bondsρ¯: Risk free interest and cash account return rate for the time period preceding the planning horizonSetsH={0,…,T-1}H∗={0,…,T∗-1}S={1,…,S}K={1,…,K}X={1,…,nX}Y={1,…,nY}Vector parametersγk: Leverage ratio for targetk∈Kθk: Penalty for excess leverage exceeding targetk∈Kxt: Payment att∈H∪{T}of pre-existing fixed-rate bondsyt: Outstanding face value att∈H∪{T}of pre-existing floating rate bondsΔyt: Amortization att∈H∪{T}of pre-existing floating rate bondsMXi: Maturity of fixed rate bondi∈Xdefined whenMXi⩽T-T∗+1, withMX1=1corresponding to a short term bondMYi: Maturity of floating rate bondi∈Y, defined whenMYi⩽T-T∗+1ΔXji: Amortization schedule of fixed rate bondi∈X, for paymentj∈{1,…,MXi}, where∑j=1MXiΔXji=1ΔYji: Amortization schedule of floating rate bondi∈Y,j∈{1,…,MYi}, where∑j=1MYiΔYji=1Risk factorsft(s): Cash flow at timet∈H∪{T}and scenarios∈S.rt,τ(s): Term structure of interest rates att∈H, for maturityτand scenarios∈S.ρt(s): Risk free interest and cash account return rate att∈Hand scenarios∈S.αti(s): Coupon for fixed rate bondi∈Xissued att∈Hand scenarios∈S.ψti(s): Risk premium for general amortization floating rate bondi∈Yissued att∈Hands∈S.ϕt,k(s): Risk premium for standard amortization (only at maturity) floating rate bonds issued att∈H, for scenarios∈Sand maturity k, with full amortization at maturity.There is a unique mapping between the fixed rate couponsαti(s)and the term structure of interest ratesrt,j(s), assuring that the net present value of future payments is equal to its face value. We assume, without loss of generality, unit face value debt instruments. Then, for alli∈X,t∈Hands∈S,αti(s)11+rt,1(s)+∑j=2MXi1-∑k=1j-1ΔXki(1+rt,j(s))j+∑j=1MXiΔXji(1+rt,j(s))j=1.Similarly, we can establish a relation between risk premiaψti(s)andϕt,k(s). Let us consider the following strategy at time t under scenario s:•Issue a face value unit of a floating rate bond with generic amortization scheme, i.e.,Yt,0i(s)=∑j=1MYiΔYji=1;BuyMYifloating rate bonds with standard amortization (only at maturity) with face valuesΔY1i,…,ΔYMYiiand maturities1,…,MYi, respectively.By construction, the portfolio in this strategy has zero cost at issuance time. Furthermore, its total cash flow stream is deterministic and depends solely on current risk premium differences. In the absence of arbitrage opportunities, the net present value of this stream equals zero, leading to the following expression:∑k=1MYi∑m=kMYi(ψti(s)-ϕt,m(s))ΔYmi(s)(1+rt,k(s))k=0.These sets of variables represent implementable policies such as the amount issued for each bond, as well as auxiliary variables defining the state of the firm, such as cash account, asset and debt values. Note that we implicitly assume the non-negativity of decision variables unless specified.Xt,ji(s): Outstanding face value at timet+jof fixed rate bondi∈Xissued att∈H∗and scenarios∈S, wherej∈{0,…,min(t,MXi-1)}.Yt,ji(s): Outstanding face value at timet+jof floating rate bondi∈Yissued att∈H∗and scenarios∈S, wherej∈{0,…,min(t,MYi-1)}.Ct(s): Cash savings at timet∈Hand scenarios∈S.CT+(s): Positive part of terminal cash savings under scenarios∈S.CT-(s): Negative part of terminal cash savings under scenarios∈S.Dt(s): Debt value at timet∈Hand scenarios∈S.D∼t(s): Debt value at timet∈Hand scenarios∈S, excluding bonds issued at t.At(s): Asset value at timet∈Hand scenarios∈S, whereAt(s)∈R.It,k(s): Excess leverage above targetk∈K, at timet∈Hand scenarios∈S.Amortization. These constraints update the outstanding face value of each bond after amortization payments. For each bond i issued at t under scenario s, the outstanding face value att+jis the outstanding value att+j-1minus the jth amortization payment.For fixed rate bonds,∀i∈X⧹{1},∀t∈H∗,∀s∈Sand∀j∈{1,…,MXi-1}, we haveXt,ji(s)=Xt,j-1i(s)-ΔXji·Xt,0i(s).For floating rate bonds,∀i∈Y,∀t∈H∗,∀s∈Sand∀j∈{1,…,MYi-1}, we haveYt,ji(s)=Yt,j-1i(s)-ΔYji·Yt,0i(s).Cash balance constraints keep track of inflows and outflows at every stage of the system. We define them differently for the four portions of the planning horizon. In all of these constraints, the cash return is assumed to be the short-term risk free interest rateρt(s). Coupons for newly issued fixed rate bonds are denoted asαt-j(s)at issuance timet-j. The constraints also take into account a mix of pre-existing fixed rate bonds with scheduled coupon and amortization paymentsxt. Coupons for newly issued floating rate bonds are computed as the sum of the current short-term risk free interest rateρt-1(s)plus the risk premiumψt-j(s)at issuance timet-j. Pre-existing floating rate are specified the total outstanding face valueyt. The associated coupon is computed with short-term rate plus average risk premiumψ¯provided exogenously.Fort=0and∀s∈S,Ct(s)=c+ft(s)-xt-(ρ¯+ψ¯)yt-Δyt+∑i∈XXt,0i(s)+∑i∈YYt,0i(s).Total cash at the end of the first period is the initial cash value plus new cash flow, minus payments and amortization for pre-existing debt, plus borrowing income due to current issuance of all types of fixed and floating rate bonds. Note that the short term risk free interest rateρ¯for the time period preceding the planning horizon is a constant provided exogenously.Fort∈H∗⧹{0},∀s∈S,Ct(s)=(1+ρt-1(s))Ct-1(s)+ft(s)-xt-((ρt-1(s)+ψ¯)yt)+Δyt+∑i∈XXt,0i(s)+∑i∈YYt,0i(s)-∑i∈X∑j=1min(t,MXi)(αt-ji(s)Xt-j,j-1i(s)+ΔXji·Xt-j,0i(s))-∑i∈Y∑j=1min(t,MYi)(ρt-1(s)+ψt-ji(s))Yt-j,j-1i(s)+ΔYji·Yt-j,0i(s).As int=0, total cash is the previously accrued value updated with all current inflows and outflows, but also including payments and amortization of new fixed and floating rate bonds.Fort∈H⧹H∗,∀s∈S,Ct(s)=(1+ρt-1(s))Ct-1(s)+ft(s)-xt-(ρt-1(s)+ψ¯)yt+Δyt+Xt,01(s)-(αt-11(s)Xt-1,01(s)+ΔX11·Xt-1,01(s))-∑i∈X‾t∑j=t-T∗+1min(t,MXi)(αt-ji(s)Xt-j,j-1i(s)+ΔXji·Xt-j,0i(s))-∑i∈Y‾t∑j=t-T∗+1min(t,MYi)(ρt-1(s)+ψt-ji(s))Yt-j,j-1i(s)+ΔYji·Yt-j,0i(s),whereX‾t=i|i∈X⧹{1},MXi⩾t-T∗+1andY‾t=i|i∈Y,MYi⩾t-T∗+1.For the simplified portion of the horizon(T∗⩽t<T), cash balance constraints differ, as new issuances are limited to short term bonds. Note also that summations limits in the terms corresponding to payments and amortization of long term bonds account include only those issued during the detailed horizon.Fort=T,s∈S,Ct+(s)-Ct-(s)=(1+ρt-1(s))Ct-1(s)+ft(s)-xt-(ρt-1(s)+ψ¯)yt+Δyt-(αt-11(s)Xt-1,01(s)+ΔX11·Xt-1,01(s))-∑i∈X‾t∑j=t-T∗+1min(t,MXi)(αt-ji(s)·Xt-j,j-1i(s)+ΔXji·Xt-j,0i(s))-∑i∈Y‾t∑j=t-T∗+1min(t,MYi)(ρt-1(s)+ψt-ji(s))Yt-j,j-1i(s)+ΔYji·Yt-j,0i(s).At the end of the planning horizon, we do not consider new debt issuance. Infeasibility is avoided by expressing the left hand side with two components and allowing for negative values in the final cash balance. Under scenarios,CT+(s)represents the terminal cash savings, whileCT-(s)the outstanding obligations at the end of the horizon. We can also interpretCT-(s)as the cash requirement to avoid insolvency. Note that we construct the objective function in such way thatCT+(s)CT-(s)=0.Thus far, our model formulation described only the relationships of decision variables within each scenario. The non-anticipativity constraints preserve the dynamic structure of the model by stating the equality of variables across different scenarios when they share the same history, or, equivalently, are associated with the same node in the event tree. This guarantees implementable optimal policies, where it is possible to state the corresponding dynamic programming equations. First, we defineNas the set of nodes in the tree and functionN(t,s):H×S→N, mapping stage t in scenario s into its corresponding node. Then, we define the subsets of decision variable indexes for each node,Un=(t,s)|N(t,s)=n∀n∈N. For each non-singleton subsetUn∗, we select a canonical element(t∗,s∗)and build the equality constraints linking corresponding decision variables with their counterparts associated with the other elements of the set.Forn∗∈{n∈N|∣Un∣>1},Xt∗,0i(s∗)=Xt,0i(s),∀i∈X,∀(t,s)∈Un∗/(t∗,s∗),Yt∗,0i(s∗)=Yt,0i(s),∀i∈Y,∀(t,s)∈Un∗/(t∗,s∗).Note that it is sufficient to consider only the constraints corresponding toXt,0i(s)andYt,0i(s)since all other decision variable are consequently determined.Net asset value at time t under scenario s is the conditional expectation of the present value of future project cash flows. Based on Miller and Modigliani (1958), we use the weighted average cost of capital (WACC) of the firm denoted byωas the discount rate.Then, fort∈H,s∈S,At(s)=Ct(s)+1∣S(t,s)∣∑s̃∈S(t,s)∑k=1T-tft+k(s̃)(1+ω)k,whereS(t,s)={s̃∈S|N(t,s)=N(t,s̃)}. Note thatSstands forS(0,s),∀s∈S.The market value of the total outstanding debt at time t under scenario s is defined as the face value of current bond issues plus the market value of the previously issued debt. For fixed rate bonds, the market value is the net present value of their scheduled coupon payments and amortizations, discounted by the current term structure of interest rates for the appropriate maturities. For floating rate bonds, the market value is the cost of buying a series of standard amortization floating rate bonds, one for each period remaining until maturity of the original instrument, with face value equal to the corresponding partial amortization payment, plus an adjustment for the change in risk premia since issuance. The latter term is the difference between the net present values of remaining scheduled payments of the original instrument and the combined payments of the series of replacement standard amortization bonds.As in the cash balance constraints, for the detailed horizon, the value of currently issued bonds are computed as summations over all types of fixed and floating rate instruments. The value of previously issued debt,D∼t(s), has different definitions for the initial stage and the remainder of the detailed horizon.Fort∈H∗,s∈S,Dt(s)=∑i∈XXt,0i(s)+∑i∈YYt,0i(s)+D∼t(s)where fort=0,D∼t(s)=∑k=1T-txt+k(1+rt,k(s))k+ytwhile fort∈H∗⧹{0},D∼t(s)=∑i∈X∑k=1(MXi-1)∑j=t+k-T∗+1min(t+k,MXi)αt+k-ji(s)Xt+k-j,j-1i(s)+ΔXji·Xt+k-j,0i(s)(1+rt,k(s))k+∑i∈Y∑j=1min(t,MYi-1)Yt-j,ji(s)+Yt-j,0i(s)∑k=1MYi-j∑m=kMYi-jψt-ji(s)-ϕt,m(s)ΔYm+ji(1+rt,k(s))k+∑k=1T-txt+k(1+rt,k(s))k+yt+∑k=1T-t(ψ¯-ϕt,k(s))yt+k(1+rt,k(s))kFor the simplified horizon, the total debt value is the currently issued short term bond, plus the market value of the all other instruments issued during the detailed horizon. Then, fort∈H⧹H∗,s∈S,Dt(s)=Xt,01(s)+D∼t(s)D∼t(s)=∑i∈X∼t∑k=1(MXi-1)∑j=t+k-T∗+1min(t+k,MXi)αt+k-ji(s)Xt+k-j,j-1i(s)+ΔXji·Xt+k-j,0i(s)(1+rt,k(s))k+∑i∈Y∼t∑j=1min(t,MYi-1)Yt-j,ji(s)+Yt-j,0i(s)∑k=1MYi-j∑m=kMYi-jψt-ji(s)-ϕt,m(s)ΔYm+ji(1+rt,k(s))k+∑k=1T-txt+k(1+rt,k(s))k+yt+∑k=1T-t(ψ¯-ϕt,k(s))yt+k1+rt,k(s)k1withX∼t={i|i∈X,MXi⩾t-T∗+2}andY∼t={i|i∈Y,MYi⩾t-T∗+2}.The objective function in our model includes two contrasting components. The first measures the mean-risk trade-off between expected terminal cash savings and risk of default at the end of the horizon, expressed by a utility function on the terminal cash. For a risk neutral agent, since all accrued borrowing costs are accounted in the cash balance, we can easily establish that maximizing the expected terminal cash is equivalent to minimizing the expected future cost of servicing the debt. The latter quantity is commonly used as part of the objective in the debt management literature Balibek and Köksalan (2010), Consiglio and Staino (2010), and Date et al. (2011), combined with Conditional Value-at-Risk (CVaR) Rockafellar and Uryasev (2000) as a risk aversion measure to be minimized or constrained. As shown in Shapiro (2009), CVaR is not time consistent. Akin to non-anticipativity which forces identical decisions for scenarios sharing the same past, time consistency requires that optimality and feasibility should not depend on future scenarios that cannot happen when conditioned by the state at the moment of the decision. We argue that CVaR is inappropriate as a risk aversion measure for dynamic multistage stochastic programming models. As a matter of fact, including CVaR in the objective function may lead to suboptimality of the first stage decisions as illustrated in Rudloff, Street, and Valladão (2014).The second component of the objective function takes into consideration the company’s debt worthiness based on financial performance measures available to market agents. Ideally, we would have included in the model an adjustment in interest rates reflecting the company’s credit rating. However not only estimation of these corrections would not be possible with the available data, but it would greatly increase complexity, prohibitive even in moderately sized instances of MSP models. We propose instead a practical approach where a penalty function increasingly discourages excess leverage at intermediate stages of the planning horizon.The utility functionU(CT)assigns a value to a scenario at the end of the horizon based of the final cash balance. For the sake of ease in economic interpretation, we propose a piecewise linear functionU(CT)=CT+-pCT-,where a negative terminal cash value is penalized by the risk aversion parameterp>=1. The expected value of the utility function isE[U(CT)]=E[CT+]-pE[CT-],combining the expected terminal cash savings with the penalized expected value of insolvency.This approach for measuring risk aversion is closely related to integrated chance constraints, which have also been used in financial planning problems Haneveld and van der Vlerk (2006), in particular in ALM models Klein Haneveld, Streutker, and van der Vlerk (2010). Observe in definition ofU(CT)that coefficient p is a risk aversion parameter, withp=1representing a risk neutral agent.The second part of our objective function deals with the effect of market perception on a company’s bond issuance policy. As recommended by Lewellen and Emery (1986) in a comparison of corporate debt management policies, firms should manage their debt by following a target on the Debt-to-Asset ratio. This ratio is also used frequently by market analysts as an indicator of the company’s financial performance. Given this background, our model guides the optimal policies by including in the objective a penalty for highly leveraged debt positions. We propose a piecewise linear function that increasingly penalizes the excess leverage based on a sequence of threshold targets for the Debt-to-Asset ratio. Denoted byγ1⩽⋯⩽γK, these values correspond to critical leverage levels established by debt managers. In the objective function, we impose a cumulative penalty for violating each one of the leverage targets in each scenario, at each time period. First, we define the amount of excess leverage above each target,It,k(s)=[Dt(s)-γkAt(s)]+=max(0,Dt(s)-γkAt(s)),∀t∈H,s∈S,k∈K.In the linear programming formulation of the model, this last expression is stated by initially adding as constraints the following inequalities,It,k(s)⩾0,It,k(s)⩾Dt(s)-γkAt(s),∀t∈H,s∈S,k∈K.The equality in the definition of variablesIt,k(s)is guaranteed only in the optimal solution from the construction of the objective function which includes penalties on each excess leverage variable,θkIt,k(s)∀t∈H,s∈S,k∈K,whereθ1⩽⋯⩽θKare positive penalty factors also assigned by debt managers.The total excess leverage penalty sums the future values of the violations above each target in all scenarios,∑k∈Kθk∑t∈HIt,k(s)∏τ=t+1T(1+ρτ(s))∀s∈S.In its final form, we state the full objective by adding the two components and taking the expected value,maxS-1∑s∈SCT+(s)-pCT-(s)-∑k∈Kθk∑t∈HIt,k(s)∏τ=t+1T(1+ρτ(s)),noting that the penalty functions take negative signs in the maximization objective.In this section, we illustrate some key features of the model by building a simplified example where uncertainty is considered only on the term structure of the interest rates. We assume a project portfolio with a deterministic cash flow stream repeated for all scenarios, setting the values for risk factorft(s). With a planning horizonT=15, we assign high capital expenses for the initial 5 stages and constant revenues there after. We also assume a null return for the cash account, withρt(s)=0for all time periods and scenarios.Based on this uncertainty framework, the model is further specified by the portfolio of available debt instruments and the generation of the event tree. The resulting problem is solved for the maximization of the terminal cash utility only. When compared to a complete instance of the implemented model, this example allows for a larger number of scenarios in the event tree. The low computational effort in the solution of each instance also permits building the efficient frontier for the risk aversion parameter.We consider nine types of bonds of varying maturities and amortization schedules:Short Term: 1-year short-term bond.Fixed-5 Final: 5-year bond with full amortization at the end.Fixed-10 Final: 10-year bond with full amortization at the end.Fixed-5 Constant: 5-year bond with constant amortization bond.Fixed-10 Constant: 10-year bond with constant amortization bond.Floating-5 Final: 5-year bond with full amortization at the end.Floating-10 Final: 10-year bond with full amortization at the end.Floating-5 Constant: 5-year bond with constant amortization.Floating-10 Constant: 10-year bond with constant amortization.Expressing these definitions as parameters of the model, we havenY=4andnX=5. Note that the set of fixed-rate bonds include short-term instruments indexed byi=1inX={1,2,3,4,5}. Amortization schedules are defined as:Fori∈{1,2,3},ΔXji=1,forj=MXi0,otherwiseFori∈{4,5},ΔXji=1MXi,∀j=1,…,MXi.Maturities are defined as:MXi=1,fori=15,fori∈{2,4}10,fori∈{3,5}For the floating rate bonds, we haveY={1,2,3,4}, with the amortization schedules defined as:Fori∈{1,2},ΔYji=1,forj=MYi0,otherwiseFori∈{3,4},ΔYji=1MYi,∀j=1,…,MXi.Maturities are defined as follows:MYi=1,fori=15,fori∈{2,4}10,fori∈{3,5}Scenarios for the MSP are generated by the forecasting model presented in Vereda (2011), which supplies the estimated parameters for Brazilian and American term structure of the interest rates in the following state space framework:ηt=A+Bξtξt=Φξt-1+Σ1/2εt,εt∼N(0,I).Based on the Adjusted Random Sampling of Kouwenberg (2001), we compute an event tree that approximates the original stochastic vectorεt, using antithetic values along with a variance adjustment. For the sake of implementation efficiency, we generate the residual tree nodewise, i.e.,∊(n),∀n∈N.Given a node n, let us denoteQ(n)={q1,q2,…}the set of all possible successor nodes, withQ(n)=|Q(n)|. Using antithetic values, we match the zero mean and all null higher odd moments for each univariate stochastic component of∊i(q),∀q∈Q(n). After initializingεi(q)=0,∀q∈Q(n), we sample via Monte Carlo simulation the firstk=1,…,⌊Q(n)/2⌋elements and generate the antithetic values for the remainder forj=Q(n)-k,∊(qj)=-∊(qk).Note that this procedure ensures null conditional odd moments of the simulated∊i(n)for each component i, i.e.,E∊ip|n∈N=1Q(n)∑q∈Q(n)∊ip(q)=0,∀p=1,3,5,….Returning to the original notation, we define the unadjusted residuals asε̃t(s)=∊(n),∀t∈H∪{T},s∈Ssuch thatn=N(t,s).Then, we adjust the variance ofε̃i,tfor each stage t and for each component i. Indeed, to suit the hybrid tree structure, our procedure matches the unconditional variances in opposition to the conditional approach of Kouwenberg (2001). Therefore the adjusted residuals are given byεi,t(s)=ε̃i,t(s)1S∑s∈Sε̃i,t2(s),∀s∈S.Sensitivity analysis examines the robustness and stability of the optimal solution vis-à-vis changes in the input parameters and data uncertainty. With the objective function limited to the terminal cash utility function, without the excess leverage penalty, this experiment builds the efficient frontier for the risk aversion parameter p. Since the proposed model is only tractable for relatively small event trees, the optimal solution is subject to estimation errors. Given a value for p, we generate N independent event trees whose sets of scenarios are denoted bySi,∀i=1,…,N. Then, we solve the problem for each scenario set, using the optimal solution to compute the two components of the objective function,Ci+=S-1∑s∈SiCT+(s)andCi-=S-1∑s∈SiCT-(s),∀i=1,…,N.Ultimately, we build the efficient frontier corresponding to each scenario setSiby solving the problem for each value of p and linearly interpolating the observed points to compute the curveCi+vsCi-,∀i∈{1,…,N}. In our experiment, we assumedN=1000andp∈{1,50,100,200,500,1000,2000}, generating 7000 instances of the model. The resulting efficient frontier is represented in Fig. 1, where the average and 95% percentile are obtained from the distribution of all possible values ofC+given a fixed level of riskC-.From the results of this experiment, we can also develop a sensitivity analysis for the first stage decision with respect to the risk aversion parameter p. For eachi=1,…,N, we take the first stage optimal solution for each scenario setSi,Zi=(X0,01,…,X0,0nX,Y0,01,…,Y0,0nY), indicating the amounts issued in fixed and floating rate bonds, for all maturities and amortization schedules. Then, we compute the sample average approximationZ‾=N-1∑i=1NZi. for all values of p. The stacked bar graph in Fig. 2indicates the amounts corresponding to each available debt instrument, expressing the behavior of the optimal solution with respect to risk aversion level. Note that for the risk neutral case,p=1, the short term bond is preferred while the risk averse case,p>1, long term bonds are increasingly more attractive. This behavior is explained by the locked cost of long term debt, while a short term portfolio would imply in periodic refinancing, subject to higher risk in borrowing cost.Application of the proposed model to a real-world problem requires further assumptions, complete specification of risk factors and inclusion of the excess leverage penalty into the objective function. These features were implemented in a financial planning software tool deployed in a risk management organization at Brazilian oil company Petrobras. Two auxiliary modules have been developed for the generation of risk factor scenarios: An integrated interest and exchange rates forecasting model and a simulator for future spot prices of crude oil, its byproducts and natural gas. Considering the same debt instruments as before, we specialize the various elements of our multistage stochastic programming model for this application and present results based on a fictitious, although realistic, project data set.The model formulation constraints refer explicitly to scenarios for interest rates and risk premia. We call those Financial Risk Factors. In addition, Project Risk Factors are reflected indirectly in the scenarios for cash flows generated by the project portfolio, including market prices for crude oil and natural gas. In an attempt to approximate continuous flow of revenues and expenditures distributed over each planning stage, we assume the average values during the period. The detailed description of the forecast models is available in Vereda (2011) and Fernandes and Lima (2011).Financial Risk Factors. An integrated forecast model provides scenarios for interest and exchange rates, withrt,k(s): Annual effective yield for corporate bonds denominated in US$.ρt(s): Risk free interest rate, assumed to be US government bond 1-year yield.ϕt,k(s): Risk premium for floating rate bonds with full amortization at maturity.Using the relations presented in Section 2.1, we computeαti(s)andψti(s)depending respectively on the term structurert,k(s)and risk premiaϕt,k(s), for eacht∈H,k∈Hands∈S.Project Risk Factors. We assume all stochastic cash flows generated by the project portfolios to be an affine functions of project risk factors. Besides market prices for crude oil and its byproducts, exchange rates are also considered risk factors in this category, as the project portfolio includes multi-currency investments. Based on these risk factors, investments and production data, a preprocessor to the optimization model computes scenarios for the cash streamsft(s),dt(s)andlt(s).The financial planning software tool implemented from our model uses Matlab to perform all of the data preparation and solution presentation. The linear programming formulation was implemented with the MOSEL modeling language, using the Xpress optimization suite as the solver. The computational experiments were carried out on an Intel (R) Core (TM) i7 CPU based computer with 24gigabytes RAM and 8 processors.As opposed to the illustrative example presented in Section 3 where we assume a null return for the cash account, savings are now invested in short term US government bonds, subject to stochastic returns. This key assumption closely matches the actual corporate financial strategy. However, it increases the probability of outlier scenarios where the income generated by the cash account is greater than the costs of some debt instruments. The optimal policy for these scenarios would be a highly leveraged, possibly unbounded, debt portfolio. Under these circumstances, intermediate excess leverage penalties are added to the objective function, avoiding unrealistic solutions. The parameters for the forecasting model were tuned to simulate an environment of growing interest rates and well-behaved term-structures, emphasizing the effect of our multi-criteria objective function.In this experiment, we consider a base case with horizonT=48starting in 2010, detailed horizon(T∗=6), initial cash savingc=5.00, minimum cashcˆt=5.00, risk aversion parameterp=10, weighted average cost of capitalω=8.8, number of leverage targetsK=3and number of scenariosS=1024. With this specification, the resulting equivalent deterministic linear program has 820,534 rows, 813,056 columns and 4,559,468 non-zero matrix elements.We compare the solutions of the problem under two assumptions for the excess leverage penalties. In Case 1 we assume zero penalties and an arithmetic progression in Case 2, with leverage targetsγ={35%,50%,100%}and incremental leverage penaltiesθ={1,1,1}. Examining the optimal solutions for both cases, we first compare the expected bond issuances for the detailed portion of the horizon. Fig. 3shows the average amounts issued for each bond on each staget∈H∗. For Case 1, the total debt issued is much higher than the amount required to fulfill the minimum cash requirement of the firm, indicating the presence of scenarios with cash saving earnings above debt costs. This effect disappears in Case 2.The impact of imposing intermediate penalties is further illustrated by analyzing the behavior of the stochastic leverage ratio,Dt(s)/At(s). For Case 2, Fig. 4displays in a stacked bar chart the leverage ratio evolution over the planning horizon. As stated in the graph legend, each color segment indicated the probability (denoted as Pr) that the leverage ratio belongs to a range of target values. Note that all scenarios have the same solution in the first stage.The solution for Case 1 counters the intuitive premise that a firm with a fixed project portfolio should not be unnecessarily exposed to risk from uncertain financial returns. In Case 2, the intermediate penalties discourage risky policies with high leverage ratios occurring in a small subset of scenarios. The last leverage range,Dt(s)/At(s)⩾100%, defines the insolvency state at each stage, when debt exceeds total assets. This experiment suggests that debt managers use the proposed model interactively, tuning risk aversion parameters in the intermediate excess leverage penalties to avoid highly leveraged portfolios.

@&#CONCLUSIONS@&#
