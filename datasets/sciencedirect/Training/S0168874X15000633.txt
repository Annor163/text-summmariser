@&#MAIN-TITLE@&#
A time increment control for return mapping algorithm applied to cyclic viscoplastic constitutive models

@&#HIGHLIGHTS@&#
Algorithms are proposed to control the time increment in viscoplastic FE analyses.Algorithms avoid important increase of time step during large viscoplastic evolutions.Control protocol enables an efficient computation of fatigue stress–strain loop.Control methods are positively tested for multi-axial and athermal loading conditions.Control algorithms are successfully tested for volume elements and structures.

@&#KEYPHRASES@&#
Constitutive Model,Viscoplasticity,FEM Analysis,

@&#ABSTRACT@&#
This paper proposes two algorithms for better controlling the size of time increment in case of return-mapping integration scheme for elasto-viscoplastic constitutive models. Computation errors in terms of local stress–strain loops in Finite Element Analyses could indeed have a very strong impact on fatigue lifetime estimation protocol if time increment size are freely chosen by the FE solver. Proposed algorithm enables both to precisely describe the transition between elasticity and viscoplasticity and to avoid too important increase of time step during large viscoplasticity evolutions. The precision of the computed mechanical answer has been successfully tested for different kinds of multi-axial and anisothermal loading conditions on simple finite element and more complex meshed structures. Fatigue lifetime estimation errors have also been investigated for stabilized stress–strain cycle and common criteria and the proposed algorithm show very precise results with a limited computation time increase and without drastic limitation of the time increment size.

@&#INTRODUCTION@&#
For the past ten years, most of automotive manufacturers have adopted strategies mixing engine downsizing and mass reduction to answer to new environmental regulations and to decrease both polluting emission and fuel consumption. Engine parts, such as cylinder heads, exhaust manifolds and engine blocks, have therefore experienced higher operating temperatures induced by the increase of the combustion fluxes. They are therefore particularly sensitive to the superposition of a severe thermal loading and strong mechanical constraints that leads to thermal–mechanical fatigue cracks initiation.Thermal–mechanical fatigue (TMF) design requires not only a good knowledge of the loading and boundary conditions [1,2] or of the thermal and mechanical environment of the studied structures but also advanced constitutive models which enable to precisely describe materials elasto-viscoplastic behaviors [3]. These models have to cope with various variable loading conditions and to describe complex anisothermal evolutions [4]. Consequently a higher level of sophistication and a greater number of parameters are often required to adequately represent the response induced by thermal–mechnanical loadings. In the framework of small perturbations and for metallic materials, lots of efforts have therefore been made to correctly describe the behavior of classic automotive alloys such as aluminiums, cast-irons or stainless steels with models taking into account ageing effects, stresses recovery or complex viscous behavior [5–9]. Moreover, the development of representative fatigue criterion remains an important research field as it constitutes the final step of a performant design process. Recent advances have been made by taking into account mean-stress effects [10,11] or by exploring the statistical influence of the microstructure [12].The use of all of these models is standardly based on a Finite Element description of thermal–mechanical problems. Complex constitutive models must most of the time be integrated into commercial computation code as Abaqus in order to facilitate fatigue design operations within industrial engineering offices. The related evolution problem has received much attention mostly between the late seventies and the eighties, resulting in significant advances in the integration schemes [13–18]. For practical industrial applications and in the case of viscoplasticity, return mapping algorithms represent a very common scheme to integrate the rate constitutive equations [13, 19–23]. In this process, associated with a Newton iterative procedure, an elastic predictor is first estimated before being corrected onto a suitably updated yield surface. In order to obtain a quadratic rate of convergence, a consistent tangent operator [14,16,24] must also be used. Even if this class of algorithms has proven its numerical performance [25,2], it appears to be sensitive to the size of the chosen time increment. Others proposals such as substepping algorithms [26] have proved to be more accurate for large time increments but no relevant solution is proposed in the literature to efficiently control the increment size within the framework of radial return algorithm.This paper proposes two algorithms for controlling the time step and thus better control both the calculated stress–strain loop for elasto-viscoplastic constitutive models [27] in the case of anisothermal thermomechanical loads and with a good compromise between CPU time and reliability of results. Drifts in terms of mechanical behavior are evaluated for different types of multiaxial loadings first on an volumic finite element and then a more complex structure. Constitutive models are developed for design of structures against thermomechanical fatigue and errors in terms of dissipated energy density, a commonly used indicator to assess the damage associated with this type of fatigue, are also estimated. The contribution of the proposed algorithms in terms of accuracy and computation time savings is finally considered in comparison with an excessive limitation of the time increment.In order to describe the behavior of metallic body-centered cubic alloy over a wide range of strain, strain rate and temperature, a constitutive model was proposed by Szmytka et al. [27]. This model is here taken as reference for the proposed algorithms which can easily be extended to other constitutive laws. Basic assumptions are small strains, isotropic elastic-viscoplastic behavior and unified elastic-viscoplasticity thermodynamic framework. Consequently, the total strain tensor is divided additively into elastic, inelastic and and thermal parts,(1)ε̲̲=ε̲̲e+ε̲̲ine+ε̲̲thThe thermal strain isε̲̲th=αT(T−Tref)1̲̲, while the elastic strain is given by Hooke׳s law,(2)ε̲̲e=ℂ−1:σ̲̲where T is the temperature,Trefis the reference temperature,σ̲̲is the stress tensor.αTis the thermal expansion coefficient andℂis the fourth-order elastic tensor. In our isotropic case,ℂ=λ1̲̲⊗1̲̲+2μI, with λ and μ are the Lamé constants dependent of the temperature.1̲̲and I are respectively the second and the fourth order unit tensors. A viscoplastic equation with back stress is used to describe the evolution of the viscoplastic strain tensor,(3)ε̲̲̇vp=32ṗs̲̲−X̲̲J2(s̲̲−X̲̲)where ( ) denotes the differentiation with respect to time,s̲̲is the deviator of the stress tensorσ̲̲andX̲̲is the back stress tensor.J2(s̲̲−X̲̲)is the second invariant of the tensors̲̲−X̲̲and is defined by using (:) as the inner product between second rank tensors,(4)J2(s̲̲−X̲̲)=32(s̲̲−X̲̲):(s̲̲−X̲̲)whileṗis the accumulated viscoplastic strain or viscoplastic multiplier. Its evolution, represented by a flow rule, follows the rule proposed by [27](5)ṗ=ε̇0(1+(f(s̲̲−X̲̲,R)H)2)sinh[f(s̲̲−X̲̲,R)K]+(1−exp[−[f(s̲̲−X̲̲,R)βR]+]m)whereε̇0, H, K, m, β are temperature dependent parameters;[.]+indicates the positive part. The yield function f is defined as(6)f(s̲̲−X̲̲,R)=J2(s̲̲−X̲̲)−RR is the isotropic hardening term, and is considered here as following a conventional non-linear rule [28]:(7)R=R0+Q(1−exp(−bp))whereR0, Q and b are the three temperature-dependant parameters. Finally, for the evolution of the kinematic hardening termX̲̲, the conventional non-linear Armstrong and Frederick׳s law is adopted [28],(8)X̲̲=2C3α̲̲=C(23ε̲̲̇ine−DCX̲̲ṗ)where C and D are two material parameters. The constitutive model was shown in [27] to accurately reproduce the behavior of spheroidal graphite cast iron.The solution of non-linear evolution problems such as cyclic viscoplasticity is performed, during implicit finite element analysis, over discrete sequence of time steps [25]. For each time step, predictor-corrector algorithms are used. In fact, the return mapping algorithm uses an operator split approach and an iterative Newton procedure consisting in solutions of global linear problem (elastic prediction) followed by local integrations of the constitutive model (plastic correction). A fully implicit integration scheme (backward Euler) associated with a radial return is adopted by Szmytka et al. [2] to successfully perform the numerical integration of the previous law in a material behavior user subroutine UMAT which is written and used in the commercial software Abaqus.The main assumption of this scheme is that the viscoplastic strains evolution over the increment can be calculated from the stress state at the end of the increment. This is however theoretically incorrect as the viscoplastic response and in particular the viscoplastic flow direction is a function of the current stress state corrected by the kinematic hardening term. If the viscoplastic flow direction does not change over an increment, the return algorithm solutions will be accurate. However, although the time step is fixed sufficiently small to avoid viscoplastic direction variations, standard commercial finite element software tend to steadily increase it if convergence of the overall mechanical problem required only few iterations, introducing computations errors.In fact, if one considers the evolution of the accumulated viscoplastic strain over a time step betweentnandtn+1:(9)Δpn=pn+1−pn=∫tntn+1ṗ(u)duthe flow rule, as a continuous fonction of time, becomes(10)Δε̲̲vp=ε̲̲n+1vp−ε̲̲nvp=∫tntn+1ε̲̲vp(u)du=32∫tntn+1ṗ=(u)s̲̲(u)−X̲̲(u)J2(s̲̲(u)−X̲̲(u))du(11)=32∫tntn+1ṗ(u)N̲̲(u)duwhereN̲̲(u)is the tensor normal to the convex surface of visoplasticity. IfN̲̲(u)does not vary over[tn;tn+1], the integration scheme is perfectly accurate and no error are introduced. However, ifN̲̲(u)varies during the time increment, there is a difference between the continuous definition ofΔε̲̲ineand its discrete valueΔε̲̲ine=Δpn32N̲̲(tn+1), which leads to an integration errore˜:(12)e˜=32∫tntn+1ṗ(u)[N̲̲(u)−N̲̲(tn+1)]duIt is then necessary to observe and quantify the errors produced by this integration scheme for various loads and for different time increments as performed for example by [29,30] using the concept of iso-error maps. While the tested constitutive model is often used for thermal–mechanical fatigue design, errors in terms of dissipated energy density will also be investigated with the analyses of the variableΔW:(13)ΔW=∫lodingcycleσ̲̲:ε̲̲In order to estimate errors induced by the integration scheme proposed by [2], several finite element simulations are performed on a single 10-node quadratic tetrahedric element (C3D10 in Abaqus). These calculations on a Representative Elementary Volume (REV) are identical to those that could be achieved on a test laboratory specimen with a gauge area presenting a homogeneous behavior. Using a single element, only the discrepancies related to the integration scheme are therefore observed.Isothermal computations are performed for a SG SiMo cast-iron at 500°C. Model parameters are summed up inTable 1 while model accuracy is detailed in [27].To measure differences in mechanical responses related to the time step, calculations are performed in Abaqus first with a time step evolution left free. Thus, the parameters controlling the way time increment size increases or decreases are those that are considered standard by the FE solver:•If the solution has not converged after 16 iterations of the Modified Newton–Raphson algorithm or if the evolution of the residual force vector seems to diverge, the time increment is automatically multiplied by 0.25. This modification can be repeated 5 times in a row after which, in the absence of convergence, the computation stops.If, for two consecutive time increments, there is a solution convergence in less than 5 iterations, the size of the next time increment is automatically increased by 50%.The initial size of the time increment is requested by the FE solver. In the following, it is arbitrarily set for all computations to 0.2s. This first computation (with the time increment evolution set free without any limitation) is considered as our reference. Thereafter, a maximum time increment size is included as control parameter in the simulation. This maximum time increment is first set to 5s. This value is then decreased until obtaining a convergence of the numerical solution, i.e. it no longer evolves even though time step size keeps decreasing. Differences in terms of mechanical stress strain loops, dissipated energy densities and CPU time are finally investigated, first for 4 types of cyclic loading:•InFig. 1a, an uniaxial tension–compression test withRσ=−1andσ11,max=350MPa.In Fig. 1b, an in-phase biaxial tension–compression test withRσ=−1andσvonMises,max=210MPa.In Fig. 1c, a pure shear test withRσ=−1andσ12,max=125MPa.In Fig. 1d, an out-of-phase thermal–mechanical test where temperature varies between 500°C and 750°C while mechanical strainε11varies between 1% and 0%.Each loading is repeated until a viscoplastic shakedown which occurs after 3 cycles.A thermal–mechanical test is also performed on a “real” complex structure and not only a REV in order to estimate the influence of the time step during complex loading implying thermal and stress gradients. The experimental set-up described by Constantinescu et al. [1] is therefore used as it deals with very severe thermo-mechanical loadings. In this experimental protocol, axial symmetric clamped specimens are heated by the Joule effect. The heating procedure produces a thermal gradient along the specimen axis, which also induces a variation of the mechanical fields in the same direction. This experimental machine is presented inFig. 2.Temperatures vary between 40°C and 700°C with a heating rate of 20°Cs−1. The maximum temperature is obtained in a region of approximately 10mm in the center of the specimen with a maximum temperature gradient of 40°Cmm. The clamp value due to the variable stiffness (proportional to the flexural moment of the beams) is here fixed at 183,000N/mm and the dwell time at 700°C at 60s. The thermal load of this experiment was numerically estimated by an electric and a thermal FEM computation on Abaqus. The results of the thermal-electrical computation is then introduced in a mechanichal computation. The FE model is here constituted of 43,934 nodes and 28,805 C3D10 10-node quadratic tetrahedric elements.As the limitation of the time increment is clearly incompatible with achieving fast computation time, two simple algorithms are proposed to complete the integration scheme of the constitutive model and to control the evolution of the time increment size. The goal is to have a free evolution when the behavior shows little or no non-linearity and to automatically reduce the size of the increment and keep it low for evolutions involving strong viscoplasticity. In the following, n andn+1index represent a value of a variable (tensor or scalar) at respectivelytnandtn+1.If a cyclic finite element computation shows long elastic phases (several seconds or stress ranges greater than 100MPa which is for instance very common at low temperature for steels or cast-irons), FE solvers usually tends to significantly and logically increase time increments as convergence is easy. This computing strategy involves sometimes long time increments when first non-linearities (plasticity) related to the material behavior occur. There is therefore a tendency to misjudge the elastic/viscoplastic transition and to generate errors that can later increase. Linear elastic analysis can indeed be performed in a single step provided you exactly know the length of this step, which is possible for a single finite element but never the case for structures under complex loading like thermal–mechanical ones. In this case, complex thermal loadings are combined with strong mechanical constraints and the local mechanical response is therefore the result of the combination of several factors such as thermal gradient, mechanical constraints, local geometry, etc. In this case, it is fairly impossible to a priori estimate the time and the localization of the first element reaching the yield surface. The integration scheme proposed by [2] begins with an assumption of elastic evolution of the structure for the time step; the internal variables(ε̲̲nvp,α̲̲n,pn)are frozen. Thus at timetn+1, the hardening parameter R is given by(14)Rn+1⁎=R0n+1+Qn+1(1−exp(−bn+1pn))and the stress tensor by(15)σ̲̲n+1⁎=σ̲̲n+Δσ̲̲elasticwith(16)Δσ̲̲elastic=Cn+1:Δε̲̲+ΔC:(ε̲̲n−ε̲̲nine)s̲̲n+1⁎the deviatoric part ofσ̲̲n+1⁎, and the yield functionf(s̲̲n+1⁎−X̲̲n,Rn+1⁎)are estimated to check the validity of the elastic evolution assumption, more precisely:•Iff(s̲̲n+1⁎−X̲̲n,Rn+1⁎)<0, the evolution is elastic and the internal variables are constant in the step.Iff(s̲̲n+1⁎−X̲̲n,Rn+1⁎)0, the evolution is visco-elastoplastic and an inelastic correction must be done.If it is the first inelastic correction afer an elastic evolution, the first proposed control is activated.The current increment, the size of which isΔtelais stopped as soon as the first element presenting the first inelastic evolution is detected.The increment is restarted with an optimized time value, which have to enable to exactly reach the moment for the first inelastic occurence. With a simple linear approximation, the proposed new time increment becomes(17)Δtnew=Rn+1J2(s̲̲n+1⁎−X̲̲n)ΔtelaThis evolution allows completing this new increment just before or just after the first occurrence of plasticity.Finally, a new reduced time increment is defined for the following computation step. One chooses to take the same increment as the initial one, thereby generating a new artificial calculation stage from the first viscoplastic increment. In this way, the time increment during the first viscoplastic increments is mastered and thus helps to better represent the behavior transition. Moreover, this method avoids the introduction of too large errors associated with the often quick evolution of the normal tensorN̲̲during the first moments of visco-plasticity.The calculation of the consistent tangent operator [16,24] is of primary importance in order to assure a rapid convergence of the integration scheme and its values tend to change significantly during increment with large viscoplastic evolutions. Significant differences in terms of behavior are observed[25,26], depending on the time step, when drastic changes of material behavior occur. At constant temperature and for uniaxial loadings, these evolutions can be easily characterized by the concavity of the stress–strain loop. The variation of the tangent operator, as the derivative of the stress increment with respect to the strain, is in fact directly related to the curvature of the stress–strain curve and, as it is computed at each increment, can be easily used to control the time increment. The second proposed control algorithm is therefore based on the variation of the tangent operator with time. For each increment, its curvature is computed following the equation:(18)c˜=1Δtn(‖∂Δσn+1̲̲∂Δεn+1̲̲‖−‖∂Δσn̲̲∂Δεn̲̲‖)−1Δtn−1(‖∂Δσn̲̲∂Δεn̲̲‖−‖∂Δσn−1̲̲∂Δεn−1̲̲‖)whereΔtnandΔtn−1are respectively the current and the former time increment.||.||is the norm of a 4th-rank tensorAdefined as(19)||A||=A::AThis value is compared to a reference elastic value throughout a criteria:•Ifc˜<βΔtnℂ, the computation step is validated.Ifc˜≥βΔtnℂ, the current computation step is stopped and begins again with the same time increment as the initial one,with β, a material-dependant parameter. Its value has been here optimized to obtain the better compromize between computation time and accuracy. The complete algorithm for time step control is summarized inFig. 3.

@&#CONCLUSIONS@&#
Two algorithms have been proposed for controlling the time step and thus better estimate the calculated stress–strain loop for elasto-viscoplastic constitutive models in the case of thermomechanical loads. Drifts in terms of mechanical behavior have been evaluated for different types of multiaxial loadings first on an volume element and then on a more complex structure. Implied differences in terms of lifetime have also been investigated. Strong differences first appear between problem with strain or stress loading control. Computations errors are much more limited when loading conditions are expressed in terms of strain and in these cases, time control seems to be unuseful. Very important computations errors appears when forces or stresses are imposed to the volume element or to loaded structure.The proposed algorithms enable to correctly control the time increment size with an accurate description of very strong viscoplastic evolutions for different kinds of loading conditions. Their main advantage is to manage to avoid a time increment limitation which has a tremendous impact on the computation time, especially for problem with a high number of degrees of freedom. In fact, with a limited increase of the computation time, the developed control algorithms provide a converged stress–strain solution and a correct lifetime estimation. The proposed control strategy however needs both a careful identification of the β parameter which seems to depend on the material behavior and a smart choice of the size of the first time increment which is taken as a reference for the control.